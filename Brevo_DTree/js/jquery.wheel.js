/*!
 * jQuery lightweight plugin boilerplate
 * Original author: @ajpiano
 * Further changes, comments: @addyosmani
 * Licensed under the MIT license
 */
(function(t,e,a,n,i){var r="wheel",s={min:0,max:1,step:.1};function o(e,a){this._defaults=s;this._name=r;this.arc;this.deg=0;this.element=e;this.handle=t(e).find(".handle");this.progress=t(e).find(".progress");this.options=t.extend({},s,a);this.progressFill;this.rad=-Math.PI/2;this.svg;this.value;this.init()}o.prototype.startDrag=function(e){var n=this;t(a).on("mousemove touchmove",function(t){t.preventDefault();n.drag(t)}).on("mouseup touchend",function(t){t.preventDefault();n.stopDrag(t)})};o.prototype.drag=function(e){var a=this;var n=t(a.element);var i=e.pageX;var r=e.pageY;var s=e.originalEvent.touches;if(s&&s.length===1){i=s[0].pageX;r=s[0].pageY}var o=n.offset();var d=i-(o.left+n.width()/2);var h=r-(o.top+n.height()/2);a.rad=Math.atan2(h,d);a.deg=a.rad*(180/Math.PI);if(a.deg<=0&&a.deg>=-90){a.deg=90+a.deg}else if(a.deg<-90){a.deg=270+180+a.deg}else{a.deg+=90}this.update()};o.prototype.stopDrag=function(){t(a).off("mousemove mouseup");this.update()};o.prototype.keyDown=function(t){var e=this;var a=e.options.step||1;switch(t.keyCode){case 38:e.deg+=a;if(e.deg>360){e.deg-=360}break;case 40:e.deg-=a;if(e.deg<0){e.deg+=360}break;default:break}if(e.deg>=0&&e.deg<=270){e.rad=(e.deg-90)*(Math.PI/180)}else{e.rad=(e.deg-360-90)*(Math.PI/180)}e.update()};o.prototype.update=function(){var e=this;var a=t(e.element);var n=t(e.handle);var i=e.deg/360;var r=a.width()/2-n.width()/2;var s=Math.cos(e.rad)*r+a.width()/2;var o=Math.sin(e.rad)*r+a.height()/2;n.css({left:s,top:o});e.value=(e.options.max-e.options.min)/360*e.deg;if(typeof e.options.onChange==="function"){e.options.onChange(e.value)}e.progressFill.attr("d",e.arc.endAngle(2*Math.PI*i))};o.prototype.init=function(){var a=this;var i=t(a.element);var r=t(a.handle);var s=i.width();var o=i.height();r.on("mousedown touchstart",function(e){e.preventDefault();a.startDrag(e);t(this).focus()}).keydown(function(t){t.preventDefault();a.keyDown(t)});a.arc=e.svg.arc().startAngle(0).innerRadius(s/2-20).outerRadius(s/2);a.svg=e.select(n.getElementById(a.element.id)).select(".progress").append("svg").attr("width",s).attr("height",o).append("g").attr("transform","translate("+s/2+","+o/2+")");a.progressFill=a.svg.append("path").attr("class","progress-fill");a.update()};t.fn[r]=function(e){return this.each(function(){if(!t.data(this,"plugin_"+r)){t.data(this,"plugin_"+r,new o(this,e))}})}})(jQuery,d3,window,document);