jQuery.sap.declare("Brevo.BrevoDtree.util.Formatter");jQuery.sap.require("sap.ui.core.format.DateFormat");function fixdata(e){var r="",t=0,a=10240;for(;t<e.byteLength/a;++t)r+=String.fromCharCode.apply(null,new Uint8Array(e.slice(t*a,t*a+a)));r+=String.fromCharCode.apply(null,new Uint8Array(e.slice(t*a)));return r}function to_json(e){var r=[];var t=0;e.SheetNames.forEach(function(t){var a=XLSX.utils.sheet_to_row_object_array(e.Sheets[t]);if(a.length>0){var n=[];for(var i in a[0]){n.push({property:i,value:i,name:i})}r.push({name:t,data:a,properties:n})}i++});return r}function handleDrop(e,r,t){rABS=false;use_worker=false;var a=e[0];{var n=new FileReader;var i=a.name;n.onload=function(e){if(typeof console!=="undefined")console.log("onload",new Date,rABS,use_worker);var a=e.target.result;if(use_worker){xw(a,process_wb)}else{var n;if(rABS){n=XLSX.read(a,{type:"binary"})}else{var i=a.split("base64,")}var u=i[1];r(a,u,t)}};if(rABS)n.readAsBinaryString(a);else n.readAsDataURL(a)}}function handleDragover(e){e.stopPropagation();e.preventDefault();e.dataTransfer.dropEffect="copy"}Brevo.BrevoDtree.util.Formatter={isMeasureSettingVisible:function(e){switch(e){case"Stacked Combination":case"Bubble Chart":case"Bullet":return true;case"Column Chart":case"Stacked Column":case"Block Matrix":case"Stacked Area":case"Grouped Step Line":case"Heat Map":case"Scatter Chart":case"Line Chart":case"Bubble Ring":case"Vertical Floating Bars":case"Horiz Grouped Lolli Pie":case"Waterfall":default:return false}},canUserEditPage:function(e,r){if(e&&r){var t="IDADMIN";try{t=sap.ushell.Container.getService("UserInfo").getUser().getId()}catch(e){return true}if(e==="X"&&r!=t){return true}else{return true}}else{return true}},constructFilter:function(e){var r=[];for(var t=0;t<e.length;t++){filterOperator=e[t].filterOperator;filterValue=e[t].filterValue;filterName=e[t].filterName;var a=filterValue.split(",");var n=[];for(var i=0;i<a.length;i++){var u=new sap.ui.model.Filter(filterName,filterOperator.toUpperCase(),a[i].trim());n.push(u)}if(n.length>1){var u=new sap.ui.model.Filter({filters:n,and:false});u.bAnd=false}r.push(u)}if(r.length>1){var r=new sap.ui.model.Filter({filters:r,and:true})}return r},isDimensionSettingVisible:function(e){switch(e){case"Waterfall":return true;case"Column Chart":case"Stacked Column":case"Block Matrix":case"Stacked Area":case"Grouped Step Line":case"Heat Map":case"Scatter Chart":case"Line Chart":case"Bubble Ring":case"Vertical Floating Bars":case"Horiz Grouped Lolli Pie":case"Stacked Combination":case"Bubble Chart":case"Bullet":default:return false}},measureSettingsValue:function(e){switch(e){case"Stacked Combination":return[{text:"Column",key:"bar"},{text:"Line",key:"line"}];case"Bubble Chart":return[{text:"Axis 1",key:"valueAxis1"},{text:"Axis 2",key:"valueAxis2"},{text:"Bubble Width",key:"bubbleWidth"}];case"Bullet":return[{text:"Axis",key:"actualValues"},{text:"Target",key:"targetValues"}];case"Column Chart":case"Stacked Column":case"Block Matrix":case"Stacked Area":case"Grouped Step Line":case"Heat Map":case"Scatter Chart":case"Line Chart":case"Bubble Ring":case"Vertical Floating Bars":case"Horiz Grouped Lolli Pie":case"Waterfall":default:return[]}},mergeArrays:function(e){for(var r=0;r<e.length-1;r++){var t=e[r];var a=e[r+1];var n=[];for(var i=0;i<t.length;i++){var u=t[i];for(var s=0;s<a.length;s++){if(a[s].property===u.property){n.push(u);break}}}e[r+1]=n}return e[r]},columnLinkVisibility:function(e,r){var t=false;for(var a=0;a<e.length-1;a++){if(r==e[a].value){t=true;break}}return t},filterValuePercent:function(e){try{var r=parseFloat(e);if(r>100)return 100;else return r}catch(e){return 0}},commentDateFormatter:function(e,r){var t=sap.ui.core.format.DateFormat.getDateTimeInstance({pattern:"MM/dd/yyyy"});if(typeof r=="string"){var a,n;var i=r.split("-");var u=i[0];if(i[1].length)if(i[1].length!=2){a="0"+i[1]}else{a=i[1]}if(i[2].length==16){n=i[2].split("T")[0]}else if(i[2].length!=2){n="0"+i[2]}else{n=i[2]}if(e)var s="Today: "+a+"/"+n+"/"+u;else var s="Posted on: "+a+"/"+n+"/"+u}else{if(e)var s="Today: "+t.format(r);else var s="Posted on: "+t.format(r)}return s},getRouteType:function(e,r){if(e){if(e=="destination"&&r!="Card_Configuration")return true;else return false}else{return false}},test:function(e){debugger},checkForVisibility:function(e){if(e){return true}else{return false}},uppercaseFirstChar:function(e){return e.charAt(0).toUpperCase()+e.slice(1)},FLoc:function(e){if(e=="1")return false;else return true},Delta:function(e,r){if(isNaN(parseInt(r)-parseInt(e)))return 0;else return parseInt(r)-parseInt(e)},getImagePath:function(e){if(e)return jQuery.sap.getModulePath("Brevo.BrevoDtree")+"/"+e;else return e},DeltaState:function(e){return"Success"},discontinuedStatusState:function(e){return e?"Error":"None"},discontinuedStatusValue:function(e){return e?"Discontinued":""},columnTypeFormatter:function(e){if(e){if(e=="String"||e=="Date"){return"Dimension"}else return"Measure"}},aggregationColumnVisibility:function(e){if(e){if(e=="String"||e=="Date"){return false}else return true}},handleDateFieldVisibility:function(e,r){if(e){if(e=="Date"){return r}else return""}},currencyValue:function(e){return parseFloat(e).toFixed(2)},PublishedDate:function(e){if(e){var r=sap.ui.core.format.DateFormat.getDateTimeInstance({pattern:"MMMM dd,YYYY"});return r.format(new Date(e.split(",")[1]))}},amountToMillions:function(e){e=parseFloat(e);if(isNaN(e)){return 0}else if(e>999999999)return(e/1e9).toFixed(1)+"B";else if(e>999999)return(e/1e6).toFixed(1)+"M";else if(e>999)return(e/1e3).toFixed(1)+"K";else if(e>0)return e.toFixed(1);else if(e==0)return e+".0";else{if(isNaN(e)){return 0}else if(e<-999999999)return(e/1e9).toFixed(1)+"B";else if(e<-999999)return(e/1e6).toFixed(1)+"M";else if(e<-999)return(e/1e3).toFixed(1)+"K";else if(e<0)return e.toFixed(1)}},getDifferenceInMonths:function(e,r){var t=new Date;var a=new Date(r,e,1);var n=t;var i=a;var u=(i.getFullYear()-n.getFullYear())*12;u+=i.getMonth()-n.getMonth();if(i.getDate()<n.getDate())u--;return u},getQuater:function(e,r){if(e==12||e>9){return"Q4"}else if(e==9||e>6){return"Q3"}else if(e==6||e>3){return"Q2"}else{return"Q1"}},formatdata:function(e,r){if(r=="percent"){return(e/100).toFixed(1)+"%"}else if(r=="thousand"){return(e/1e3).toFixed(1)+"k"}else if(r=="million"){return(e/1e6).toFixed(1)+"M"}else{return(e/1e9).toFixed(1)+"B"}},thresholdLevel:function(e,r,t){var a=parseFloat(e.value);var n=parseFloat(e.value_org);var i=[];var u=[];var s=[];i.push(a,n);u.push(r,t);for(var l=0;l<i.length;l++){s.push({value:i[l],color:u[l]})}if(s.length>0){var o=[];for(l=0;l<s.length;l++){o.push([s[l].color])}return o}},setThresholdLevel:function(e){if(e==0)return"";else return parseFloat(e)},setRectanglecolor:function(e){if(e>.8){return"#67f967"}else if(e<=.8&&e>.6){return"#7ffa7f"}else if(e<=.6&&e>.4){return"#98fb98"}else if(e<=.4&&e>.2){return"#b1fcb1"}else{return"#c9fdc9"}},getSapValueStateColor:function(e,r){r.getView().byId("legend1").removeStyleClass("legend1Error");r.getView().byId("legend1").removeStyleClass("legend1Warning");r.getView().byId("legend1").removeStyleClass("legend1Success");r.getView().byId("legend1").removeStyleClass("legend1Color");if(e=="red")return["Error","legend1Error"];else if(e=="orange")return["Critical","legend1Warning"];else if(e=="green")return["Good","legend1Success"];else return["Neutral","legend1Color"]},indexValue:function(e){e=parseFloat(e);if(isNaN(e)){return 0}else return e.toFixed(1)},State:function(e){switch(e){case"1":return"Error";break;case"2":return"Warning";break;case"3":return"Success";break;case"4":return"None";break;default:return"None";break}},Quantity:function(e){try{return e?parseFloat(e).toFixed(0):e}catch(e){return"Not-A-Number"}},DateValue:function(e){if(e){return new Date(e.substr(0,2),e.substr(2,4),e.substr(4,6))+" "}else{return e}},Date:function(e){if(e){if(typeof e=="string"){e=e.replace("/Date(","");e=parseInt(e.replace(")/",""))}var r=sap.ui.core.format.DateFormat.getDateTimeInstance({pattern:"dd-MM-yyyy"});return r.format(new Date(e),true)+" "}else{return e}},NewDateTime:function(e){if(e){e=e.replace("/Date(","");e=parseInt(e.replace(")/",""));var r=sap.ui.core.format.DateFormat.getDateTimeInstance({pattern:"dd-MM-yyyy"});return r.format(new Date(e),false)}else{return e}},DateTimeFormatForDisplay:function(e){if(e){index=e.indexOf("T");e=parseInt(e.subStr(0,index));var r=sap.ui.core.format.DateFormat.getDateTimeInstance({pattern:"dd-MM-yyyy"});return r.format(new Date(e),true)}else{return e}},Time:function(e){if(e){e=e.replace("PT","");e=e.replace("H","");e=e.replace("M","");e=e.replace("S","");var r=sap.ui.core.format.DateFormat.getTimeInstance({pattern:"H:mm"});if(e.substring(0,2)=="00"&&e.substring(2,4)=="00")return"";else return r.format(new Date(2015,12,5,e.substring(0,2),e.substring(2,4),e.substring(4,6)),false)}else{return e}},DateTimeWhenString:function(e,r){if(!r){if(e){var t=sap.ui.core.format.DateFormat.getDateTimeInstance({pattern:"yyyy-MM-dd"});var a=e.substr(8,2);var n=e.substr(10,2);var i=e.substr(12,2);var u=a+":"+n+":"+i;return t.format(new Date(e.substr(0,4),e.substr(4,2),e.substr(6,2)),false)+"T"+u}else{return e}}else{if(e){var s=new Date(e);var a=s.getHours();var n=s.getMinutes();var i=s.getSeconds();if(a<10){a="0"+a}if(n<10){n="0"+n}if(i<10){i="0"+i}return"PT"+a+"H"+n+"M"+i+"S"}}},DateTime:function(e,r){if(!r){if(e){var t=sap.ui.core.format.DateFormat.getDateTimeInstance({pattern:"yyyy-MM-dd"});var a=e.getHours();var n=e.getMinutes();var i=e.getSeconds();if(a<10){a="0"+a}if(n<10){n="0"+n}if(i<10){i="0"+i}var u=a+":"+n+":"+i;return t.format(new Date(e),false)+"T"+u}else{return e}}else{if(e){var s=new Date(e);var a=s.getHours();var n=s.getMinutes();var i=s.getSeconds();if(a<10){a="0"+a}if(n<10){n="0"+n}if(i<10){i="0"+i}return"PT"+a+"H"+n+"M"+i+"S"}}},Blank:function(e){if(e=="0.000"){var r=invFCUpdateView.byId("invFCUpdateTbl");var t=r.getItems();for(var a=0;a<t.length;a++){var n=t[a].getAggregation("cells")[1].getValue();if(n==""){t[a].getAggregation("cells")[1].setValue("")}}}},formatLevel:function(e){try{if(e=="Critical"){return"Warning"}else if(e=="High"){return"Warning"}else if(e=="Low"){return"Success"}else{return"None"}}catch(e){return"None"}},linkVisibility:function(e){try{if(e.length>5)return true;else return false}catch(e){return false}},nextButtonVisibility:function(e,r){try{if(e.length>0){var t=true;for(var a=0;a<e.length;a++){if(e[a].filter==r&&a==e.length-1){t=false;return false}}if(t)return true}else return false}catch(e){return false}},calculationPieParent:function(e,r){var t=r-e.value_org;var a=e.value/t;return a},buttonVisibility:function(e){if(e){if(e.Parent)return false;else return true}},textVisibility:function(e){if(e){if(e.Parent||e.ParentNew)return true;else return false}},iconVisibility:function(e,r){if(e){if(r){if(e.replace("All","")==r){return"sap-icon://navigation-down-arrow"}else{return"sap-icon://navigation-right-arrow"}}else{return"sap-icon://navigation-right-arrow"}}},tableInputVisibilty:function(e){if(e){if(e.indexOf("All")>-1)return false;else return true}},tableButtonVisibilty:function(e){if(e){if(e.indexOf("All")>-1)return true;else return false}}};