/*! JointJS v2.1.0 (2018-04-26) - JavaScript diagramming library


This Source Code Form is subject to the terms of the Mozilla Public
License, v. 2.0. If a copy of the MPL was not distributed with this
file, You can obtain one at http://mozilla.org/MPL/2.0/.
*/
(function(t,e){if(typeof define==="function"&&define.amd){define(["backbone","lodash","jquery"],function(i,r,n){i.$=n;return e(t,i,r,n)})}else if(typeof exports!=="undefined"){var i=require("backbone");var r=require("lodash");var n=i.$=require("jquery");module.exports=e(t,i,r,n)}else{var i=t.Backbone;var r=t._;var n=i.$=t.jQuery||t.$;t.joint=e(t,i,r,n);t.g=t.joint.g;t.V=t.Vectorizer=t.joint.V}})(this,function(t,e,i,r){(function(){var t=typeof exports!="undefined"?exports:this;var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function i(t){this.message=t}i.prototype=new Error;i.prototype.name="InvalidCharacterError";t.btoa||(t.btoa=function(t){var r=String(t);for(var n,a,o=0,s=e,l="";r.charAt(o|0)||(s="=",o%1);l+=s.charAt(63&n>>8-o%1*8)){a=r.charCodeAt(o+=3/4);if(a>255){throw new i("'btoa' failed: The string to be encoded contains characters outside of the Latin1 range.")}n=n<<8|a}return l});t.atob||(t.atob=function(t){var r=String(t).replace(/=+$/,"");if(r.length%4==1){throw new i("'atob' failed: The string to be decoded is not correctly encoded.")}for(var n=0,a,o,s=0,l="";o=r.charAt(s++);~o&&(a=n%4?a*64+o:o,n++%4)?l+=String.fromCharCode(255&a>>(-2*n&6)):0){o=e.indexOf(o)}return l})})();(function(){if(typeof Uint8Array!=="undefined"||typeof window==="undefined"){return}function t(t,e){return this.slice(t,e)}function e(t,e){if(arguments.length<2){e=0}for(var i=0,r=t.length;i<r;++i,++e){this[e]=t[i]&255}}function i(i){var r;if(typeof i==="number"){r=new Array(i);for(var n=0;n<i;++n){r[n]=0}}else{r=i.slice(0)}r.subarray=t;r.buffer=r;r.byteLength=r.length;r.set=e;if(typeof i==="object"&&i.buffer){r.buffer=i.buffer}return r}window.Uint8Array=i;window.Uint32Array=i;window.Int32Array=i})();(function(){if(typeof XMLHttpRequest==="undefined"){return}if("response"in XMLHttpRequest.prototype||"mozResponseArrayBuffer"in XMLHttpRequest.prototype||"mozResponse"in XMLHttpRequest.prototype||"responseArrayBuffer"in XMLHttpRequest.prototype){return}Object.defineProperty(XMLHttpRequest.prototype,"response",{get:function(){return new Uint8Array(new VBArray(this.responseBody).toArray())}})})();if(!Array.prototype.includes){Object.defineProperty(Array.prototype,"includes",{value:function(t,e){if(this==null){throw new TypeError('"this" is null or not defined')}var i=Object(this);var r=i.length>>>0;if(r===0){return false}var n=e|0;var a=Math.max(n>=0?n:r-Math.abs(n),0);function o(t,e){return t===e||typeof t==="number"&&typeof e==="number"&&isNaN(t)&&isNaN(e)}while(a<r){if(o(i[a],t)){return true}a++}return false}})}if(!Array.prototype.find){Object.defineProperty(Array.prototype,"find",{value:function(t){if(this==null){throw new TypeError('"this" is null or not defined')}var e=Object(this);var i=e.length>>>0;if(typeof t!=="function"){throw new TypeError("predicate must be a function")}var r=arguments[1];var n=0;while(n<i){var a=e[n];if(t.call(r,a,n,e)){return a}n++}return undefined}})}if(!Array.from){Array.from=function(){var t=Object.prototype.toString;var e=function(e){return typeof e==="function"||t.call(e)==="[object Function]"};var i=function(t){var e=Number(t);if(isNaN(e)){return 0}if(e===0||!isFinite(e)){return e}return(e>0?1:-1)*Math.floor(Math.abs(e))};var r=Math.pow(2,53)-1;var n=function(t){var e=i(t);return Math.min(Math.max(e,0),r)};return function t(i){var r=this;var a=Object(i);if(i==null){throw new TypeError("Array.from requires an array-like object - not null or undefined")}var o=arguments.length>1?arguments[1]:void undefined;var s;if(typeof o!=="undefined"){if(!e(o)){throw new TypeError("Array.from: when provided, the second argument must be a function")}if(arguments.length>2){s=arguments[2]}}var l=n(a.length);
// 13. If IsConstructor(C) is true, then
var c=e(r)?Object(new r(l)):new Array(l);var u=0;var g;while(u<l){g=a[u];if(o){c[u]=typeof s==="undefined"?o(g,u):o.call(s,g,u)}else{c[u]=g}u+=1}c.length=l;return c}}()}if(!Array.prototype.findIndex){Object.defineProperty(Array.prototype,"findIndex",{value:function(t){if(this==null){throw new TypeError('"this" is null or not defined')}var e=Object(this);var i=e.length>>>0;if(typeof t!=="function"){throw new TypeError("predicate must be a function")}var r=arguments[1];var n=0;while(n<i){var a=e[n];if(t.call(r,a,n,e)){return n}n++}return-1}})}if(!String.prototype.includes){String.prototype.includes=function(t,e){"use strict";if(typeof e!=="number"){e=0}if(e+t.length>this.length){return false}else{return this.indexOf(t,e)!==-1}}}if(!String.prototype.startsWith){String.prototype.startsWith=function(t,e){return this.substr(e||0,t.length)===t}}Number.isFinite=Number.isFinite||function(t){return typeof t==="number"&&isFinite(t)};Number.isNaN=Number.isNaN||function(t){return t!==t};var n=function(){var t={};var e=Math;var i=e.abs;var r=e.cos;var n=e.sin;var a=e.sqrt;var o=e.min;var s=e.max;var l=e.atan2;var c=e.round;var u=e.floor;var g=e.PI;var h=e.random;var d=e.pow;t.bezier={curveThroughPoints:function(t){console.warn("deprecated");return new I(f.throughPoints(t)).serialize()},getCurveControlPoints:function(t){console.warn("deprecated");var e=[];var i=[];var r=t.length-1;var n;if(r==1){e[0]=new m((2*t[0].x+t[1].x)/3,(2*t[0].y+t[1].y)/3);i[0]=new m(2*e[0].x-t[0].x,2*e[0].y-t[0].y);return[e,i]}var a=[];for(n=1;n<r-1;n++){a[n]=4*t[n].x+2*t[n+1].x}a[0]=t[0].x+2*t[1].x;a[r-1]=(8*t[r-1].x+t[r].x)/2;var o=this.getFirstControlPoints(a);for(n=1;n<r-1;++n){a[n]=4*t[n].y+2*t[n+1].y}a[0]=t[0].y+2*t[1].y;a[r-1]=(8*t[r-1].y+t[r].y)/2;var s=this.getFirstControlPoints(a);for(n=0;n<r;n++){e.push(new m(o[n],s[n]));if(n<r-1){i.push(new m(2*t[n+1].x-o[n+1],2*t[n+1].y-s[n+1]))}else{i.push(new m((t[r].x+o[r-1])/2,(t[r].y+s[r-1])/2))}}return[e,i]},getFirstControlPoints:function(t){console.warn("deprecated");var e=t.length;var i=[];var r=[];var n=2;i[0]=t[0]/n;for(var a=1;a<e;a++){r[a]=1/n;n=(a<e-1?4:3.5)-r[a];i[a]=(t[a]-i[a-1])/n}for(a=1;a<e;a++){i[e-a-1]-=r[e-a]*i[e-a]}return i},getCurveDivider:function(t,e,i,r){console.warn("deprecated");var n=new f(t,e,i,r);return function t(e){var i=n.divide(e);return[{p0:i[0].start,p1:i[0].controlPoint1,p2:i[0].controlPoint2,p3:i[0].end},{p0:i[1].start,p1:i[1].controlPoint1,p2:i[1].controlPoint2,p3:i[1].end}]}},getInversionSolver:function(t,e,i,r){console.warn("deprecated");var n=new f(t,e,i,r);return function t(e){return n.closestPointT(e)}}};var f=t.Curve=function(t,e,i,r){if(!(this instanceof f)){return new f(t,e,i,r)}if(t instanceof f){return new f(t.start,t.controlPoint1,t.controlPoint2,t.end)}this.start=new m(t);this.controlPoint1=new m(e);this.controlPoint2=new m(i);this.end=new m(r)};f.throughPoints=function(){function t(t){var e=t.length;var i=[];var r=[];var n=2;i[0]=t[0]/n;for(var a=1;a<e;a++){r[a]=1/n;n=(a<e-1?4:3.5)-r[a];i[a]=(t[a]-i[a-1])/n}for(a=1;a<e;a++){i[e-a-1]-=r[e-a]*i[e-a]}return i}function e(e){var i=[];var r=[];var n=e.length-1;var a;if(n==1){i[0]=new m((2*e[0].x+e[1].x)/3,(2*e[0].y+e[1].y)/3);r[0]=new m(2*i[0].x-e[0].x,2*i[0].y-e[0].y);return[i,r]}var o=[];for(a=1;a<n-1;a++){o[a]=4*e[a].x+2*e[a+1].x}o[0]=e[0].x+2*e[1].x;o[n-1]=(8*e[n-1].x+e[n].x)/2;var s=t(o);for(a=1;a<n-1;++a){o[a]=4*e[a].y+2*e[a+1].y}o[0]=e[0].y+2*e[1].y;o[n-1]=(8*e[n-1].y+e[n].y)/2;var l=t(o);for(a=0;a<n;a++){i.push(new m(s[a],l[a]));if(a<n-1){r.push(new m(2*e[a+1].x-s[a+1],2*e[a+1].y-l[a+1]))}else{r.push(new m((e[n].x+s[n-1])/2,(e[n].y+l[n-1])/2))}}return[i,r]}return function(t){if(!t||Array.isArray(t)&&t.length<2){throw new Error("At least 2 points are required")}var i=e(t);var r=[];var n=i[0].length;for(var a=0;a<n;a++){var o=new m(i[0][a].x,i[0][a].y);var s=new m(i[1][a].x,i[1][a].y);r.push(new f(t[a],o,s,t[a+1]))}return r}}();f.prototype={bbox:function(){var t=this.start;var e=this.controlPoint1;var r=this.controlPoint2;var n=this.end;var l=t.x;var c=t.y;var u=e.x;var g=e.y;var h=r.x;var d=r.y;var f=n.x;var v=n.y;var p=new Array;var I=new Array;var m=[new Array,new Array];var C,w,b,y;var N,M;var x,k;for(var z=0;z<2;++z){if(z===0){w=6*l-12*u+6*h;C=-3*l+9*u-9*h+3*f;b=3*u-3*l}else{w=6*c-12*g+6*d;C=-3*c+9*g-9*d+3*v;b=3*g-3*c}if(i(C)<1e-12){if(i(w)<1e-12){continue}y=-b/w;if(0<y&&y<1)I.push(y);continue}x=w*w-4*b*C;k=a(x);if(x<0)continue;N=(-w+k)/(2*C);if(0<N&&N<1)I.push(N);M=(-w-k)/(2*C);if(0<M&&M<1)I.push(M)}var D=I.length;var S=D;var j;var Z,G;while(D--){y=I[D];j=1-y;Z=j*j*j*l+3*j*j*y*u+3*j*y*y*h+y*y*y*f;m[0][D]=Z;G=j*j*j*c+3*j*j*y*g+3*j*y*y*d+y*y*y*v;m[1][D]=G;p[D]={X:Z,Y:G}}I[S]=0;I[S+1]=1;p[S]={X:l,Y:c};p[S+1]={X:f,Y:v};m[0][S]=l;m[1][S]=c;m[0][S+1]=f;m[1][S+1]=v;I.length=S+2;m[0].length=S+2;m[1].length=S+2;p.length=S+2;var P=o.apply(null,m[0]);var L=o.apply(null,m[1]);var T=s.apply(null,m[0]);var B=s.apply(null,m[1]);return new A(P,L,T-P,B-L)},clone:function(){return new f(this.start,this.controlPoint1,this.controlPoint2,this.end)},closestPoint:function(t,e){return this.pointAtT(this.closestPointT(t,e))},closestPointLength:function(t,e){e=e||{};var i=e.precision===undefined?this.PRECISION:e.precision;var r=e.subdivisions===undefined?this.getSubdivisions({precision:i}):e.subdivisions;var n={precision:i,subdivisions:r};return this.lengthAtT(this.closestPointT(t,n),n)},closestPointNormalizedLength:function(t,e){e=e||{};var i=e.precision===undefined?this.PRECISION:e.precision;var r=e.subdivisions===undefined?this.getSubdivisions({precision:i}):e.subdivisions;var n={precision:i,subdivisions:r};var a=this.closestPointLength(t,n);if(!a)return 0;var o=this.length(n);if(o===0)return 0;return a/o},closestPointT:function(t,e){e=e||{};var r=e.precision===undefined?this.PRECISION:e.precision;var n=e.subdivisions===undefined?this.getSubdivisions({precision:r}):e.subdivisions;var a;var o;var s;var l;var c;var u;var g=n.length;var h=g?1/g:0;for(var f=0;f<g;f++){var v=n[f];var p=v.start.distance(t);var I=v.end.distance(t);var m=p+I;if(!u||m<u){a=v;o=f*h;s=(f+1)*h;l=p;c=I;u=m}}var A=d(10,-r);while(true){var C;var w;C=l?i(l-c)/l:0;w=c?i(l-c)/c:0;if(C<A||w<A){return l<=c?o:s}var b=a.divide(.5);h/=2;var y=b[0].start.distance(t);var N=b[0].end.distance(t);var M=y+N;var x=b[1].start.distance(t);var k=b[1].end.distance(t);var z=x+k;if(M<=z){a=b[0];s-=h;l=y;c=N}else{a=b[1];o+=h;l=x;c=k}}},closestPointTangent:function(t,e){return this.tangentAtT(this.closestPointT(t,e))},divide:function(t){var e=this.start;var i=this.controlPoint1;var r=this.controlPoint2;var n=this.end;if(t<=0){return[new f(e,e,e,e),new f(e,i,r,n)]}if(t>=1){return[new f(e,i,r,n),new f(n,n,n,n)]}var a=this.getSkeletonPoints(t);var o=a.startControlPoint1;var s=a.startControlPoint2;var l=a.divider;var c=a.dividerControlPoint1;var u=a.dividerControlPoint2;return[new f(e,o,s,l),new f(l,c,u,n)]},endpointDistance:function(){return this.start.distance(this.end)},equals:function(t){return!!t&&this.start.x===t.start.x&&this.start.y===t.start.y&&this.controlPoint1.x===t.controlPoint1.x&&this.controlPoint1.y===t.controlPoint1.y&&this.controlPoint2.x===t.controlPoint2.x&&this.controlPoint2.y===t.controlPoint2.y&&this.end.x===t.end.x&&this.end.y===t.end.y},getSkeletonPoints:function(t){var e=this.start;var i=this.controlPoint1;var r=this.controlPoint2;var n=this.end;if(t<=0){return{startControlPoint1:e.clone(),startControlPoint2:e.clone(),divider:e.clone(),dividerControlPoint1:i.clone(),dividerControlPoint2:r.clone()}}if(t>=1){return{startControlPoint1:i.clone(),startControlPoint2:r.clone(),divider:n.clone(),dividerControlPoint1:n.clone(),dividerControlPoint2:n.clone()}}var a=new p(e,i).pointAt(t);var o=new p(i,r).pointAt(t);var s=new p(r,n).pointAt(t);var l=new p(a,o).pointAt(t);var c=new p(o,s).pointAt(t);var u=new p(l,c).pointAt(t);var g={startControlPoint1:a,startControlPoint2:l,divider:u,dividerControlPoint1:c,dividerControlPoint2:s};return g},getSubdivisions:function(t){t=t||{};var e=t.precision===undefined?this.PRECISION:t.precision;var i=[new f(this.start,this.controlPoint1,this.controlPoint2,this.end)];if(e===0)return i;var r=this.endpointDistance();var n=d(10,-e);var a=0;while(true){a+=1;var o=[];var s=i.length;for(var l=0;l<s;l++){var c=i[l];var u=c.divide(.5);o.push(u[0],u[1])}var g=0;var h=o.length;for(var v=0;v<h;v++){var p=o[v];g+=p.endpointDistance()}var I=g!==0?(g-r)/g:0;if(a>1&&I<n){return o}i=o;r=g}},isDifferentiable:function(){var t=this.start;var e=this.controlPoint1;var i=this.controlPoint2;var r=this.end;return!(t.equals(e)&&e.equals(i)&&i.equals(r))},length:function(t){t=t||{};var e=t.precision===undefined?this.PRECISION:t.precision;var i=t.subdivisions===undefined?this.getSubdivisions({precision:e}):t.subdivisions;var r=0;var n=i.length;for(var a=0;a<n;a++){var o=i[a];r+=o.endpointDistance()}return r},lengthAtT:function(t,e){if(t<=0)return 0;e=e||{};var i=e.precision===undefined?this.PRECISION:e.precision;var r=this.divide(t)[0];var n=r.length({precision:i});return n},pointAt:function(t,e){if(t<=0)return this.start.clone();if(t>=1)return this.end.clone();var i=this.tAt(t,e);return this.pointAtT(i)},pointAtLength:function(t,e){var i=this.tAtLength(t,e);return this.pointAtT(i)},pointAtT:function(t){if(t<=0)return this.start.clone();if(t>=1)return this.end.clone();return this.getSkeletonPoints(t).divider},PRECISION:3,scale:function(t,e,i){this.start.scale(t,e,i);this.controlPoint1.scale(t,e,i);this.controlPoint2.scale(t,e,i);this.end.scale(t,e,i);return this},tangentAt:function(t,e){if(!this.isDifferentiable())return null;if(t<0)t=0;else if(t>1)t=1;var i=this.tAt(t,e);return this.tangentAtT(i)},tangentAtLength:function(t,e){if(!this.isDifferentiable())return null;var i=this.tAtLength(t,e);return this.tangentAtT(i)},tangentAtT:function(t){if(!this.isDifferentiable())return null;if(t<0)t=0;else if(t>1)t=1;var e=this.getSkeletonPoints(t);var i=e.startControlPoint2;var r=e.dividerControlPoint1;var n=e.divider;var a=new p(i,r);a.translate(n.x-i.x,n.y-i.y);return a},tAt:function(t,e){if(t<=0)return 0;if(t>=1)return 1;e=e||{};var i=e.precision===undefined?this.PRECISION:e.precision;var r=e.subdivisions===undefined?this.getSubdivisions({precision:i}):e.subdivisions;var n={precision:i,subdivisions:r};var a=this.length(n);var o=a*t;return this.tAtLength(o,n)},tAtLength:function(t,e){var i=true;if(t<0){i=false;t=-t}e=e||{};var r=e.precision===undefined?this.PRECISION:e.precision;var n=e.subdivisions===undefined?this.getSubdivisions({precision:r}):e.subdivisions;var a={precision:r,subdivisions:n};var o;var s;var l;var c;var u;var g=0;var h=n.length;var f=1/h;for(var v=i?0:h-1;i?v<h:v>=0;i?v++:v--){var p=n[v];var I=p.endpointDistance();if(t<=g+I){o=p;s=v*f;l=(v+1)*f;c=i?t-g:I+g-t;u=i?I+g-t:t-g;break}g+=I}if(!o)return i?1:0;var m=this.length(a);var A=d(10,-r);while(true){var C;C=m!==0?c/m:0;if(C<A)return s;C=m!==0?u/m:0;if(C<A)return l;var w;var b;var y=o.divide(.5);f/=2;var N=y[0].endpointDistance();var M=y[1].endpointDistance();if(c<=N){o=y[0];l-=f;w=c;b=N-w}else{o=y[1];s+=f;w=c-N;b=M-w}c=w;u=b}},translate:function(t,e){this.start.translate(t,e);this.controlPoint1.translate(t,e);this.controlPoint2.translate(t,e);this.end.translate(t,e);return this},toPoints:function(t){t=t||{};var e=t.precision===undefined?this.PRECISION:t.precision;var i=t.subdivisions===undefined?this.getSubdivisions({precision:e}):t.subdivisions;var r=[i[0].start.clone()];var n=i.length;for(var a=0;a<n;a++){var o=i[a];r.push(o.end.clone())}return r},toPolyline:function(t){return new C(this.toPoints(t))},toString:function(){return this.start+" "+this.controlPoint1+" "+this.controlPoint2+" "+this.end}};var v=t.Ellipse=function(t,e,i){if(!(this instanceof v)){return new v(t,e,i)}if(t instanceof v){return new v(new m(t.x,t.y),t.a,t.b)}t=new m(t);this.x=t.x;this.y=t.y;this.a=e;this.b=i};v.fromRect=function(t){t=new A(t);return new v(t.center(),t.width/2,t.height/2)};v.prototype={bbox:function(){return new A(this.x-this.a,this.y-this.b,2*this.a,2*this.b)},clone:function(){return new v(this)},normalizedDistance:function(t){var e=t.x;var i=t.y;var r=this.a;var n=this.b;var a=this.x;var o=this.y;return(e-a)*(e-a)/(r*r)+(i-o)*(i-o)/(n*n)},inflate:function(t,e){if(t===undefined){t=0}if(e===undefined){e=t}this.a+=2*t;this.b+=2*e;return this},containsPoint:function(t){return this.normalizedDistance(t)<=1},center:function(){return new m(this.x,this.y)},tangentTheta:function(t){var e=30;var i=t.x;var r=t.y;var n=this.a;var a=this.b;var o=this.bbox().center();var s=o.x;var l=o.y;var c=i>o.x+n/2;var u=i<o.x-n/2;var g,h;if(c||u){g=i>o.x?r-e:r+e;h=n*n/(i-s)-n*n*(r-l)*(g-l)/(a*a*(i-s))+s}else{h=r>o.y?i+e:i-e;g=a*a/(r-l)-a*a*(i-s)*(h-s)/(n*n*(r-l))+l}return new m(h,g).theta(t)},equals:function(t){return!!t&&t.x===this.x&&t.y===this.y&&t.a===this.a&&t.b===this.b},intersectionWithLine:function(t){var e=[];var i=t.start;var r=t.end;var n=this.a;var o=this.b;var s=t.vector();var l=i.difference(new m(this));var c=new m(s.x/(n*n),s.y/(o*o));var u=new m(l.x/(n*n),l.y/(o*o));var g=s.dot(c);var h=s.dot(u);var d=l.dot(u)-1;var f=h*h-g*d;if(f<0){return null}else if(f>0){var v=a(f);var p=(-h-v)/g;var I=(-h+v)/g;if((p<0||1<p)&&(I<0||1<I)){return null}else{if(0<=p&&p<=1)e.push(i.lerp(r,p));if(0<=I&&I<=1)e.push(i.lerp(r,I))}}else{var A=-h/g;if(0<=A&&A<=1){e.push(i.lerp(r,A))}else{return null}}return e},intersectionWithLineFromCenterToPoint:function(t,e){t=new m(t);if(e)t.rotate(new m(this.x,this.y),e);var i=t.x-this.x;var r=t.y-this.y;var n;if(i===0){n=this.bbox().pointNearestToPoint(t);if(e)return n.rotate(new m(this.x,this.y),-e);return n}var o=r/i;var s=o*o;var l=this.a*this.a;var c=this.b*this.b;var u=a(1/(1/l+s/c));u=i<0?-u:u;var g=o*u;n=new m(this.x+u,this.y+g);if(e)return n.rotate(new m(this.x,this.y),-e);return n},toString:function(){return new m(this.x,this.y).toString()+" "+this.a+" "+this.b}};var p=t.Line=function(t,e){if(!(this instanceof p)){return new p(t,e)}if(t instanceof p){return new p(t.start,t.end)}this.start=new m(t);this.end=new m(e)};p.prototype={bbox:function(){var t=o(this.start.x,this.end.x);var e=o(this.start.y,this.end.y);var i=s(this.start.x,this.end.x);var r=s(this.start.y,this.end.y);return new A(t,e,i-t,r-e)},bearing:function(){var t=N(this.start.y);var e=N(this.end.y);var i=this.start.x;var a=this.end.x;var o=N(a-i);var s=n(o)*r(e);var c=r(t)*n(e)-n(t)*r(e)*r(o);var u=y(l(s,c));var g=["NE","E","SE","S","SW","W","NW","N"];var h=u-22.5;if(h<0)h+=360;h=parseInt(h/45);return g[h]},clone:function(){return new p(this.start,this.end)},closestPoint:function(t){return this.pointAt(this.closestPointNormalizedLength(t))},closestPointLength:function(t){return this.closestPointNormalizedLength(t)*this.length()},closestPointNormalizedLength:function(t){var e=this.vector().dot(new p(this.start,t).vector());var i=o(1,s(0,e/this.squaredLength()));if(i!==i)return 0;return i},closestPointTangent:function(t){return this.tangentAt(this.closestPointNormalizedLength(t))},equals:function(t){return!!t&&this.start.x===t.start.x&&this.start.y===t.start.y&&this.end.x===t.end.x&&this.end.y===t.end.y},intersectionWithLine:function(t){var e=new m(this.end.x-this.start.x,this.end.y-this.start.y);var i=new m(t.end.x-t.start.x,t.end.y-t.start.y);var r=e.x*i.y-e.y*i.x;var n=new m(t.start.x-this.start.x,t.start.y-this.start.y);var a=n.x*i.y-n.y*i.x;var o=n.x*e.y-n.y*e.x;if(r===0||a*r<0||o*r<0){return null}if(r>0){if(a>r||o>r){return null}}else{if(a<r||o<r){return null}}return[new m(this.start.x+a*e.x/r,this.start.y+a*e.y/r)]},intersect:function(t,e){if(t instanceof p||t instanceof A||t instanceof C||t instanceof v||t instanceof I){var i=t.intersectionWithLine(this,e);if(i&&t instanceof p){i=i[0]}return i}return null},isDifferentiable:function(){return!this.start.equals(this.end)},length:function(){return a(this.squaredLength())},midpoint:function(){return new m((this.start.x+this.end.x)/2,(this.start.y+this.end.y)/2)},pointAt:function(t){var e=this.start;var i=this.end;if(t<=0)return e.clone();if(t>=1)return i.clone();return e.lerp(i,t)},pointAtLength:function(t){var e=this.start;var i=this.end;fromStart=true;if(t<0){fromStart=false;t=-t}var r=this.length();if(t>=r)return fromStart?i.clone():e.clone();return this.pointAt((fromStart?t:r-t)/r)},pointOffset:function(e){e=new t.Point(e);var i=this.start;var r=this.end;var n=(r.x-i.x)*(e.y-i.y)-(r.y-i.y)*(e.x-i.x);return n/this.length()},rotate:function(t,e){this.start.rotate(t,e);this.end.rotate(t,e);return this},round:function(t){var e=d(10,t||0);this.start.x=c(this.start.x*e)/e;this.start.y=c(this.start.y*e)/e;this.end.x=c(this.end.x*e)/e;this.end.y=c(this.end.y*e)/e;return this},scale:function(t,e,i){this.start.scale(t,e,i);this.end.scale(t,e,i);return this},setLength:function(t){var e=this.length();if(!e)return this;var i=t/e;return this.scale(i,i,this.start)},squaredLength:function(){var t=this.start.x;var e=this.start.y;var i=this.end.x;var r=this.end.y;return(t-=i)*t+(e-=r)*e},tangentAt:function(t){if(!this.isDifferentiable())return null;var e=this.start;var i=this.end;var r=this.pointAt(t);var n=new p(e,i);n.translate(r.x-e.x,r.y-e.y);return n},tangentAtLength:function(t){if(!this.isDifferentiable())return null;var e=this.start;var i=this.end;var r=this.pointAtLength(t);var n=new p(e,i);n.translate(r.x-e.x,r.y-e.y);return n},translate:function(t,e){this.start.translate(t,e);this.end.translate(t,e);return this},vector:function(){return new m(this.end.x-this.start.x,this.end.y-this.start.y)},toString:function(){return this.start.toString()+" "+this.end.toString()}};p.prototype.intersection=p.prototype.intersect;var I=t.Path=function(t){if(!(this instanceof I)){return new I(t)}if(typeof t==="string"){return new I.parse(t)}this.segments=[];var e;var i;if(!t){}else if(Array.isArray(t)&&t.length!==0){i=t.length;if(t[0].isSegment){for(e=0;e<i;e++){var r=t[e];this.appendSegment(r)}}else{var n=null;for(e=0;e<i;e++){var a=t[e];if(!(a instanceof p||a instanceof f)){throw new Error("Cannot construct a path segment from the provided object.")}if(e===0)this.appendSegment(I.createSegment("M",a.start));if(n&&!n.end.equals(a.start))this.appendSegment(I.createSegment("M",a.start));if(a instanceof p){this.appendSegment(I.createSegment("L",a.end))}else if(a instanceof f){this.appendSegment(I.createSegment("C",a.controlPoint1,a.controlPoint2,a.end))}n=a}}}else if(t.isSegment){this.appendSegment(t)}else if(t instanceof p){this.appendSegment(I.createSegment("M",t.start));this.appendSegment(I.createSegment("L",t.end))}else if(t instanceof f){this.appendSegment(I.createSegment("M",t.start));this.appendSegment(I.createSegment("C",t.controlPoint1,t.controlPoint2,t.end))}else if(t instanceof C&&t.points&&t.points.length!==0){i=t.points.length;for(e=0;e<i;e++){var o=t.points[e];if(e===0)this.appendSegment(I.createSegment("M",o));else this.appendSegment(I.createSegment("L",o))}}};I.parse=function(t){if(!t)return new I;var e=new I;var i=/(?:[a-zA-Z] *)(?:(?:-?\d+(?:\.\d+)? *,? *)|(?:-?\.\d+ *,? *))+|(?:[a-zA-Z] *)(?! |\d|-|\.)/g;var r=t.match(i);var n=r.length;for(var a=0;a<n;a++){var o=r[a];var s=/(?:[a-zA-Z])|(?:(?:-?\d+(?:\.\d+)?))|(?:(?:-?\.\d+))/g;var l=o.match(s);var c=I.createSegment.apply(this,l);e.appendSegment(c)}return e};I.createSegment=function(t){if(!t)throw new Error("Type must be provided.");var e=I.segmentTypes[t];if(!e)throw new Error(t+" is not a recognized path segment type.");var i=[];var r=arguments.length;for(var n=1;n<r;n++){i.push(arguments[n])}return M(e,i)},I.prototype={appendSegment:function(t){var e=this.segments;var i=e.length;var r;var n=i!==0?e[i-1]:null;var a=null;if(!Array.isArray(t)){if(!t||!t.isSegment)throw new Error("Segment required.");r=this.prepareSegment(t,n,a);e.push(r)}else{if(!t[0].isSegment)throw new Error("Segments required.");var o=t.length;for(var s=0;s<o;s++){var l=t[s];r=this.prepareSegment(l,n,a);e.push(r);n=r}}},bbox:function(){var t=this.segments;var e=t.length;if(e===0)return null;var i;for(var r=0;r<e;r++){var n=t[r];if(n.isVisible){var a=n.bbox();i=i?i.union(a):a}}if(i)return i;var o=t[e-1];return new A(o.end.x,o.end.y,0,0)},clone:function(){var t=this.segments;var e=t.length;var i=new I;for(var r=0;r<e;r++){var n=t[r].clone();i.appendSegment(n)}return i},closestPoint:function(t,e){var i=this.closestPointT(t,e);if(!i)return null;return this.pointAtT(i)},closestPointLength:function(t,e){e=e||{};var i=e.precision===undefined?this.PRECISION:e.precision;var r=e.segmentSubdivisions===undefined?this.getSegmentSubdivisions({precision:i}):e.segmentSubdivisions;var n={precision:i,segmentSubdivisions:r};var a=this.closestPointT(t,n);if(!a)return 0;return this.lengthAtT(a,n)},closestPointNormalizedLength:function(t,e){e=e||{};var i=e.precision===undefined?this.PRECISION:e.precision;var r=e.segmentSubdivisions===undefined?this.getSegmentSubdivisions({precision:i}):e.segmentSubdivisions;var n={precision:i,segmentSubdivisions:r};var a=this.closestPointLength(t,n);if(a===0)return 0;var o=this.length(n);if(o===0)return 0;return a/o},closestPointT:function(t,e){var i=this.segments;var r=i.length;if(r===0)return null;e=e||{};var n=e.precision===undefined?this.PRECISION:e.precision;var a=e.segmentSubdivisions===undefined?this.getSegmentSubdivisions({precision:n}):e.segmentSubdivisions;var o;var s=Infinity;for(var l=0;l<r;l++){var c=i[l];var u=a[l];if(c.isVisible){var g=c.closestPointT(t,{precision:n,subdivisions:u});var h=c.pointAtT(g);var d=new p(h,t).squaredLength();if(d<s){o={segmentIndex:l,value:g};s=d}}}if(o)return o;return{segmentIndex:r-1,value:1}},closestPointTangent:function(t,e){var i=this.segments;var r=i.length;if(r===0)return null;e=e||{};var n=e.precision===undefined?this.PRECISION:e.precision;var a=e.segmentSubdivisions===undefined?this.getSegmentSubdivisions({precision:n}):e.segmentSubdivisions;var o;var s=Infinity;for(var l=0;l<r;l++){var c=i[l];var u=a[l];if(c.isDifferentiable()){var g=c.closestPointT(t,{precision:n,subdivisions:u});var h=c.pointAtT(g);var d=new p(h,t).squaredLength();if(d<s){o=c.tangentAtT(g);s=d}}}if(o)return o;return null},equals:function(t){if(!t)return false;var e=this.segments;var i=t.segments;var r=e.length;if(i.length!==r)return false;for(var n=0;n<r;n++){var a=e[n];var o=i[n];if(a.type!==o.type||!a.equals(o))return false}return true},getSegment:function(t){var e=this.segments;var i=e.length;if(!i===0)throw new Error("Path has no segments.");if(t<0)t=i+t;if(t>=i||t<0)throw new Error("Index out of range.");return e[t]},getSegmentSubdivisions:function(t){var e=this.segments;var i=e.length;t=t||{};var r=t.precision===undefined?this.PRECISION:t.precision;var n=[];for(var a=0;a<i;a++){var o=e[a];var s=o.getSubdivisions({precision:r});n.push(s)}return n},insertSegment:function(t,e){var i=this.segments;var r=i.length;if(t<0)t=r+t+1;if(t>r||t<0)throw new Error("Index out of range.");var n;var a=null;var o=null;if(r!==0){if(t>=1){a=i[t-1];o=a.nextSegment}else{o=i[0]}}if(!Array.isArray(e)){if(!e||!e.isSegment)throw new Error("Segment required.");n=this.prepareSegment(e,a,o);i.splice(t,0,n)}else{if(!e[0].isSegment)throw new Error("Segments required.");var s=e.length;for(var l=0;l<s;l++){var c=e[l];n=this.prepareSegment(c,a,o);i.splice(t+l,0,n);a=n}}},isDifferentiable:function(){var t=this.segments;var e=t.length;for(var i=0;i<e;i++){var r=t[i];if(r.isDifferentiable())return true}return false},isValid:function(){var t=this.segments;var e=t.length===0||t[0].type==="M";return e},length:function(t){var e=this.segments;var i=e.length;if(i===0)return 0;t=t||{};var r=t.precision===undefined?this.PRECISION:t.precision;var n=t.segmentSubdivisions===undefined?this.getSegmentSubdivisions({precision:r}):t.segmentSubdivisions;var a=0;for(var o=0;o<i;o++){var s=e[o];var l=n[o];a+=s.length({subdivisions:l})}return a},lengthAtT:function(t,e){var i=this.segments;var r=i.length;if(r===0)return 0;var n=t.segmentIndex;if(n<0)return 0;var a=t.value;if(n>=r){n=r-1;a=1}else if(a<0)a=0;else if(a>1)a=1;e=e||{};var o=e.precision===undefined?this.PRECISION:e.precision;var s=e.segmentSubdivisions===undefined?this.getSegmentSubdivisions({precision:o}):e.segmentSubdivisions;var l;var c=0;for(var u=0;u<n;u++){var g=i[u];l=s[u];c+=g.length({precisison:o,subdivisions:l})}g=i[n];l=s[n];c+=g.lengthAtT(a,{precisison:o,subdivisions:l});return c},pointAt:function(t,e){var i=this.segments;var r=i.length;if(r===0)return null;if(t<=0)return this.start.clone();if(t>=1)return this.end.clone();e=e||{};var n=e.precision===undefined?this.PRECISION:e.precision;var a=e.segmentSubdivisions===undefined?this.getSegmentSubdivisions({precision:n}):e.segmentSubdivisions;var o={precision:n,segmentSubdivisions:a};var s=this.length(o);var l=s*t;return this.pointAtLength(l,o)},pointAtLength:function(t,e){var i=this.segments;var r=i.length;if(r===0)return null;if(t===0)return this.start.clone();var n=true;if(t<0){n=false;t=-t}e=e||{};var a=e.precision===undefined?this.PRECISION:e.precision;var o=e.segmentSubdivisions===undefined?this.getSegmentSubdivisions({precision:a}):e.segmentSubdivisions;var s;var l=0;for(var c=n?0:r-1;n?c<r:c>=0;n?c++:c--){var u=i[c];var g=o[c];var h=u.length({precision:a,subdivisions:g});if(u.isVisible){if(t<=l+h){return u.pointAtLength((n?1:-1)*(t-l),{precision:a,subdivisions:g})}s=u}l+=h}if(s)return n?s.end:s.start;var d=i[r-1];return d.end.clone()},pointAtT:function(t){var e=this.segments;var i=e.length;if(i===0)return null;var r=t.segmentIndex;if(r<0)return e[0].pointAtT(0);if(r>=i)return e[i-1].pointAtT(1);var n=t.value;if(n<0)n=0;else if(n>1)n=1;return e[r].pointAtT(n)},prepareSegment:function(t,e,i){t.previousSegment=e;t.nextSegment=i;if(e)e.nextSegment=t;if(i)i.previousSegment=t;var r=t;if(t.isSubpathStart){t.subpathStartSegment=t;r=i}if(r)this.updateSubpathStartSegment(r);return t},PRECISION:3,removeSegment:function(t){var e=this.segments;var i=e.length;if(i===0)throw new Error("Path has no segments.");if(t<0)t=i+t;if(t>=i||t<0)throw new Error("Index out of range.");var r=e.splice(t,1)[0];var n=r.previousSegment;var a=r.nextSegment;if(n)n.nextSegment=a;if(a)a.previousSegment=n;if(r.isSubpathStart&&a)this.updateSubpathStartSegment(a)},replaceSegment:function(t,e){var i=this.segments;var r=i.length;if(r===0)throw new Error("Path has no segments.");if(t<0)t=r+t;if(t>=r||t<0)throw new Error("Index out of range.");var n;var a=i[t];var o=a.previousSegment;var s=a.nextSegment;var l=a.isSubpathStart;if(!Array.isArray(e)){if(!e||!e.isSegment)throw new Error("Segment required.");n=this.prepareSegment(e,o,s);i.splice(t,1,n);if(l&&n.isSubpathStart)l=false}else{if(!e[0].isSegment)throw new Error("Segments required.");i.splice(t,1);var c=e.length;for(var u=0;u<c;u++){var g=e[u];n=this.prepareSegment(g,o,s);i.splice(t+u,0,n);o=n;if(l&&n.isSubpathStart)l=false}}if(l&&s)this.updateSubpathStartSegment(s)},scale:function(t,e,i){var r=this.segments;var n=r.length;for(var a=0;a<n;a++){var o=r[a];o.scale(t,e,i)}return this},segmentAt:function(t,e){var i=this.segmentIndexAt(t,e);if(!i)return null;return this.getSegment(i)},segmentAtLength:function(t,e){var i=this.segmentIndexAtLength(t,e);if(!i)return null;return this.getSegment(i)},segmentIndexAt:function(t,e){var i=this.segments;var r=i.length;if(r===0)return null;if(t<0)t=0;if(t>1)t=1;e=e||{};var n=e.precision===undefined?this.PRECISION:e.precision;var a=e.segmentSubdivisions===undefined?this.getSegmentSubdivisions({precision:n}):e.segmentSubdivisions;var o={precision:n,segmentSubdivisions:a};var s=this.length(o);var l=s*t;return this.segmentIndexAtLength(l,o)},toPoints:function(t){var e=this.segments;var i=e.length;if(i===0)return null;t=t||{};var r=t.precision===undefined?this.PRECISION:t.precision;var n=t.segmentSubdivisions===undefined?this.getSegmentSubdivisions({precision:r}):t.segmentSubdivisions;var a=[];var o=[];for(var s=0;s<i;s++){var l=e[s];if(l.isVisible){var c=n[s];if(c.length>0){var u=c.map(function(t){return t.start});Array.prototype.push.apply(o,u)}else{o.push(l.start)}}else if(o.length>0){o.push(e[s-1].end);a.push(o);o=[]}}if(o.length>0){o.push(this.end);a.push(o)}return a},toPolylines:function(t){var e=[];var i=this.toPoints(t);if(!i)return null;for(var r=0,n=i.length;r<n;r++){e.push(new C(i[r]))}return e},intersectionWithLine:function(t,e){var i=null;var r=this.toPolylines(e);if(!r)return null;for(var n=0,a=r.length;n<a;n++){var o=r[n];var s=t.intersect(o);if(s){i||(i=[]);if(Array.isArray(s)){Array.prototype.push.apply(i,s)}else{i.push(s)}}}return i},segmentIndexAtLength:function(t,e){var i=this.segments;var r=i.length;if(r===0)return null;var n=true;if(t<0){n=false;t=-t}e=e||{};var a=e.precision===undefined?this.PRECISION:e.precision;var o=e.segmentSubdivisions===undefined?this.getSegmentSubdivisions({precision:a}):e.segmentSubdivisions;var s=null;var l=0;for(var c=n?0:r-1;n?c<r:c>=0;n?c++:c--){var u=i[c];var g=o[c];var h=u.length({precision:a,subdivisions:g});if(u.isVisible){if(t<=l+h)return c;s=c}l+=h}return s},tangentAt:function(t,e){var i=this.segments;var r=i.length;if(r===0)return null;if(t<0)t=0;if(t>1)t=1;e=e||{};var n=e.precision===undefined?this.PRECISION:e.precision;var a=e.segmentSubdivisions===undefined?this.getSegmentSubdivisions({precision:n}):e.segmentSubdivisions;var o={precision:n,segmentSubdivisions:a};var s=this.length(o);var l=s*t;return this.tangentAtLength(l,o)},tangentAtLength:function(t,e){var i=this.segments;var r=i.length;if(r===0)return null;var n=true;if(t<0){n=false;t=-t}e=e||{};var a=e.precision===undefined?this.PRECISION:e.precision;var o=e.segmentSubdivisions===undefined?this.getSegmentSubdivisions({precision:a}):e.segmentSubdivisions;var s;var l=0;for(var c=n?0:r-1;n?c<r:c>=0;n?c++:c--){var u=i[c];var g=o[c];var h=u.length({precision:a,subdivisions:g});if(u.isDifferentiable()){if(t<=l+h){return u.tangentAtLength((n?1:-1)*(t-l),{precision:a,subdivisions:g})}s=u}l+=h}if(s){var d=n?1:0;return s.tangentAtT(d)}return null},tangentAtT:function(t){var e=this.segments;var i=e.length;if(i===0)return null;var r=t.segmentIndex;if(r<0)return e[0].tangentAtT(0);if(r>=i)return e[i-1].tangentAtT(1);var n=t.value;if(n<0)n=0;else if(n>1)n=1;return e[r].tangentAtT(n)},translate:function(t,e){var i=this.segments;var r=i.length;for(var n=0;n<r;n++){var a=i[n];a.translate(t,e)}return this},updateSubpathStartSegment:function(t){var e=t.previousSegment;while(t&&!t.isSubpathStart){if(e)t.subpathStartSegment=e.subpathStartSegment;else t.subpathStartSegment=null;e=t;t=t.nextSegment}},serialize:function(){if(!this.isValid())throw new Error("Invalid path segments.");return this.toString()},toString:function(){var t=this.segments;var e=t.length;var i="";for(var r=0;r<e;r++){var n=t[r];i+=n.serialize()+" "}return i.trim()}};Object.defineProperty(I.prototype,"start",{configurable:true,enumerable:true,get:function(){var t=this.segments;var e=t.length;if(e===0)return null;for(var i=0;i<e;i++){var r=t[i];if(r.isVisible)return r.start}return t[e-1].end}});Object.defineProperty(I.prototype,"end",{configurable:true,enumerable:true,get:function(){var t=this.segments;var e=t.length;if(e===0)return null;for(var i=e-1;i>=0;i--){var r=t[i];if(r.isVisible)return r.end}return t[e-1].end}});var m=t.Point=function(t,e){if(!(this instanceof m)){return new m(t,e)}if(typeof t==="string"){var i=t.split(t.indexOf("@")===-1?" ":"@");t=parseFloat(i[0]);e=parseFloat(i[1])}else if(Object(t)===t){e=t.y;t=t.x}this.x=t===undefined?0:t;this.y=e===undefined?0:e};m.fromPolar=function(t,e,a){a=a&&new m(a)||new m(0,0);var o=i(t*r(e));var s=i(t*n(e));var l=w(y(e));if(l<90){s=-s}else if(l<180){o=-o;s=-s}else if(l<270){o=-o}return new m(a.x+o,a.y+s)};m.random=function(t,e,i,r){return new m(u(h()*(e-t+1)+t),u(h()*(r-i+1)+i))};m.prototype={adhereToRect:function(t){if(t.containsPoint(this)){return this}this.x=o(s(this.x,t.x),t.x+t.width);this.y=o(s(this.y,t.y),t.y+t.height);return this},bearing:function(t){return new p(this,t).bearing()},changeInAngle:function(t,e,i){return this.clone().offset(-t,-e).theta(i)-this.theta(i)},clone:function(){return new m(this)},difference:function(t,e){if(Object(t)===t){e=t.y;t=t.x}return new m(this.x-(t||0),this.y-(e||0))},distance:function(t){return new p(this,t).length()},squaredDistance:function(t){return new p(this,t).squaredLength()},equals:function(t){return!!t&&this.x===t.x&&this.y===t.y},magnitude:function(){return a(this.x*this.x+this.y*this.y)||.01},manhattanDistance:function(t){return i(t.x-this.x)+i(t.y-this.y)},move:function(t,e){var i=N(new m(t).theta(this));var a=this.offset(r(i)*e,-n(i)*e);return a},normalize:function(t){var e=(t||1)/this.magnitude();return this.scale(e,e)},offset:function(t,e){if(Object(t)===t){e=t.y;t=t.x}this.x+=t||0;this.y+=e||0;return this},reflection:function(t){return new m(t).move(this,this.distance(t))},rotate:function(e,i){e=e||new t.Point(0,0);i=N(w(-i));var a=r(i);var o=n(i);var s=a*(this.x-e.x)-o*(this.y-e.y)+e.x;var l=o*(this.x-e.x)+a*(this.y-e.y)+e.y;this.x=s;this.y=l;return this},round:function(t){var e=d(10,t||0);this.x=c(this.x*e)/e;this.y=c(this.y*e)/e;return this},scale:function(t,e,i){i=i&&new m(i)||new m(0,0);this.x=i.x+t*(this.x-i.x);this.y=i.y+e*(this.y-i.y);return this},snapToGrid:function(t,e){this.x=b(this.x,t);this.y=b(this.y,e||t);return this},theta:function(t){t=new m(t);var e=-(t.y-this.y);var i=t.x-this.x;var r=l(e,i);if(r<0){r=2*g+r}return 180*r/g},angleBetween:function(t,e){var i=this.equals(t)||this.equals(e)?NaN:this.theta(e)-this.theta(t);if(i<0){i+=360}return i},vectorAngle:function(t){var e=new m(0,0);return e.angleBetween(this,t)},toJSON:function(){return{x:this.x,y:this.y}},toPolar:function(t){t=t&&new m(t)||new m(0,0);var e=this.x;var i=this.y;this.x=a((e-t.x)*(e-t.x)+(i-t.y)*(i-t.y));this.y=N(t.theta(new m(e,i)));return this},toString:function(){return this.x+"@"+this.y},update:function(t,e){this.x=t||0;this.y=e||0;return this},dot:function(t){return t?this.x*t.x+this.y*t.y:NaN},cross:function(t,e){return t&&e?(e.x-this.x)*(t.y-this.y)-(e.y-this.y)*(t.x-this.x):NaN},lerp:function(t,e){var i=this.x;var r=this.y;return new m((1-e)*i+e*t.x,(1-e)*r+e*t.y)}};m.prototype.translate=m.prototype.offset;var A=t.Rect=function(t,e,i,r){if(!(this instanceof A)){return new A(t,e,i,r)}if(Object(t)===t){e=t.y;i=t.width;r=t.height;t=t.x}this.x=t===undefined?0:t;this.y=e===undefined?0:e;this.width=i===undefined?0:i;this.height=r===undefined?0:r};A.fromEllipse=function(t){t=new v(t);return new A(t.x-t.a,t.y-t.b,2*t.a,2*t.b)};A.prototype={bbox:function(t){if(!t)return this.clone();var e=N(t||0);var a=i(n(e));var o=i(r(e));var s=this.width*o+this.height*a;var l=this.width*a+this.height*o;return new A(this.x+(this.width-s)/2,this.y+(this.height-l)/2,s,l)},bottomLeft:function(){return new m(this.x,this.y+this.height)},bottomLine:function(){return new p(this.bottomLeft(),this.bottomRight())},bottomMiddle:function(){return new m(this.x+this.width/2,this.y+this.height)},center:function(){return new m(this.x+this.width/2,this.y+this.height/2)},clone:function(){return new A(this)},containsPoint:function(t){t=new m(t);return t.x>=this.x&&t.x<=this.x+this.width&&t.y>=this.y&&t.y<=this.y+this.height},containsRect:function(t){var e=new A(this).normalize();var i=new A(t).normalize();var r=e.width;var n=e.height;var a=i.width;var o=i.height;if(!r||!n||!a||!o){return false}var s=e.x;var l=e.y;var c=i.x;var u=i.y;a+=c;r+=s;o+=u;n+=l;return s<=c&&a<=r&&l<=u&&o<=n},corner:function(){return new m(this.x+this.width,this.y+this.height)},equals:function(t){var e=new A(this).normalize();var i=new A(t).normalize();return e.x===i.x&&e.y===i.y&&e.width===i.width&&e.height===i.height},intersect:function(t){var e=this.origin();var i=this.corner();var r=t.origin();var n=t.corner();if(n.x<=e.x||n.y<=e.y||r.x>=i.x||r.y>=i.y)return null;var a=s(e.x,r.x);var l=s(e.y,r.y);return new A(a,l,o(i.x,n.x)-a,o(i.y,n.y)-l)},intersectionWithLine:function(t){var e=this;var i=[e.topLine(),e.rightLine(),e.bottomLine(),e.leftLine()];var r=[];var n=[];var a,o;var s=i.length;for(o=0;o<s;o++){a=t.intersect(i[o]);if(a!==null&&n.indexOf(a.toString())<0){r.push(a);n.push(a.toString())}}return r.length>0?r:null},intersectionWithLineFromCenterToPoint:function(t,e){t=new m(t);var i=new m(this.x+this.width/2,this.y+this.height/2);var r;if(e)t.rotate(i,e);var n=[this.topLine(),this.rightLine(),this.bottomLine(),this.leftLine()];var a=new p(i,t);for(var o=n.length-1;o>=0;--o){var s=n[o].intersection(a);if(s!==null){r=s;break}}if(r&&e)r.rotate(i,-e);return r},leftLine:function(){return new p(this.topLeft(),this.bottomLeft())},leftMiddle:function(){return new m(this.x,this.y+this.height/2)},moveAndExpand:function(t){this.x+=t.x||0;this.y+=t.y||0;this.width+=t.width||0;this.height+=t.height||0;return this},offset:function(t,e){return m.prototype.offset.call(this,t,e)},inflate:function(t,e){if(t===undefined){t=0}if(e===undefined){e=t}this.x-=t;this.y-=e;this.width+=2*t;this.height+=2*e;return this},normalize:function(){var t=this.x;var e=this.y;var i=this.width;var r=this.height;if(this.width<0){t=this.x+this.width;i=-this.width}if(this.height<0){e=this.y+this.height;r=-this.height}this.x=t;this.y=e;this.width=i;this.height=r;return this},origin:function(){return new m(this.x,this.y)},pointNearestToPoint:function(t){t=new m(t);if(this.containsPoint(t)){var e=this.sideNearestToPoint(t);switch(e){case"right":return new m(this.x+this.width,t.y);case"left":return new m(this.x,t.y);case"bottom":return new m(t.x,this.y+this.height);case"top":return new m(t.x,this.y)}}return t.adhereToRect(this)},rightLine:function(){return new p(this.topRight(),this.bottomRight())},rightMiddle:function(){return new m(this.x+this.width,this.y+this.height/2)},round:function(t){var e=d(10,t||0);this.x=c(this.x*e)/e;this.y=c(this.y*e)/e;this.width=c(this.width*e)/e;this.height=c(this.height*e)/e;return this},scale:function(t,e,i){i=this.origin().scale(t,e,i);this.x=i.x;this.y=i.y;this.width*=t;this.height*=e;return this},maxRectScaleToFit:function(t,e){t=new A(t);e||(e=t.center());var i,r,n,a,s,l,c,u;var g=e.x;var h=e.y;i=r=n=a=s=l=c=u=Infinity;var d=t.topLeft();if(d.x<g){i=(this.x-g)/(d.x-g)}if(d.y<h){s=(this.y-h)/(d.y-h)}var f=t.bottomRight();if(f.x>g){r=(this.x+this.width-g)/(f.x-g)}if(f.y>h){l=(this.y+this.height-h)/(f.y-h)}var v=t.topRight();if(v.x>g){n=(this.x+this.width-g)/(v.x-g)}if(v.y<h){c=(this.y-h)/(v.y-h)}var p=t.bottomLeft();if(p.x<g){a=(this.x-g)/(p.x-g)}if(p.y>h){u=(this.y+this.height-h)/(p.y-h)}return{sx:o(i,r,n,a),sy:o(s,l,c,u)}},maxRectUniformScaleToFit:function(t,e){var i=this.maxRectScaleToFit(t,e);return o(i.sx,i.sy)},sideNearestToPoint:function(t){t=new m(t);var e=t.x-this.x;var i=this.x+this.width-t.x;var r=t.y-this.y;var n=this.y+this.height-t.y;var a=e;var o="left";if(i<a){a=i;o="right"}if(r<a){a=r;o="top"}if(n<a){a=n;o="bottom"}return o},snapToGrid:function(t,e){var i=this.origin().snapToGrid(t,e);var r=this.corner().snapToGrid(t,e);this.x=i.x;this.y=i.y;this.width=r.x-i.x;this.height=r.y-i.y;return this},topLine:function(){return new p(this.topLeft(),this.topRight())},topMiddle:function(){return new m(this.x+this.width/2,this.y)},topRight:function(){return new m(this.x+this.width,this.y)},toJSON:function(){return{x:this.x,y:this.y,width:this.width,height:this.height}},toString:function(){return this.origin().toString()+" "+this.corner().toString()},union:function(t){t=new A(t);var e=this.origin();var i=this.corner();var r=t.origin();var n=t.corner();var a=o(e.x,r.x);var l=o(e.y,r.y);var c=s(i.x,n.x);var u=s(i.y,n.y);return new A(a,l,c-a,u-l)}};A.prototype.bottomRight=A.prototype.corner;A.prototype.topLeft=A.prototype.origin;A.prototype.translate=A.prototype.offset;var C=t.Polyline=function(t){if(!(this instanceof C)){return new C(t)}if(typeof t==="string"){return new C.parse(t)}this.points=Array.isArray(t)?t.map(m):[]};C.parse=function(t){if(t==="")return new C;var e=[];var i=t.split(/\s|,/);var r=i.length;for(var n=0;n<r;n+=2){e.push({x:+i[n],y:+i[n+1]})}return new C(e)};C.prototype={bbox:function(){var t=Infinity;var e=-Infinity;var i=Infinity;var r=-Infinity;var n=this.points;var a=n.length;if(a===0)return null;for(var o=0;o<a;o++){var s=n[o];var l=s.x;var c=s.y;if(l<t)t=l;if(l>e)e=l;if(c<i)i=c;if(c>r)r=c}return new A(t,i,e-t,r-i)},clone:function(){var t=this.points;var e=t.length;if(e===0)return new C;var i=[];for(var r=0;r<e;r++){var n=t[r].clone();i.push(n)}return new C(i)},closestPoint:function(t){var e=this.closestPointLength(t);return this.pointAtLength(e)},closestPointLength:function(t){var e=this.points;var i=e.length;if(i===0)return 0;if(i===1)return 0;var r;var n=Infinity;var a=0;var o=i-1;for(var s=0;s<o;s++){var l=new p(e[s],e[s+1]);var c=l.length();var u=l.closestPointNormalizedLength(t);var g=l.pointAt(u);var h=g.squaredDistance(t);if(h<n){n=h;r=a+u*c}a+=c}return r},closestPointNormalizedLength:function(t){var e=this.closestPointLength(t);if(e===0)return 0;var i=this.length();if(i===0)return 0;return e/i},closestPointTangent:function(t){var e=this.closestPointLength(t);return this.tangentAtLength(e)},convexHull:function(){var t;var e;var r=this.points;var n=r.length;if(n===0)return new C;var a;for(t=0;t<n;t++){if(a===undefined){a=r[t]}else if(r[t].y<a.y){a=r[t]}else if(r[t].y===a.y&&r[t].x>a.x){a=r[t]}}var o=[];for(t=0;t<n;t++){var s=a.theta(r[t]);if(s===0){s=360}var l=[r[t],t,s];o.push(l)}o.sort(function(t,e){var i=t[2]-e[2];if(i===0){i=e[1]-t[1]}return i});if(o.length>2){var c=o[o.length-1];o.unshift(c)}var u={};var g=[];var h;var d;var f;var v;var p;var I;while(o.length!==0){h=o.pop();d=h[0];if(u.hasOwnProperty(h[0]+"@@"+h[1])){continue}var m=false;while(!m){if(g.length<2){g.push(h);m=true}else{f=g.pop();v=f[0];p=g.pop();I=p[0];var A=I.cross(v,d);if(A<0){g.push(p);g.push(f);g.push(h);m=true}else if(A===0){var w=1e-10;var b=v.angleBetween(I,d);if(i(b-180)<w){u[f[0]+"@@"+f[1]]=v;g.push(p)}else if(v.equals(d)||I.equals(v)){u[f[0]+"@@"+f[1]]=v;g.push(p)}else if(i((b+1)%360-1)<w){g.push(p);o.push(f)}}else{u[f[0]+"@@"+f[1]]=v;g.push(p)}}}}if(g.length>2){g.pop()}var y;var N=-1;e=g.length;for(t=0;t<e;t++){var M=g[t][1];if(y===undefined||M<y){y=M;N=t}}var x=[];if(N>0){var k=g.slice(N);var z=g.slice(0,N);x=k.concat(z)}else{x=g}var D=[];e=x.length;for(t=0;t<e;t++){D.push(x[t][0])}return new C(D)},equals:function(t){if(!t)return false;var e=this.points;var i=t.points;var r=e.length;if(i.length!==r)return false;for(var n=0;n<r;n++){var a=e[n];var o=t.points[n];if(!a.equals(o))return false}return true},isDifferentiable:function(){var t=this.points;var e=t.length;if(e===0)return false;var i=e-1;for(var r=0;r<i;r++){var n=t[r];var a=t[r+1];var o=new p(n,a);if(o.isDifferentiable())return true}return false},length:function(){var t=this.points;var e=t.length;if(e===0)return 0;var i=0;var r=e-1;for(var n=0;n<r;n++){i+=t[n].distance(t[n+1])}return i},pointAt:function(t){var e=this.points;var i=e.length;if(i===0)return null;if(i===1)return e[0].clone();if(t<=0)return e[0].clone();if(t>=1)return e[i-1].clone();var r=this.length();var n=r*t;return this.pointAtLength(n)},pointAtLength:function(t){var e=this.points;var i=e.length;if(i===0)return null;if(i===1)return e[0].clone();var r=true;if(t<0){r=false;t=-t}var n=0;var a=i-1;for(var o=r?0:a-1;r?o<a:o>=0;r?o++:o--){var s=e[o];var l=e[o+1];var c=new p(s,l);var u=s.distance(l);if(t<=n+u){return c.pointAtLength((r?1:-1)*(t-n))}n+=u}var g=r?e[i-1]:e[0];return g.clone()},scale:function(t,e,i){var r=this.points;var n=r.length;if(n===0)return this;for(var a=0;a<n;a++){r[a].scale(t,e,i)}return this},tangentAt:function(t){var e=this.points;var i=e.length;if(i===0)return null;if(i===1)return null;if(t<0)t=0;if(t>1)t=1;var r=this.length();var n=r*t;return this.tangentAtLength(n)},tangentAtLength:function(t){var e=this.points;var i=e.length;if(i===0)return null;if(i===1)return null;var r=true;if(t<0){r=false;t=-t}var n;var a=0;var o=i-1;for(var s=r?0:o-1;r?s<o:s>=0;r?s++:s--){var l=e[s];var c=e[s+1];var u=new p(l,c);var g=l.distance(c);if(u.isDifferentiable()){if(t<=a+g){return u.tangentAtLength((r?1:-1)*(t-a))}n=u}a+=g}if(n){var h=r?1:0;return n.tangentAt(h)}return null},intersectionWithLine:function(t){var e=new p(t);var i=[];var r=this.points;for(var n=0,a=r.length-1;n<a;n++){var o=r[n];var s=r[n+1];var l=new p(o,s);var c=e.intersectionWithLine(l);if(c)i.push(c[0])}return i.length>0?i:null},translate:function(t,e){var i=this.points;var r=i.length;if(r===0)return this;for(var n=0;n<r;n++){i[n].translate(t,e)}return this},serialize:function(){var t=this.points;var e=t.length;if(e===0)return"";var i="";for(var r=0;r<e;r++){var n=t[r];i+=n.x+","+n.y+" "}return i.trim()},toString:function(){return this.points+""}};Object.defineProperty(C.prototype,"start",{configurable:true,enumerable:true,get:function(){var t=this.points;var e=t.length;if(e===0)return null;return this.points[0]}});Object.defineProperty(C.prototype,"end",{configurable:true,enumerable:true,get:function(){var t=this.points;var e=t.length;if(e===0)return null;return this.points[e-1]}});t.scale={linear:function(t,e,i){var r=t[1]-t[0];var n=e[1]-e[0];return(i-t[0])/r*n+e[0]||0}};var w=t.normalizeAngle=function(t){return t%360+(t<0?360:0)};var b=t.snapToGrid=function(t,e){return e*c(t/e)};var y=t.toDeg=function(t){return 180*t/g%360};var N=t.toRad=function(t,e){e=e||false;t=e?t:t%360;return t*g/180};t.ellipse=t.Ellipse;t.line=t.Line;t.point=t.Point;t.rect=t.Rect;function M(t,e){e.unshift(null);return new(Function.prototype.bind.apply(t,e))}function x(t){var e;var i;var r=[];i=arguments.length;for(e=1;e<i;e++){r.push(arguments[e])}if(!t)throw new Error("Missing a parent object.");var n=Object.create(t);i=r.length;for(e=0;e<i;e++){var a=r[e];var o;var s;for(s in a){if(a.hasOwnProperty(s)){delete n[s];o=Object.getOwnPropertyDescriptor(a,s);Object.defineProperty(n,s,o)}}}return n}var k={closestPointT:function(t){if(this.closestPointNormalizedLength)return this.closestPointNormalizedLength(t);throw new Error("Neither closestPointT() nor closestPointNormalizedLength() function is implemented.")},isSegment:true,isSubpathStart:false,isVisible:true,nextSegment:null,lengthAtT:function(t){if(t<=0)return 0;var e=this.length();if(t>=1)return e;return e*t},pointAtT:function(t){if(this.pointAt)return this.pointAt(t);throw new Error("Neither pointAtT() nor pointAt() function is implemented.")},previousSegment:null,subpathStartSegment:null,tangentAtT:function(t){if(this.tangentAt)return this.tangentAt(t);throw new Error("Neither tangentAtT() nor tangentAt() function is implemented.")},bbox:function(){throw new Error("Declaration missing for virtual function.")},clone:function(){throw new Error("Declaration missing for virtual function.")},closestPoint:function(){throw new Error("Declaration missing for virtual function.")},closestPointLength:function(){throw new Error("Declaration missing for virtual function.")},closestPointNormalizedLength:function(){throw new Error("Declaration missing for virtual function.")},closestPointTangent:function(){throw new Error("Declaration missing for virtual function.")},equals:function(){throw new Error("Declaration missing for virtual function.")},getSubdivisions:function(){throw new Error("Declaration missing for virtual function.")},isDifferentiable:function(){throw new Error("Declaration missing for virtual function.")},length:function(){throw new Error("Declaration missing for virtual function.")},pointAt:function(){throw new Error("Declaration missing for virtual function.")},pointAtLength:function(){throw new Error("Declaration missing for virtual function.")},scale:function(){throw new Error("Declaration missing for virtual function.")},tangentAt:function(){throw new Error("Declaration missing for virtual function.")},tangentAtLength:function(){throw new Error("Declaration missing for virtual function.")},translate:function(){throw new Error("Declaration missing for virtual function.")},serialize:function(){throw new Error("Declaration missing for virtual function.")},toString:function(){throw new Error("Declaration missing for virtual function.")}};var z=function(){var t=[];var e=arguments.length;for(var i=0;i<e;i++){t.push(arguments[i])}if(!(this instanceof z)){return M(z,t)}if(e===0){throw new Error("Lineto constructor expects 1 point or 2 coordinates (none provided).")}var r;if(typeof t[0]==="string"||typeof t[0]==="number"){if(e===2){this.end=new m(+t[0],+t[1]);return this}else if(e<2){throw new Error("Lineto constructor expects 1 point or 2 coordinates ("+e+" coordinates provided).")}else{var n;r=[];for(i=0;i<e;i+=2){n=t.slice(i,i+2);r.push(M(z,n))}return r}}else{if(e===1){this.end=new m(t[0]);return this}else{var a;r=[];for(i=0;i<e;i+=1){a=t[i];r.push(new z(a))}return r}}};var D={clone:function(){return new z(this.end)},getSubdivisions:function(){return[]},isDifferentiable:function(){if(!this.previousSegment)return false;return!this.start.equals(this.end)},scale:function(t,e,i){this.end.scale(t,e,i);return this},translate:function(t,e){this.end.translate(t,e);return this},type:"L",serialize:function(){var t=this.end;return this.type+" "+t.x+" "+t.y},toString:function(){return this.type+" "+this.start+" "+this.end}};Object.defineProperty(D,"start",{configurable:true,enumerable:true,get:function(){if(!this.previousSegment)throw new Error("Missing previous segment. (This segment cannot be the first segment of a path; OR segment has not yet been added to a path.)");return this.previousSegment.end}});z.prototype=x(k,p.prototype,D);var S=function(){var t=[];var e=arguments.length;for(var i=0;i<e;i++){t.push(arguments[i])}if(!(this instanceof S)){return M(S,t)}if(e===0){throw new Error("Curveto constructor expects 3 points or 6 coordinates (none provided).")}var r;if(typeof t[0]==="string"||typeof t[0]==="number"){if(e===6){this.controlPoint1=new m(+t[0],+t[1]);this.controlPoint2=new m(+t[2],+t[3]);this.end=new m(+t[4],+t[5]);return this}else if(e<6){throw new Error("Curveto constructor expects 3 points or 6 coordinates ("+e+" coordinates provided).")}else{var n;r=[];for(i=0;i<e;i+=6){n=t.slice(i,i+6);r.push(M(S,n))}return r}}else{if(e===3){this.controlPoint1=new m(t[0]);this.controlPoint2=new m(t[1]);this.end=new m(t[2]);return this}else if(e<3){throw new Error("Curveto constructor expects 3 points or 6 coordinates ("+e+" points provided).")}else{var a;r=[];for(i=0;i<e;i+=3){a=t.slice(i,i+3);r.push(M(S,a))}return r}}};var j={clone:function(){return new S(this.controlPoint1,this.controlPoint2,this.end)},isDifferentiable:function(){if(!this.previousSegment)return false;var t=this.start;var e=this.controlPoint1;var i=this.controlPoint2;var r=this.end;return!(t.equals(e)&&e.equals(i)&&i.equals(r))},scale:function(t,e,i){this.controlPoint1.scale(t,e,i);this.controlPoint2.scale(t,e,i);this.end.scale(t,e,i);return this},translate:function(t,e){this.controlPoint1.translate(t,e);this.controlPoint2.translate(t,e);this.end.translate(t,e);return this},type:"C",serialize:function(){var t=this.controlPoint1;var e=this.controlPoint2;var i=this.end;return this.type+" "+t.x+" "+t.y+" "+e.x+" "+e.y+" "+i.x+" "+i.y},toString:function(){return this.type+" "+this.start+" "+this.controlPoint1+" "+this.controlPoint2+" "+this.end}};Object.defineProperty(j,"start",{configurable:true,enumerable:true,get:function(){if(!this.previousSegment)throw new Error("Missing previous segment. (This segment cannot be the first segment of a path; OR segment has not yet been added to a path.)");return this.previousSegment.end}});S.prototype=x(k,f.prototype,j);var Z=function(){var t=[];var e=arguments.length;for(var i=0;i<e;i++){t.push(arguments[i])}if(!(this instanceof Z)){return M(Z,t)}if(e===0){throw new Error("Moveto constructor expects 1 point or 2 coordinates (none provided).")}var r;if(typeof t[0]==="string"||typeof t[0]==="number"){if(e===2){this.end=new m(+t[0],+t[1]);return this}else if(e<2){throw new Error("Moveto constructor expects 1 point or 2 coordinates ("+e+" coordinates provided).")}else{var n;r=[];for(i=0;i<e;i+=2){n=t.slice(i,i+2);if(i===0)r.push(M(Z,n));else r.push(M(z,n))}return r}}else{if(e===1){this.end=new m(t[0]);return this}else{var a;r=[];for(i=0;i<e;i+=1){a=t[i];if(i===0)r.push(new Z(a));else r.push(new z(a))}return r}}};var G={bbox:function(){return null},clone:function(){return new Z(this.end)},closestPoint:function(){return this.end.clone()},closestPointNormalizedLength:function(){return 0},closestPointLength:function(){return 0},closestPointT:function(){return 1},closestPointTangent:function(){return null},equals:function(t){return this.end.equals(t.end)},getSubdivisions:function(){return[]},isDifferentiable:function(){return false},isSubpathStart:true,isVisible:false,length:function(){return 0},lengthAtT:function(){return 0},pointAt:function(){return this.end.clone()},pointAtLength:function(){return this.end.clone()},pointAtT:function(){return this.end.clone()},scale:function(t,e,i){this.end.scale(t,e,i);return this},tangentAt:function(){return null},tangentAtLength:function(){return null},tangentAtT:function(){return null},translate:function(t,e){this.end.translate(t,e);return this},type:"M",serialize:function(){var t=this.end;return this.type+" "+t.x+" "+t.y},toString:function(){return this.type+" "+this.end}};Object.defineProperty(G,"start",{configurable:true,enumerable:true,get:function(){throw new Error("Illegal access. Moveto segments should not need a start property.")}});Z.prototype=x(k,G);var P=function(){var t=[];var e=arguments.length;for(var i=0;i<e;i++){t.push(arguments[i])}if(!(this instanceof P)){return M(P,t)}if(e>0){throw new Error("Closepath constructor expects no arguments.")}return this};var L={clone:function(){return new P},getSubdivisions:function(){return[]},isDifferentiable:function(){if(!this.previousSegment||!this.subpathStartSegment)return false;return!this.start.equals(this.end)},scale:function(){return this},translate:function(){return this},type:"Z",serialize:function(){return this.type},toString:function(){return this.type+" "+this.start+" "+this.end}};Object.defineProperty(L,"start",{configurable:true,enumerable:true,get:function(){if(!this.previousSegment)throw new Error("Missing previous segment. (This segment cannot be the first segment of a path; OR segment has not yet been added to a path.)");return this.previousSegment.end}});Object.defineProperty(L,"end",{configurable:true,enumerable:true,get:function(){if(!this.subpathStartSegment)throw new Error("Missing subpath start segment. (This segment needs a subpath start segment (e.g. Moveto); OR segment has not yet been added to a path.)");return this.subpathStartSegment.end}});P.prototype=x(k,p.prototype,L);var T=I.segmentTypes={L:z,C:S,M:Z,Z:P,z:P};I.regexSupportedData=new RegExp("^[\\s\\d"+Object.keys(T).join("")+",.]*$");I.isDataSupported=function(t){if(typeof t!=="string")return false;return this.regexSupportedData.test(t)};return t}();var a;var o;a=o=function(){"use strict";var t=typeof window==="object"&&!!(window.SVGAngle||document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1"));if(!t){return function(){throw new Error("SVG is required to use Vectorizer.")}}var e={xmlns:"http://www.w3.org/2000/svg",xml:"http://www.w3.org/XML/1998/namespace",xlink:"http://www.w3.org/1999/xlink",xhtml:"http://www.w3.org/1999/xhtml"};var i="1.1";var r=Math;var a=r.PI;var o=r.atan2;var s=r.sqrt;var l=r.min;var c=r.max;var u=r.cos;var g=r.sin;var h=function(t,i,r){if(!(this instanceof h)){return h.apply(Object.create(h.prototype),arguments)}if(!t)return;if(h.isV(t)){t=t.node}i=i||{};if(h.isString(t)){if(t.toLowerCase()==="svg"){t=h.createSvgDocument()}else if(t[0]==="<"){var n=h.createSvgDocument(t);if(n.childNodes.length>1){var a=[];var o,s;for(o=0,s=n.childNodes.length;o<s;o++){var l=n.childNodes[o];a.push(new h(document.importNode(l,true)))}return a}t=document.importNode(n.firstChild,true)}else{t=document.createElementNS(e.xmlns,t)}h.ensureId(t)}this.node=t;this.setAttributes(i);if(r){this.append(r)}return this};var d=h.prototype;Object.defineProperty(d,"id",{enumerable:true,get:function(){return this.node.id},set:function(t){this.node.id=t}});d.getTransformToElement=function(t){t=h.toNode(t);return t.getScreenCTM().inverse().multiply(this.node.getScreenCTM())};d.transform=function(t,e){var i=this.node;if(h.isUndefined(t)){return h.transformStringToMatrix(this.attr("transform"))}if(e&&e.absolute){return this.attr("transform",h.matrixToTransformString(t))}var r=h.createSVGTransform(t);i.transform.baseVal.appendItem(r);return this};d.translate=function(t,e,i){i=i||{};e=e||0;var r=this.attr("transform")||"";var n=h.parseTransformString(r);r=n.value;if(h.isUndefined(t)){return n.translate}r=r.replace(/translate\([^\)]*\)/g,"").trim();var a=i.absolute?t:n.translate.tx+t;var o=i.absolute?e:n.translate.ty+e;var s="translate("+a+","+o+")";this.attr("transform",(s+" "+r).trim());return this};d.rotate=function(t,e,i,r){r=r||{};var n=this.attr("transform")||"";var a=h.parseTransformString(n);n=a.value;if(h.isUndefined(t)){return a.rotate}n=n.replace(/rotate\([^\)]*\)/g,"").trim();t%=360;var o=r.absolute?t:a.rotate.angle+t;var s=e!==undefined&&i!==undefined?","+e+","+i:"";var l="rotate("+o+s+")";this.attr("transform",(n+" "+l).trim());return this};d.scale=function(t,e){e=h.isUndefined(e)?t:e;var i=this.attr("transform")||"";var r=h.parseTransformString(i);i=r.value;if(h.isUndefined(t)){return r.scale}i=i.replace(/scale\([^\)]*\)/g,"").trim();var n="scale("+t+","+e+")";this.attr("transform",(i+" "+n).trim());return this};d.bbox=function(t,e){var i;var r=this.node;var a=r.ownerSVGElement;if(!a){return new n.Rect(0,0,0,0)}try{i=r.getBBox()}catch(t){i={x:r.clientLeft,y:r.clientTop,width:r.clientWidth,height:r.clientHeight}}if(t){return new n.Rect(i)}var o=this.getTransformToElement(e||a);return h.transformRect(i,o)};d.getBBox=function(t){var e={};var i;var r=this.node;var a=r.ownerSVGElement;if(!a){return new n.Rect(0,0,0,0)}if(t){if(t.target){e.target=h.toNode(t.target)}if(t.recursive){e.recursive=t.recursive}}if(!e.recursive){try{i=r.getBBox()}catch(t){i={x:r.clientLeft,y:r.clientTop,width:r.clientWidth,height:r.clientHeight}}if(!e.target){return new n.Rect(i)}else{var o=this.getTransformToElement(e.target);return h.transformRect(i,o)}}else{var s=this.children();var l=s.length;if(l===0){return this.getBBox({target:e.target,recursive:false})}if(!e.target){e.target=this}for(var c=0;c<l;c++){var u=s[c];var g;if(u.children().length===0){g=u.getBBox({target:e.target,recursive:false})}else{g=u.getBBox({target:e.target,recursive:true})}if(!i){i=g}else{i=i.union(g)}}return i}};function f(t,e){t||(t={});var i=h("textPath");var r=t.d;if(r&&t["xlink:href"]===undefined){var n=h("path").attr("d",r).appendTo(e.defs());i.attr("xlink:href","#"+n.id)}if(h.isObject(t)){i.attr(t)}return i.node}function v(t,e,i){i||(i={});var r=i.includeAnnotationIndices;var n=i.eol;var a=i.lineHeight;var o=i.baseSize;var s=0;var l={};var c=e.length-1;for(var u=0;u<=c;u++){var g=e[u];var d=null;if(h.isObject(g)){var f=g.attrs;var v=h("tspan",f);var p=v.node;var I=g.t;if(n&&u===c)I+=n;p.textContent=I;var m=f["class"];if(m)v.addClass(m);if(r)v.attr("annotations",g.annotations);d=parseFloat(f["font-size"]);if(d===undefined)d=o;if(d&&d>s)s=d}else{if(n&&u===c)g+=n;p=document.createTextNode(g||" ");if(o&&o>s)s=o}t.appendChild(p)}if(s)l.maxFontSize=s;if(a){l.lineHeight=a}else if(s){l.lineHeight=s*1.2}return l}var p=/em$/;function I(t,e){var i=parseFloat(t);if(p.test(t))return i*e;return i}function m(t,e,i,r){if(!Array.isArray(e))return 0;var n=e.length;if(!n)return 0;var a=e[0];var o=I(a.maxFontSize,i)||i;var s=0;var l=I(r,i);for(var c=1;c<n;c++){a=e[c];var u=I(a.lineHeight,i)||l;s+=u}var g=I(a.maxFontSize,i)||i;var h;switch(t){case"middle":h=o/2-.15*g-s/2;break;case"bottom":h=-(.25*g)-s;break;default:case"top":h=.8*o;break}return h}d.text=function(t,e){if(t&&typeof t!=="string")throw new Error("Vectorizer: text() expects the first argument to be a string.");t=h.sanitizeText(t);e||(e={});var i=e.eol;var r=e.textPath;var n=e.textVerticalAnchor;var a=n==="middle"||n==="bottom"||n==="top";var o=e.x;if(o===undefined)o=this.attr("x")||0;var s=e.includeAnnotationIndices;var l=e.annotations;if(l&&!h.isArray(l))l=[l];var c=e.lineHeight;var u=c==="auto";var g=u?"1.5em":c||"1em";this.empty();this.attr({"xml:space":"preserve",display:t?null:"none"});var d=parseFloat(this.attr("font-size"));if(!d){d=16;if(a||l)this.attr("font-size",d)}var I=document;var A;if(r){if(typeof r==="string")r={d:r};A=f(r,this)}else{A=I.createDocumentFragment()}var C=0;var w=t.split("\n");var b=[];var y;for(var N=0,M=w.length-1;N<=M;N++){var x=g;var k="v-line";var z=I.createElementNS(h.namespace.xmlns,"tspan");var D=w[N];var S;if(D){if(l){var j=h.annotateString(D,l,{offset:-C,includeAnnotationIndices:s});S=v(z,j,{includeAnnotationIndices:s,eol:N!==M&&i,lineHeight:u?null:g,baseSize:d});var Z=S.lineHeight;if(Z&&u&&N!==0)x=Z;if(N===0)y=S.maxFontSize*.8}else{if(i&&N!==M)D+=i;z.textContent=D}}else{z.textContent="-";k+=" v-empty-line";var G=z.style;G.fillOpacity=0;G.strokeOpacity=0;if(l)S={}}if(S)b.push(S);if(N>0)z.setAttribute("dy",x);if(N>0||r)z.setAttribute("x",o);z.className.baseVal=k;A.appendChild(z);C+=D.length+1}if(a){if(l){x=m(n,b,d,g)}else if(n==="top"){x="0.8em"}else{var P;if(M>0){P=parseFloat(g)||1;P*=M;if(!p.test(g))P/=d}else{P=0}switch(n){case"middle":x=.3-P/2+"em";break;case"bottom":x=-P-.3+"em";break}}}else{if(n===0){x="0em"}else if(n){x=n}else{x=0;if(this.attr("y")===null)this.attr("y",y||"0.8em")}}A.firstChild.setAttribute("dy",x);this.append(A);return this};d.removeAttr=function(t){var e=h.qualifyAttr(t);var i=this.node;if(e.ns){if(i.hasAttributeNS(e.ns,e.local)){i.removeAttributeNS(e.ns,e.local)}}else if(i.hasAttribute(t)){i.removeAttribute(t)}return this};d.attr=function(t,e){if(h.isUndefined(t)){var i=this.node.attributes;var r={};for(var n=0;n<i.length;n++){r[i[n].name]=i[n].value}return r}if(h.isString(t)&&h.isUndefined(e)){return this.node.getAttribute(t)}if(typeof t==="object"){for(var a in t){if(t.hasOwnProperty(a)){this.setAttribute(a,t[a])}}}else{this.setAttribute(t,e)}return this};d.normalizePath=function(){var t=this.tagName();if(t==="PATH"){this.attr("d",h.normalizePathData(this.attr("d")))}return this};d.remove=function(){if(this.node.parentNode){this.node.parentNode.removeChild(this.node)}return this};d.empty=function(){while(this.node.firstChild){this.node.removeChild(this.node.firstChild)}return this};d.setAttributes=function(t){for(var e in t){if(t.hasOwnProperty(e)){this.setAttribute(e,t[e])}}return this};d.append=function(t){if(!h.isArray(t)){t=[t]}for(var e=0,i=t.length;e<i;e++){this.node.appendChild(h.toNode(t[e]))}return this};d.prepend=function(t){var e=this.node.firstChild;return e?h(e).before(t):this.append(t)};d.before=function(t){var e=this.node;var i=e.parentNode;if(i){if(!h.isArray(t)){t=[t]}for(var r=0,n=t.length;r<n;r++){i.insertBefore(h.toNode(t[r]),e)}}return this};d.appendTo=function(t){h.toNode(t).appendChild(this.node);return this},d.svg=function(){return this.node instanceof window.SVGSVGElement?this:h(this.node.ownerSVGElement)};d.tagName=function(){return this.node.tagName.toUpperCase()};d.defs=function(){var t=this.svg()||this;var e=t.node.getElementsByTagName("defs")[0];if(e)return h(e);return h("defs").appendTo(t)};d.clone=function(){var t=h(this.node.cloneNode(true));t.node.id=h.uniqueId();return t};d.findOne=function(t){var e=this.node.querySelector(t);return e?h(e):undefined};d.find=function(t){var e=[];var i=this.node.querySelectorAll(t);if(i){for(var r=0;r<i.length;r++){e.push(h(i[r]))}}return e};d.children=function(){var t=this.node.childNodes;var e=[];for(var i=0;i<t.length;i++){var r=t[i];if(r.nodeType===1){e.push(h(t[i]))}}return e};d.index=function(){var t=0;var e=this.node.previousSibling;while(e){if(e.nodeType===1)t++;e=e.previousSibling}return t};d.findParentByClass=function(t,e){var i=this.node.ownerSVGElement;var r=this.node.parentNode;while(r&&r!==e&&r!==i){var n=h(r);if(n.hasClass(t)){return n}r=r.parentNode}return null};d.contains=function(t){var e=this.node;var i=h.toNode(t);var r=i&&i.parentNode;return e===r||!!(r&&r.nodeType===1&&e.compareDocumentPosition(r)&16)};d.toLocalPoint=function(t,e){var i=this.svg().node;var r=i.createSVGPoint();r.x=t;r.y=e;try{var n=r.matrixTransform(i.getScreenCTM().inverse());var a=this.getTransformToElement(i).inverse()}catch(t){return r}return n.matrixTransform(a)};d.translateCenterToPoint=function(t){var e=this.getBBox({target:this.svg()});var i=e.center();this.translate(t.x-i.x,t.y-i.y);return this};d.translateAndAutoOrient=function(t,e,i){var r=this.scale();this.attr("transform","");this.scale(r.sx,r.sy);var a=this.svg().node;var o=this.getBBox({target:i||a});var s=a.createSVGTransform();s.setTranslate(-o.x-o.width/2,-o.y-o.height/2);var l=a.createSVGTransform();var c=new n.Point(t).changeInAngle(t.x-e.x,t.y-e.y,e);l.setRotate(c,0,0);var u=a.createSVGTransform();var g=new n.Point(t).move(e,o.width/2);u.setTranslate(t.x+(t.x-g.x),t.y+(t.y-g.y));var d=this.getTransformToElement(i||a);var f=a.createSVGTransform();f.setMatrix(u.matrix.multiply(l.matrix.multiply(s.matrix.multiply(d))));var v=h.decomposeMatrix(f.matrix);this.translate(v.translateX,v.translateY);this.rotate(v.rotation);return this};d.animateAlongPath=function(t,e){e=h.toNode(e);var i=h.ensureId(e);var r=h("animateMotion",t);var n=h("mpath",{"xlink:href":"#"+i});r.append(n);this.append(r);try{r.node.beginElement()}catch(t){if(document.documentElement.getAttribute("smiling")==="fake"){var a=r.node;a.animators=[];var o=a.getAttribute("id");if(o)id2anim[o]=a;var s=getTargets(a);for(var l=0,c=s.length;l<c;l++){var u=s[l];var g=new Animator(a,u,l);animators.push(g);a.animators[l]=g;g.register()}}}return this};d.hasClass=function(t){return new RegExp("(\\s|^)"+t+"(\\s|$)").test(this.node.getAttribute("class"))};d.addClass=function(t){if(!this.hasClass(t)){var e=this.node.getAttribute("class")||"";this.node.setAttribute("class",(e+" "+t).trim())}return this};d.removeClass=function(t){if(this.hasClass(t)){var e=this.node.getAttribute("class").replace(new RegExp("(\\s|^)"+t+"(\\s|$)","g"),"$2");this.node.setAttribute("class",e)}return this};d.toggleClass=function(t,e){var i=h.isUndefined(e)?this.hasClass(t):!e;if(i){this.removeClass(t)}else{this.addClass(t)}return this};d.sample=function(t){t=t||1;var e=this.node;var i=e.getTotalLength();var r=[];var n=0;var a;while(n<i){a=e.getPointAtLength(n);r.push({x:a.x,y:a.y,distance:n});n+=t}return r};d.convertToPath=function(){var t=h("path");t.attr(this.attr());var e=this.convertToPathData();if(e){t.attr("d",e)}return t};d.convertToPathData=function(){var t=this.tagName();switch(t){case"PATH":return this.attr("d");case"LINE":return h.convertLineToPathData(this.node);case"POLYGON":return h.convertPolygonToPathData(this.node);case"POLYLINE":return h.convertPolylineToPathData(this.node);case"ELLIPSE":return h.convertEllipseToPathData(this.node);case"CIRCLE":return h.convertCircleToPathData(this.node);case"RECT":return h.convertRectToPathData(this.node)}throw new Error(t+" cannot be converted to PATH.")};h.prototype.toGeometryShape=function(){var t,e,i,r,a,o,s,l,c,u,g;switch(this.tagName()){case"RECT":t=parseFloat(this.attr("x"))||0;e=parseFloat(this.attr("y"))||0;i=parseFloat(this.attr("width"))||0;r=parseFloat(this.attr("height"))||0;return new n.Rect(t,e,i,r);case"CIRCLE":a=parseFloat(this.attr("cx"))||0;o=parseFloat(this.attr("cy"))||0;s=parseFloat(this.attr("r"))||0;return new n.Ellipse({x:a,y:o},s,s);case"ELLIPSE":a=parseFloat(this.attr("cx"))||0;o=parseFloat(this.attr("cy"))||0;l=parseFloat(this.attr("rx"))||0;c=parseFloat(this.attr("ry"))||0;return new n.Ellipse({x:a,y:o},l,c);case"POLYLINE":u=h.getPointsFromSvgNode(this);return new n.Polyline(u);case"POLYGON":u=h.getPointsFromSvgNode(this);if(u.length>1)u.push(u[0]);return new n.Polyline(u);case"PATH":g=this.attr("d");if(!n.Path.isDataSupported(g))g=h.normalizePathData(g);return new n.Path(g);case"LINE":x1=parseFloat(this.attr("x1"))||0;y1=parseFloat(this.attr("y1"))||0;x2=parseFloat(this.attr("x2"))||0;y2=parseFloat(this.attr("y2"))||0;return new n.Line({x:x1,y:y1},{x:x2,y:y2})}return this.getBBox()},d.findIntersection=function(t,e){var i=this.svg().node;e=e||i;var r=this.getBBox({target:e});var a=r.center();if(!r.intersectionWithLineFromCenterToPoint(t))return undefined;var o;var s=this.tagName();if(s==="RECT"){var l=new n.Rect(parseFloat(this.attr("x")||0),parseFloat(this.attr("y")||0),parseFloat(this.attr("width")),parseFloat(this.attr("height")));var c=this.getTransformToElement(e);var u=h.decomposeMatrix(c);var g=i.createSVGTransform();g.setRotate(-u.rotation,a.x,a.y);var d=h.transformRect(l,g.matrix.multiply(c));o=new n.Rect(d).intersectionWithLineFromCenterToPoint(t,u.rotation)}else if(s==="PATH"||s==="POLYGON"||s==="POLYLINE"||s==="CIRCLE"||s==="ELLIPSE"){var f=s==="PATH"?this:this.convertToPath();var v=f.sample();var p=Infinity;var I=[];var m,A,C,w,b,y;for(m=0;m<v.length;m++){A=v[m];C=h.createSVGPoint(A.x,A.y);C=C.matrixTransform(this.getTransformToElement(e));A=new n.Point(C);w=A.distance(a);b=A.distance(t)*1.1;y=w+b;if(y<p){p=y;I=[{sample:A,refDistance:b}]}else if(y<p+1){I.push({sample:A,refDistance:b})}}I.sort(function(t,e){return t.refDistance-e.refDistance});if(I[0]){o=I[0].sample}}return o};d.setAttribute=function(t,e){var i=this.node;if(e===null){this.removeAttr(t);return this}var r=h.qualifyAttr(t);if(r.ns){i.setAttributeNS(r.ns,t,e)}else if(t==="id"){i.id=e}else{i.setAttribute(t,e)}return this};h.createSvgDocument=function(t){var r='<svg xmlns="'+e.xmlns+'" xmlns:xlink="'+e.xlink+'" version="'+i+'">'+(t||"")+"</svg>";var n=h.parseXML(r,{async:false});return n.documentElement};h.idCounter=0;h.uniqueId=function(){return"v-"+ ++h.idCounter};h.toNode=function(t){return h.isV(t)?t.node:t.nodeName&&t||t[0]};h.ensureId=function(t){t=h.toNode(t);return t.id||(t.id=h.uniqueId())};h.sanitizeText=function(t){return(t||"").replace(/ /g,"")};h.isUndefined=function(t){return typeof t==="undefined"};h.isString=function(t){return typeof t==="string"};h.isObject=function(t){return t&&typeof t==="object"};h.isArray=Array.isArray;h.parseXML=function(t,e){e=e||{};var i;try{var r=new DOMParser;if(!h.isUndefined(e.async)){r.async=e.async}i=r.parseFromString(t,"text/xml")}catch(t){i=undefined}if(!i||i.getElementsByTagName("parsererror").length){throw new Error("Invalid XML: "+t)}return i};h.qualifyAttr=function(t){if(t.indexOf(":")!==-1){var i=t.split(":");return{ns:e[i[0]],local:i[1]}}return{ns:null,local:t}};h.transformRegex=/(\w+)\(([^,)]+),?([^)]+)?\)/gi;h.transformSeparatorRegex=/[ ,]+/;h.transformationListRegex=/^(\w+)\((.*)\)/;h.transformStringToMatrix=function(t){var e=h.createSVGMatrix();var i=t&&t.match(h.transformRegex);if(!i){return e}for(var r=0,n=i.length;r<n;r++){var a=i[r];var o=a.match(h.transformationListRegex);if(o){var s,l,c,u,g;var d=h.createSVGMatrix();var f=o[2].split(h.transformSeparatorRegex);switch(o[1].toLowerCase()){case"scale":s=parseFloat(f[0]);l=f[1]===undefined?s:parseFloat(f[1]);d=d.scaleNonUniform(s,l);break;case"translate":c=parseFloat(f[0]);u=parseFloat(f[1]);d=d.translate(c,u);break;case"rotate":g=parseFloat(f[0]);c=parseFloat(f[1])||0;u=parseFloat(f[2])||0;if(c!==0||u!==0){d=d.translate(c,u).rotate(g).translate(-c,-u)}else{d=d.rotate(g)}break;case"skewx":g=parseFloat(f[0]);d=d.skewX(g);break;case"skewy":g=parseFloat(f[0]);d=d.skewY(g);break;case"matrix":d.a=parseFloat(f[0]);d.b=parseFloat(f[1]);d.c=parseFloat(f[2]);d.d=parseFloat(f[3]);d.e=parseFloat(f[4]);d.f=parseFloat(f[5]);break;default:continue}e=e.multiply(d)}}return e};h.matrixToTransformString=function(t){t||(t=true);return"matrix("+(t.a!==undefined?t.a:1)+","+(t.b!==undefined?t.b:0)+","+(t.c!==undefined?t.c:0)+","+(t.d!==undefined?t.d:1)+","+(t.e!==undefined?t.e:0)+","+(t.f!==undefined?t.f:0)+")"};h.parseTransformString=function(t){var e,i,r;if(t){var n=h.transformSeparatorRegex;if(t.trim().indexOf("matrix")>=0){var a=h.transformStringToMatrix(t);var o=h.decomposeMatrix(a);e=[o.translateX,o.translateY];r=[o.scaleX,o.scaleY];i=[o.rotation];var s=[];if(e[0]!==0||e[0]!==0){s.push("translate("+e+")")}if(r[0]!==1||r[1]!==1){s.push("scale("+r+")")}if(i[0]!==0){s.push("rotate("+i+")")}t=s.join(" ")}else{var l=t.match(/translate\((.*?)\)/);if(l){e=l[1].split(n)}var c=t.match(/rotate\((.*?)\)/);if(c){i=c[1].split(n)}var u=t.match(/scale\((.*?)\)/);if(u){r=u[1].split(n)}}}var g=r&&r[0]?parseFloat(r[0]):1;return{value:t,translate:{tx:e&&e[0]?parseInt(e[0],10):0,ty:e&&e[1]?parseInt(e[1],10):0},rotate:{angle:i&&i[0]?parseInt(i[0],10):0,cx:i&&i[1]?parseInt(i[1],10):undefined,cy:i&&i[2]?parseInt(i[2],10):undefined},scale:{sx:g,sy:r&&r[1]?parseFloat(r[1]):g}}};h.deltaTransformPoint=function(t,e){var i=e.x*t.a+e.y*t.c+0;var r=e.x*t.b+e.y*t.d+0;return{x:i,y:r}};h.decomposeMatrix=function(t){var e=h.deltaTransformPoint(t,{x:0,y:1});var i=h.deltaTransformPoint(t,{x:1,y:0});var r=180/a*o(e.y,e.x)-90;var n=180/a*o(i.y,i.x);return{translateX:t.e,translateY:t.f,scaleX:s(t.a*t.a+t.b*t.b),scaleY:s(t.c*t.c+t.d*t.d),skewX:r,skewY:n,rotation:r}};h.matrixToScale=function(t){var e,i,r,n;if(t){e=h.isUndefined(t.a)?1:t.a;n=h.isUndefined(t.d)?1:t.d;i=t.b;r=t.c}else{e=n=1}return{sx:i?s(e*e+i*i):e,sy:r?s(r*r+n*n):n}},h.matrixToRotate=function(t){var e={x:0,y:1};if(t){e=h.deltaTransformPoint(t,e)}return{angle:n.normalizeAngle(n.toDeg(o(e.y,e.x))-90)}},h.matrixToTranslate=function(t){return{tx:t&&t.e||0,ty:t&&t.f||0}},h.isV=function(t){return t instanceof h};h.isVElement=h.isV;var A=h("svg").node;h.createSVGMatrix=function(t){var e=A.createSVGMatrix();for(var i in t){e[i]=t[i]}return e};h.createSVGTransform=function(t){if(!h.isUndefined(t)){if(!(t instanceof SVGMatrix)){t=h.createSVGMatrix(t)}return A.createSVGTransformFromMatrix(t)}return A.createSVGTransform()};h.createSVGPoint=function(t,e){var i=A.createSVGPoint();i.x=t;i.y=e;return i};h.transformRect=function(t,e){var i=A.createSVGPoint();i.x=t.x;i.y=t.y;var r=i.matrixTransform(e);i.x=t.x+t.width;i.y=t.y;var a=i.matrixTransform(e);i.x=t.x+t.width;i.y=t.y+t.height;var o=i.matrixTransform(e);i.x=t.x;i.y=t.y+t.height;var s=i.matrixTransform(e);var u=l(r.x,a.x,o.x,s.x);var g=c(r.x,a.x,o.x,s.x);var h=l(r.y,a.y,o.y,s.y);var d=c(r.y,a.y,o.y,s.y);return new n.Rect(u,h,g-u,d-h)};h.transformPoint=function(t,e){return new n.Point(h.createSVGPoint(t.x,t.y).matrixTransform(e))};h.transformLine=function(t,e){return new n.Line(h.transformPoint(t.start,e),h.transformPoint(t.end,e))};h.transformPolyline=function(t,e){var i=t instanceof n.Polyline?t.points:t;if(!h.isArray(i))i=[];var r=[];for(var a=0,o=i.length;a<o;a++)r[a]=h.transformPoint(i[a],e);return new n.Polyline(r)},h.styleToObject=function(t){var e={};var i=t.split(";");for(var r=0;r<i.length;r++){var n=i[r];var a=n.split("=");e[a[0].trim()]=a[1].trim()}return e};h.createSlicePathData=function(t,e,i,r){var n=2*a-1e-6;var o=t;var s=e;var l=i;var c=r;var h=(c<l&&(h=l,l=c,c=h),c-l);var d=h<a?"0":"1";var f=u(l);var v=g(l);var p=u(c);var I=g(c);return h>=n?o?"M0,"+s+"A"+s+","+s+" 0 1,1 0,"+-s+"A"+s+","+s+" 0 1,1 0,"+s+"M0,"+o+"A"+o+","+o+" 0 1,0 0,"+-o+"A"+o+","+o+" 0 1,0 0,"+o+"Z":"M0,"+s+"A"+s+","+s+" 0 1,1 0,"+-s+"A"+s+","+s+" 0 1,1 0,"+s+"Z":o?"M"+s*f+","+s*v+"A"+s+","+s+" 0 "+d+",1 "+s*p+","+s*I+"L"+o*p+","+o*I+"A"+o+","+o+" 0 "+d+",0 "+o*f+","+o*v+"Z":"M"+s*f+","+s*v+"A"+s+","+s+" 0 "+d+",1 "+s*p+","+s*I+"L0,0"+"Z"};h.mergeAttrs=function(t,e){for(var i in e){if(i==="class"){t[i]=t[i]?t[i]+" "+e[i]:e[i]}else if(i==="style"){if(h.isObject(t[i])&&h.isObject(e[i])){t[i]=h.mergeAttrs(t[i],e[i])}else if(h.isObject(t[i])){t[i]=h.mergeAttrs(t[i],h.styleToObject(e[i]))}else if(h.isObject(e[i])){t[i]=h.mergeAttrs(h.styleToObject(t[i]),e[i])}else{t[i]=h.mergeAttrs(h.styleToObject(t[i]),h.styleToObject(e[i]))}}else{t[i]=e[i]}}return t};h.annotateString=function(t,e,i){e=e||[];i=i||{};var r=i.offset||0;var n=[];var a;var o=[];var s;var l;for(var c=0;c<t.length;c++){s=o[c]=t[c];for(var u=0;u<e.length;u++){var g=e[u];var d=g.start+r;var f=g.end+r;if(c>=d&&c<f){if(h.isObject(s)){s.attrs=h.mergeAttrs(h.mergeAttrs({},s.attrs),g.attrs)}else{s=o[c]={t:t[c],attrs:g.attrs}}if(i.includeAnnotationIndices){(s.annotations||(s.annotations=[])).push(u)}}}l=o[c-1];if(!l){a=s}else if(h.isObject(s)&&h.isObject(l)){if(JSON.stringify(s.attrs)===JSON.stringify(l.attrs)){a.t+=s.t}else{n.push(a);a=s}}else if(h.isObject(s)){n.push(a);a=s}else if(h.isObject(l)){n.push(a);a=s}else{a=(a||"")+s}}if(a){n.push(a)}return n};h.findAnnotationsAtIndex=function(t,e){var i=[];if(t){t.forEach(function(t){if(t.start<e&&e<=t.end){i.push(t)}})}return i};h.findAnnotationsBetweenIndexes=function(t,e,i){var r=[];if(t){t.forEach(function(t){if(e>=t.start&&e<t.end||i>t.start&&i<=t.end||t.start>=e&&t.end<i){r.push(t)}})}return r};h.shiftAnnotations=function(t,e,i){if(t){t.forEach(function(t){if(t.start<e&&t.end>=e){t.end+=i}else if(t.start>=e){t.start+=i;t.end+=i}})}return t};h.convertLineToPathData=function(t){t=h(t);var e=["M",t.attr("x1"),t.attr("y1"),"L",t.attr("x2"),t.attr("y2")].join(" ");return e};h.convertPolygonToPathData=function(t){var e=h.getPointsFromSvgNode(t);if(e.length===0)return null;return h.svgPointsToPath(e)+" Z"};h.convertPolylineToPathData=function(t){var e=h.getPointsFromSvgNode(t);if(e.length===0)return null;return h.svgPointsToPath(e)};h.svgPointsToPath=function(t){for(var e=0,i=t.length;e<i;e++){t[e]=t[e].x+" "+t[e].y}return"M "+t.join(" L")};h.getPointsFromSvgNode=function(t){t=h.toNode(t);var e=[];var i=t.points;if(i){for(var r=0,n=i.numberOfItems;r<n;r++){e.push(i.getItem(r))}}return e};h.KAPPA=.551784;h.convertCircleToPathData=function(t){t=h(t);var e=parseFloat(t.attr("cx"))||0;var i=parseFloat(t.attr("cy"))||0;var r=parseFloat(t.attr("r"));var n=r*h.KAPPA;var a=["M",e,i-r,"C",e+n,i-r,e+r,i-n,e+r,i,"C",e+r,i+n,e+n,i+r,e,i+r,"C",e-n,i+r,e-r,i+n,e-r,i,"C",e-r,i-n,e-n,i-r,e,i-r,"Z"].join(" ");return a};h.convertEllipseToPathData=function(t){t=h(t);var e=parseFloat(t.attr("cx"))||0;var i=parseFloat(t.attr("cy"))||0;var r=parseFloat(t.attr("rx"));var n=parseFloat(t.attr("ry"))||r;var a=r*h.KAPPA;var o=n*h.KAPPA;var s=["M",e,i-n,"C",e+a,i-n,e+r,i-o,e+r,i,"C",e+r,i+o,e+a,i+n,e,i+n,"C",e-a,i+n,e-r,i+o,e-r,i,"C",e-r,i-o,e-a,i-n,e,i-n,"Z"].join(" ");return s};h.convertRectToPathData=function(t){t=h(t);return h.rectToPath({x:parseFloat(t.attr("x"))||0,y:parseFloat(t.attr("y"))||0,width:parseFloat(t.attr("width"))||0,height:parseFloat(t.attr("height"))||0,rx:parseFloat(t.attr("rx"))||0,ry:parseFloat(t.attr("ry"))||0})};h.rectToPath=function(t){var e;var i=t.x;var r=t.y;var n=t.width;var a=t.height;var o=l(t.rx||t["top-rx"]||0,n/2);var s=l(t.rx||t["bottom-rx"]||0,n/2);var c=l(t.ry||t["top-ry"]||0,a/2);var u=l(t.ry||t["bottom-ry"]||0,a/2);if(o||s||c||u){e=["M",i,r+c,"v",a-c-u,"a",s,u,0,0,0,s,u,"h",n-2*s,"a",s,u,0,0,0,s,-u,"v",-(a-u-c),"a",o,c,0,0,0,-o,-c,"h",-(n-2*o),"a",o,c,0,0,0,-o,c,"Z"]}else{e=["M",i,r,"H",i+n,"V",r+a,"H",i,"V",r,"Z"]}return e.join(" ")};h.normalizePathData=function(){var t="\t\n\v\f\r \u2028\u2029";var e=new RegExp("([a-z])["+t+",]*((-?\\d*\\.?\\d*(?:e[\\-+]?\\d+)?["+t+"]*,?["+t+"]*)+)","ig");var i=new RegExp("(-?\\d*\\.?\\d*(?:e[\\-+]?\\d+)?)["+t+"]*,?["+t+"]*","ig");var r=Math;var n=r.PI;var a=r.sin;var o=r.cos;var s=r.tan;var l=r.asin;var c=r.sqrt;var u=r.abs;function g(t,e,i,r,n,a){var o=1/3;var s=2/3;return[o*t+s*i,o*e+s*r,o*n+s*i,o*a+s*r,n,a]}function h(t,e,i,r,g,d,f,v,p,I){var m=n*120/180;var A=n/180*(+g||0);var C=[];var w;var b=function(t,e,i){var r=t*o(i)-e*a(i);var n=t*a(i)+e*o(i);return{x:r,y:n}};if(!I){w=b(t,e,-A);t=w.x;e=w.y;w=b(v,p,-A);v=w.x;p=w.y;var y=(t-v)/2;var N=(e-p)/2;var M=y*y/(i*i)+N*N/(r*r);if(M>1){M=c(M);i=M*i;r=M*r}var x=i*i;var k=r*r;var z=(d==f?-1:1)*c(u((x*k-x*N*N-k*y*y)/(x*N*N+k*y*y)));var D=z*i*N/r+(t+v)/2;var S=z*-r*y/i+(e+p)/2;var j=l(((e-S)/r).toFixed(9));var Z=l(((p-S)/r).toFixed(9));j=t<D?n-j:j;Z=v<D?n-Z:Z;if(j<0)j=n*2+j;if(Z<0)Z=n*2+Z;if((f&&j)>Z)j=j-n*2;if((!f&&Z)>j)Z=Z-n*2}else{j=I[0];Z=I[1];D=I[2];S=I[3]}var G=Z-j;if(u(G)>m){var P=Z;var L=v;var T=p;Z=j+m*((f&&Z)>j?1:-1);v=D+i*o(Z);p=S+r*a(Z);C=h(v,p,i,r,g,0,f,L,T,[Z,P,D,S])}G=Z-j;var B=o(j);var O=a(j);var Y=o(Z);var W=a(Z);var E=s(G/4);var R=4/3*(i*E);var X=4/3*(r*E);var V=[t,e];var U=[t+R*O,e-X*B];var F=[v+R*W,p-X*Y];var J=[v,p];U[0]=2*V[0]-U[0];U[1]=2*V[1]-U[1];if(I){return[U,F,J].concat(C)}else{C=[U,F,J].concat(C).join().split(",");var H=[];var Q=C.length;for(var _=0;_<Q;_++){H[_]=_%2?b(C[_-1],C[_],A).y:b(C[_],C[_+1],A).x}return H}}function d(t){if(!t)return null;var r={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0};var n=[];String(t).replace(e,function(t,e,a){var o=[];var s=e.toLowerCase();a.replace(i,function(t,e){if(e)o.push(+e)});if(s==="m"&&o.length>2){n.push([e].concat(o.splice(0,2)));s="l";e=e==="m"?"l":"L"}while(o.length>=r[s]){n.push([e].concat(o.splice(0,r[s])));if(!r[s])break}});return n}function f(t){if(!Array.isArray(t)||!Array.isArray(t&&t[0])){t=d(t)}if(!t||!t.length)return[["M",0,0]];var e=[];var i=0;var r=0;var n=0;var a=0;var o=0;var s;var l=t.length;for(var c=o;c<l;c++){var u=[];e.push(u);var g=t[c];s=g[0];if(s!=s.toUpperCase()){u[0]=s.toUpperCase();var h;var f;switch(u[0]){case"A":u[1]=g[1];u[2]=g[2];u[3]=g[3];u[4]=g[4];u[5]=g[5];u[6]=+g[6]+i;u[7]=+g[7]+r;break;case"V":u[1]=+g[1]+r;break;case"H":u[1]=+g[1]+i;break;case"M":n=+g[1]+i;a=+g[2]+r;h=g.length;for(f=1;f<h;f++){u[f]=+g[f]+(f%2?i:r)}break;default:h=g.length;for(f=1;f<h;f++){u[f]=+g[f]+(f%2?i:r)}break}}else{var v=g.length;for(var p=0;p<v;p++){u[p]=g[p]}}switch(u[0]){case"Z":i=+n;r=+a;break;case"H":i=u[1];break;case"V":r=u[1];break;case"M":n=u[u.length-2];a=u[u.length-1];i=u[u.length-2];r=u[u.length-1];break;default:i=u[u.length-2];r=u[u.length-1];break}}return e}function v(t){var e=f(t);var i={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null};function r(t,e,i){var r,n;if(!t)return["C",e.x,e.y,e.x,e.y,e.x,e.y];if(!(t[0]in{T:1,Q:1})){e.qx=null;e.qy=null}switch(t[0]){case"M":e.X=t[1];e.Y=t[2];break;case"A":t=["C"].concat(h.apply(0,[e.x,e.y].concat(t.slice(1))));break;case"S":if(i==="C"||i==="S"){r=e.x*2-e.bx;n=e.y*2-e.by}else{r=e.x;n=e.y}t=["C",r,n].concat(t.slice(1));break;case"T":if(i==="Q"||i==="T"){e.qx=e.x*2-e.qx;e.qy=e.y*2-e.qy}else{e.qx=e.x;e.qy=e.y}t=["C"].concat(g(e.x,e.y,e.qx,e.qy,t[1],t[2]));break;case"Q":e.qx=t[1];e.qy=t[2];t=["C"].concat(g(e.x,e.y,t[1],t[2],t[3],t[4]));break;case"H":t=["L"].concat(t[1],e.y);break;case"V":t=["L"].concat(e.x,t[1]);break;case"L":break;case"Z":break}return t}function n(t,i){if(t[i].length>7){t[i].shift();var r=t[i];while(r.length){a[i]="A";t.splice(i++,0,["C"].concat(r.splice(0,6)))}t.splice(i,1);l=e.length}}var a=[];var o="";var s="";var l=e.length;for(var c=0;c<l;c++){if(e[c])o=e[c][0];if(o!=="C"){a[c]=o;if(c>0)s=a[c-1]}e[c]=r(e[c],i,s);if(a[c]!=="A"&&o==="C")a[c]="C";n(e,c);var u=e[c];var d=u.length;i.x=u[d-2];i.y=u[d-1];i.bx=parseFloat(u[d-4])||i.x;i.by=parseFloat(u[d-3])||i.y}if(!e[0][0]||e[0][0]!=="M"){e.unshift(["M",0,0])}return e}return function(t){return v(t).join(",").split(",").join(" ")}}();h.namespace=e;return h}();var s={version:"2.1.0",config:{classNamePrefix:"joint-",defaultTheme:"default"},dia:{},ui:{},layout:{},shapes:{},format:{},connectors:{},highlighters:{},routers:{},anchors:{},connectionPoints:{},connectionStrategies:{},linkTools:{},mvc:{views:{}},setTheme:function(t,e){e=e||{};s.util.invoke(s.mvc.views,"setTheme",t,e);s.mvc.View.prototype.defaultTheme=t},env:{_results:{},_tests:{svgforeignobject:function(){return!!document.createElementNS&&/SVGForeignObject/.test({}.toString.call(document.createElementNS("http://www.w3.org/2000/svg","foreignObject")))}},addTest:function(t,e){return s.env._tests[t]=e},test:function(t){var e=s.env._tests[t];if(!e){throw new Error('Test not defined ("'+t+'"). Use `joint.env.addTest(name, fn) to add a new test.`')}var i=s.env._results[t];if(typeof i!=="undefined"){return i}try{i=e()}catch(t){i=false}s.env._results[t]=i;return i}},util:{hashCode:function(t){var e=0;if(t.length==0)return e;for(var i=0;i<t.length;i++){var r=t.charCodeAt(i);e=(e<<5)-e+r;e=e&e}return e},getByPath:function(t,e,i){var r=Array.isArray(e)?e.slice():e.split(i||"/");var n;while(r.length){n=r.shift();if(Object(t)===t&&n in t){t=t[n]}else{return undefined}}return t},setByPath:function(t,e,i,r){var n=Array.isArray(e)?e:e.split(r||"/");var a=t;var o=0;for(var s=n.length;o<s-1;o++){a=a[n[o]]||(a[n[o]]={})}a[n[s-1]]=i;return t},unsetByPath:function(t,e,i){i=i||"/";var r=Array.isArray(e)?e.slice():e.split(i);var n=r.pop();if(r.length>0){var a=s.util.getByPath(t,r,i);if(a){delete a[n]}}else{delete t[n]}return t},flattenObject:function(t,e,i){e=e||"/";var r={};for(var n in t){if(!t.hasOwnProperty(n))continue;var a=typeof t[n]==="object";if(a&&i&&i(t[n])){a=false}if(a){var o=this.flattenObject(t[n],e,i);for(var s in o){if(!o.hasOwnProperty(s))continue;r[n+e+s]=o[s]}}else{r[n]=t[n]}}return r},uuid:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=Math.random()*16|0;var i=t=="x"?e:e&3|8;return i.toString(16)})},guid:function(t){this.guid.id=this.guid.id||1;t.id=t.id===undefined?"j_"+this.guid.id++:t.id;return t.id},toKebabCase:function(t){return t.replace(/[A-Z]/g,"-$&").toLowerCase()},mixin:i.assign,supplement:i.defaults,deepMixin:i.mixin,deepSupplement:i.defaultsDeep,normalizeEvent:function(t){var e=t.originalEvent&&t.originalEvent.changedTouches&&t.originalEvent.changedTouches[0];if(e){for(var i in t){if(e[i]===undefined){e[i]=t[i]}}return e}return t},nextFrame:function(){var t;if(typeof window!=="undefined"){t=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame}if(!t){var e=0;t=function(t){var i=(new Date).getTime();var r=Math.max(0,16-(i-e));var n=setTimeout(function(){t(i+r)},r);e=i+r;return n}}return function(e,i){return i?t(e.bind(i)):t(e)}}(),cancelFrame:function(){var t;var e=typeof window!="undefined";if(e){t=window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.webkitCancelRequestAnimationFrame||window.msCancelAnimationFrame||window.msCancelRequestAnimationFrame||window.oCancelAnimationFrame||window.oCancelRequestAnimationFrame||window.mozCancelAnimationFrame||window.mozCancelRequestAnimationFrame}t=t||clearTimeout;return e?t.bind(window):t}(),shapePerimeterConnectionPoint:function(t,e,i,r){var n;var o;if(!i){var s=e.$(".scalable")[0];var l=e.$(".rotatable")[0];if(s&&s.firstChild){i=s.firstChild}else if(l&&l.firstChild){i=l.firstChild}}if(i){o=a(i).findIntersection(r,t.paper.viewport);if(!o){n=a(i).getBBox({target:t.paper.viewport})}}else{n=e.model.getBBox();o=n.intersectionWithLineFromCenterToPoint(r)}return o||n.center()},isPercentage:function(t){return s.util.isString(t)&&t.slice(-1)==="%"},parseCssNumeric:function(t,e){e=e||[];var i={value:parseFloat(t)};if(Number.isNaN(i.value)){return null}var r=e.join("|");if(s.util.isString(t)){var n=new RegExp("(\\d+)("+r+")$").exec(t);if(!n){return null}if(n[2]){i.unit=n[2]}}return i},breakText:function(t,e,i,r){r=r||{};i=i||{};var n=e.width;var o=e.height;var l=r.svgDocument||a("svg").node;var c=a("tspan").node;var u=a("text").attr(i).append(c).node;var g=document.createTextNode("");u.style.opacity=0;u.style.display="block";c.style.display="block";c.appendChild(g);l.appendChild(u);if(!r.svgDocument){document.body.appendChild(l)}var h=r.separator||" ";var d=r.eol||"\n";var f=t.split(h);var v=[];var p=[];var I;var m;for(var A=0,C=0,w=f.length;A<w;A++){var b=f[A];if(!b)continue;if(d&&b.indexOf(d)>=0){if(b.length>1){var y=b.split(d);for(var N=0,M=y.length-1;N<M;N++){y.splice(2*N+1,0,d)}Array.prototype.splice.apply(f,[A,1].concat(y));A--;w+=y.length-1}else{C++}continue}g.data=p[C]?p[C]+" "+b:b;if(c.getComputedTextLength()<=n){p[C]=g.data;if(I){v[C++]=true;I=0}}else{if(!p[C]||I){var x=!!I;I=b.length-1;if(x||!I){if(!I){if(!p[C]){p=[];break}f.splice(A,2,b+f[A+1]);w--;v[C++]=true;A--;continue}f[A]=b.substring(0,I);f[A+1]=b.substring(I)+f[A+1]}else{f.splice(A,1,b.substring(0,I),b.substring(I));w++;if(C&&!v[C-1]){C--}}A--;continue}C++;A--}if(o!==undefined){if(m===undefined){var k;if(i.lineHeight==="auto"){k={value:1.5,unit:"em"}}else{k=s.util.parseCssNumeric(i.lineHeight,["em"])||{value:1,unit:"em"}}m=k.value;if(k.unit==="em"){m*=u.getBBox().height}}if(m*p.length>o){p.splice(Math.floor(o/m));break}}}if(r.svgDocument){l.removeChild(u)}else{document.body.removeChild(l)}return p.join(d)},sanitizeHTML:function(t){var e=r(r.parseHTML("<div>"+t+"</div>",null,false));e.find("*").each(function(){var t=this;r.each(t.attributes,function(){var e=this;var i=e.name;var n=e.value;if(i.indexOf("on")===0||n.indexOf("javascript:")===0){r(t).removeAttr(i)}})});return e.html()},downloadBlob:function(t,e){if(window.navigator.msSaveBlob){window.navigator.msSaveBlob(t,e)}else{var i=window.URL.createObjectURL(t);var r=document.createElement("a");r.href=i;r.download=e;document.body.appendChild(r);r.click();document.body.removeChild(r);window.URL.revokeObjectURL(i)}},downloadDataUri:function(t,e){var i=s.util.dataUriToBlob(t);s.util.downloadBlob(i,e)},dataUriToBlob:function(t){t=t.replace(/\s/g,"");t=decodeURIComponent(t);var e=t.indexOf(",");var i=t.slice(0,e);var r=i.split(":")[1].split(";")[0];var n=t.slice(e+1);var a;if(i.indexOf("base64")>=0){a=atob(n)}else{a=unescape(encodeURIComponent(n))}var o=new window.Uint8Array(a.length);for(var s=0;s<a.length;s++){o[s]=a.charCodeAt(s)}return new Blob([o],{type:r})},imageToDataUri:function(t,e){if(!t||t.substr(0,"data:".length)==="data:"){return setTimeout(function(){e(null,t)},0)}var i=function(e,i){if(e.status===200){var r=new FileReader;r.onload=function(t){var e=t.target.result;i(null,e)};r.onerror=function(){i(new Error("Failed to load image "+t))};r.readAsDataURL(e.response)}else{i(new Error("Failed to load image "+t))}};var r=function(e,i){var r=function(t){var e=32768;var i=[];for(var r=0;r<t.length;r+=e){i.push(String.fromCharCode.apply(null,t.subarray(r,r+e)))}return i.join("")};if(e.status===200){var n=new Uint8Array(e.response);var a=t.split(".").pop()||"png";var o={svg:"svg+xml"};var s="data:image/"+(o[a]||a)+";base64,";var l=s+btoa(r(n));i(null,l)}else{i(new Error("Failed to load image "+t))}};var n=new XMLHttpRequest;n.open("GET",t,true);n.addEventListener("error",function(){e(new Error("Failed to load image "+t))});n.responseType=window.FileReader?"blob":"arraybuffer";n.addEventListener("load",function(){if(window.FileReader){i(n,e)}else{r(n,e)}});n.send()},getElementBBox:function(t){var e=r(t);if(e.length===0){throw new Error("Element not found")}var i=e[0];var n=i.ownerDocument;var o=i.getBoundingClientRect();var s=0;var l=0;if(i.ownerSVGElement){var c=a(i);var u=c.getBBox({target:c.svg()});s=o.width-u.width;l=o.height-u.height}return{x:o.left+window.pageXOffset-n.documentElement.offsetLeft+s/2,y:o.top+window.pageYOffset-n.documentElement.offsetTop+l/2,width:o.width-s,height:o.height-l}},sortElements:function(t,e){var i=r(t);var n=i.map(function(){var t=this;var e=t.parentNode;var i=e.insertBefore(document.createTextNode(""),t.nextSibling);return function(){if(e===this){throw new Error("You can't sort elements if any one is a descendant of another.")}e.insertBefore(this,i);e.removeChild(i)}});return Array.prototype.sort.call(i,e).each(function(t){n[t].call(this)})},setAttributesBySelector:function(t,e){var i=r(t);s.util.forIn(e,function(t,e){var r=i.find(e).addBack().filter(e);if(s.util.has(t,"class")){r.addClass(t["class"]);t=s.util.omit(t,"class")}r.attr(t)})},normalizeSides:function(t){if(Object(t)!==t){var e=0;if(isFinite(t))e=+t;return{top:e,right:e,bottom:e,left:e}}var i,r,n,a;i=r=n=a=0;if(isFinite(t.vertical))i=n=+t.vertical;if(isFinite(t.horizontal))r=a=+t.horizontal;if(isFinite(t.top))i=+t.top;if(isFinite(t.right))r=+t.right;if(isFinite(t.bottom))n=+t.bottom;if(isFinite(t.left))a=+t.left;return{top:i,right:r,bottom:n,left:a}},timing:{linear:function(t){return t},quad:function(t){return t*t},cubic:function(t){return t*t*t},inout:function(t){if(t<=0)return 0;if(t>=1)return 1;var e=t*t;var i=e*t;return 4*(t<.5?i:3*(t-e)+i-.75)},exponential:function(t){return Math.pow(2,10*(t-1))},bounce:function(t){for(var e=0,i=1;1;e+=i,i/=2){if(t>=(7-4*e)/11){var r=(11-6*e-11*t)/4;return-r*r+i*i}}},reverse:function(t){return function(e){return 1-t(1-e)}},reflect:function(t){return function(e){return.5*(e<.5?t(2*e):2-t(2-2*e))}},clamp:function(t,e,i){e=e||0;i=i||1;return function(r){var n=t(r);return n<e?e:n>i?i:n}},back:function(t){if(!t)t=1.70158;return function(e){return e*e*((t+1)*e-t)}},elastic:function(t){if(!t)t=1.5;return function(e){return Math.pow(2,10*(e-1))*Math.cos(20*Math.PI*t/3*e)}}},interpolate:{number:function(t,e){var i=e-t;return function(e){return t+i*e}},object:function(t,e){var i=Object.keys(t);return function(r){var n,a;var o={};for(n=i.length-1;n!=-1;n--){a=i[n];o[a]=t[a]+(e[a]-t[a])*r}return o}},hexColor:function(t,e){var i=parseInt(t.slice(1),16);var r=parseInt(e.slice(1),16);var n=i&255;var a=(r&255)-n;var o=i&65280;var s=(r&65280)-o;var l=i&16711680;var c=(r&16711680)-l;return function(t){var e=n+a*t&255;var i=o+s*t&65280;var r=l+c*t&16711680;return"#"+(1<<24|e|i|r).toString(16).slice(1)}},unit:function(t,e){var i=/(-?[0-9]*.[0-9]*)(px|em|cm|mm|in|pt|pc|%)/;var r=i.exec(t);var n=i.exec(e);var a=n[1].indexOf(".");var o=a>0?n[1].length-a-1:0;t=+r[1];var s=+n[1]-t;var l=r[2];return function(e){return(t+s*e).toFixed(o)+l}}},filter:{outline:function(t){var e='<filter><feFlood flood-color="${color}" flood-opacity="${opacity}" result="colored"/><feMorphology in="SourceAlpha" result="morphedOuter" operator="dilate" radius="${outerRadius}" /><feMorphology in="SourceAlpha" result="morphedInner" operator="dilate" radius="${innerRadius}" /><feComposite result="morphedOuterColored" in="colored" in2="morphedOuter" operator="in"/><feComposite operator="xor" in="morphedOuterColored" in2="morphedInner" result="outline"/><feMerge><feMergeNode in="outline"/><feMergeNode in="SourceGraphic"/></feMerge></filter>';var i=Number.isFinite(t.margin)?t.margin:2;var r=Number.isFinite(t.width)?t.width:1;return s.util.template(e)({color:t.color||"blue",opacity:Number.isFinite(t.opacity)?t.opacity:1,outerRadius:i+r,innerRadius:i})},highlight:function(t){var e='<filter><feFlood flood-color="${color}" flood-opacity="${opacity}" result="colored"/><feMorphology result="morphed" in="SourceGraphic" operator="dilate" radius="${width}"/><feComposite result="composed" in="colored" in2="morphed" operator="in"/><feGaussianBlur result="blured" in="composed" stdDeviation="${blur}"/><feBlend in="SourceGraphic" in2="blured" mode="normal"/></filter>';return s.util.template(e)({color:t.color||"red",width:Number.isFinite(t.width)?t.width:1,blur:Number.isFinite(t.blur)?t.blur:0,opacity:Number.isFinite(t.opacity)?t.opacity:1})},blur:function(t){var e=Number.isFinite(t.x)?t.x:2;return s.util.template('<filter><feGaussianBlur stdDeviation="${stdDeviation}"/></filter>')({stdDeviation:Number.isFinite(t.y)?[e,t.y]:e})},dropShadow:function(t){var e="SVGFEDropShadowElement"in window?'<filter><feDropShadow stdDeviation="${blur}" dx="${dx}" dy="${dy}" flood-color="${color}" flood-opacity="${opacity}"/></filter>':'<filter><feGaussianBlur in="SourceAlpha" stdDeviation="${blur}"/><feOffset dx="${dx}" dy="${dy}" result="offsetblur"/><feFlood flood-color="${color}"/><feComposite in2="offsetblur" operator="in"/><feComponentTransfer><feFuncA type="linear" slope="${opacity}"/></feComponentTransfer><feMerge><feMergeNode/><feMergeNode in="SourceGraphic"/></feMerge></filter>';return s.util.template(e)({dx:t.dx||0,dy:t.dy||0,opacity:Number.isFinite(t.opacity)?t.opacity:1,color:t.color||"black",blur:Number.isFinite(t.blur)?t.blur:4})},grayscale:function(t){var e=Number.isFinite(t.amount)?t.amount:1;return s.util.template('<filter><feColorMatrix type="matrix" values="${a} ${b} ${c} 0 0 ${d} ${e} ${f} 0 0 ${g} ${b} ${h} 0 0 0 0 0 1 0"/></filter>')({a:.2126+.7874*(1-e),b:.7152-.7152*(1-e),c:.0722-.0722*(1-e),d:.2126-.2126*(1-e),e:.7152+.2848*(1-e),f:.0722-.0722*(1-e),g:.2126-.2126*(1-e),h:.0722+.9278*(1-e)})},sepia:function(t){var e=Number.isFinite(t.amount)?t.amount:1;return s.util.template('<filter><feColorMatrix type="matrix" values="${a} ${b} ${c} 0 0 ${d} ${e} ${f} 0 0 ${g} ${h} ${i} 0 0 0 0 0 1 0"/></filter>')({a:.393+.607*(1-e),b:.769-.769*(1-e),c:.189-.189*(1-e),d:.349-.349*(1-e),e:.686+.314*(1-e),f:.168-.168*(1-e),g:.272-.272*(1-e),h:.534-.534*(1-e),i:.131+.869*(1-e)})},saturate:function(t){var e=Number.isFinite(t.amount)?t.amount:1;return s.util.template('<filter><feColorMatrix type="saturate" values="${amount}"/></filter>')({amount:1-e})},hueRotate:function(t){return s.util.template('<filter><feColorMatrix type="hueRotate" values="${angle}"/></filter>')({angle:t.angle||0})},invert:function(t){var e=Number.isFinite(t.amount)?t.amount:1;return s.util.template('<filter><feComponentTransfer><feFuncR type="table" tableValues="${amount} ${amount2}"/><feFuncG type="table" tableValues="${amount} ${amount2}"/><feFuncB type="table" tableValues="${amount} ${amount2}"/></feComponentTransfer></filter>')({amount:e,amount2:1-e})},brightness:function(t){return s.util.template('<filter><feComponentTransfer><feFuncR type="linear" slope="${amount}"/><feFuncG type="linear" slope="${amount}"/><feFuncB type="linear" slope="${amount}"/></feComponentTransfer></filter>')({amount:Number.isFinite(t.amount)?t.amount:1})},contrast:function(t){var e=Number.isFinite(t.amount)?t.amount:1;return s.util.template('<filter><feComponentTransfer><feFuncR type="linear" slope="${amount}" intercept="${amount2}"/><feFuncG type="linear" slope="${amount}" intercept="${amount2}"/><feFuncB type="linear" slope="${amount}" intercept="${amount2}"/></feComponentTransfer></filter>')({amount:e,amount2:.5-e/2})}},format:{number:function(t,e,i){i=i||{currency:["$",""],decimal:".",thousands:",",grouping:[3]};var r=/(?:([^{])?([<>=^]))?([+\- ])?([$#])?(0)?(\d+)?(,)?(\.-?\d+)?([a-z%])?/i;var n=r.exec(t);var a=n[1]||" ";var o=n[2]||">";var s=n[3]||"";var l=n[4]||"";var c=n[5];var u=+n[6];var g=n[7];var h=n[8];var d=n[9];var f=1;var v="";var p="";var I=false;if(h)h=+h.substring(1);if(c||a==="0"&&o==="="){c=a="0";o="=";if(g)u-=Math.floor((u-1)/4)}switch(d){case"n":g=true;d="g";break;case"%":f=100;p="%";d="f";break;case"p":f=100;p="%";d="r";break;case"b":case"o":case"x":case"X":if(l==="#")v="0"+d.toLowerCase();break;case"c":case"d":I=true;h=0;break;case"s":f=-1;d="r";break}if(l==="$"){v=i.currency[0];p=i.currency[1]}if(d=="r"&&!h)d="g";if(h!=null){if(d=="g")h=Math.max(1,Math.min(21,h));else if(d=="e"||d=="f")h=Math.max(0,Math.min(20,h))}var m=c&&g;if(I&&e%1)return"";var A=e<0||e===0&&1/e<0?(e=-e,"-"):s;var C=p;if(f<0){var w=this.prefix(e,h);e=w.scale(e);C=w.symbol+p}else{e*=f}e=this.convert(d,e,h);var b=e.lastIndexOf(".");var y=b<0?e:e.substring(0,b);var N=b<0?"":i.decimal+e.substring(b+1);function M(t){var e=t.length;var r=[];var n=0;var a=i.grouping[0];while(e>0&&a>0){r.push(t.substring(e-=a,e+a));a=i.grouping[n=(n+1)%i.grouping.length]}return r.reverse().join(i.thousands)}if(!c&&g&&i.grouping){y=M(y)}var x=v.length+y.length+N.length+(m?0:A.length);var k=x<u?new Array(x=u-x+1).join(a):"";if(m)y=M(k+y);A+=v;e=y+N;return(o==="<"?A+e+k:o===">"?k+A+e:o==="^"?k.substring(0,x>>=1)+A+e+k.substring(x):A+(m?e:k+e))+C},string:function(t,e){var i;var r="{";var n=false;var a=[];while((i=t.indexOf(r))!==-1){var o,s,l;o=t.slice(0,i);if(n){s=o.split(":");l=s.shift().split(".");o=e;for(var c=0;c<l.length;c++)o=o[l[c]];if(s.length)o=this.number(s,o)}a.push(o);t=t.slice(i+1);r=(n=!n)?"}":"{"}a.push(t);return a.join("")},convert:function(t,e,i){switch(t){case"b":return e.toString(2);case"c":return String.fromCharCode(e);case"o":return e.toString(8);case"x":return e.toString(16);case"X":return e.toString(16).toUpperCase();case"g":return e.toPrecision(i);case"e":return e.toExponential(i);case"f":return e.toFixed(i);case"r":return(e=this.round(e,this.precision(e,i))).toFixed(Math.max(0,Math.min(20,this.precision(e*(1+1e-15),i))));default:return e+""}},round:function(t,e){return e?Math.round(t*(e=Math.pow(10,e)))/e:Math.round(t)},precision:function(t,e){return e-(t?Math.ceil(Math.log(t)/Math.LN10):1)},prefix:function(t,e){var i=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"].map(function(t,e){var i=Math.pow(10,Math.abs(8-e)*3);return{scale:e>8?function(t){return t/i}:function(t){return t*i},symbol:t}});var r=0;if(t){if(t<0)t*=-1;if(e)t=this.round(t,this.precision(t,e));r=1+Math.floor(1e-12+Math.log(t)/Math.LN10);r=Math.max(-24,Math.min(24,Math.floor((r<=0?r+1:r-1)/3)*3))}return i[8+r/3]}},template:function(t){var e=/<%= ([^ ]+) %>|\$\{ ?([^\{\} ]+) ?\}|\{\{([^\{\} ]+)\}\}/g;return function(i){i=i||{};return t.replace(e,function(t){var e=Array.from(arguments);var r=e.slice(1,4).find(function(t){return!!t});var n=r.split(".");var a=i[n.shift()];while(a!==undefined&&n.length){a=a[n.shift()]}return a!==undefined?a:""})}},toggleFullScreen:function(t){var e=window.top.document;t=t||e.body;function i(t,e){var i=["webkit","moz","ms","o",""];for(var r=0;r<i.length;r++){var n=i[r];var a=n?n+e:e.substr(0,1).toLowerCase()+e.substr(1);if(t[a]!==undefined){return s.util.isFunction(t[a])?t[a]():t[a]}}}if(i(e,"FullscreenElement")||i(e,"FullScreenElement")){i(e,"ExitFullscreen")||i(e,"CancelFullScreen")}else{i(t,"RequestFullscreen")||i(t,"RequestFullScreen")}},addClassNamePrefix:function(t){if(!t)return t;return t.toString().split(" ").map(function(t){if(t.substr(0,s.config.classNamePrefix.length)!==s.config.classNamePrefix){t=s.config.classNamePrefix+t}return t}).join(" ")},removeClassNamePrefix:function(t){if(!t)return t;return t.toString().split(" ").map(function(t){if(t.substr(0,s.config.classNamePrefix.length)===s.config.classNamePrefix){t=t.substr(s.config.classNamePrefix.length)}return t}).join(" ")},wrapWith:function(t,e,i){if(s.util.isString(i)){if(!s.util.wrappers[i]){throw new Error('Unknown wrapper: "'+i+'"')}i=s.util.wrappers[i]}if(!s.util.isFunction(i)){throw new Error("Wrapper must be a function.")}this.toArray(e).forEach(function(e){t[e]=i(t[e])})},wrappers:{cells:function(t){return function(){var e=Array.from(arguments);var i=e.length;var r=i>0&&e[0]||[];var n=i>1&&e[i-1]||{};if(!Array.isArray(r)){if(n instanceof s.dia.Cell){r=e}else if(r instanceof s.dia.Cell){if(e.length>1){e.pop()}r=e}}if(n instanceof s.dia.Cell){n={}}return t.call(this,r,n)}}},parseDOMJSON:function(t,e){var i={};var n=a.namespace.xmlns;var o=e||n;var s=document.createDocumentFragment();var l=[t,s,o];while(l.length>0){o=l.pop();var c=l.pop();var u=l.pop();for(var g=0,h=u.length;g<h;g++){var d=u[g];if(!d.hasOwnProperty("tagName"))throw new Error("json-dom-parser: missing tagName");var f=d.tagName;if(d.hasOwnProperty("namespaceURI"))o=d.namespaceURI;var v=document.createElementNS(o,f);var p=o===n;var I=p?a:r;var m=d.attributes;if(m)I(v).attr(m);var A=d.style;if(A)r(v).css(A);if(d.hasOwnProperty("className")){var C=d.className;if(p){v.className.baseVal=C}else{v.className=C}}if(d.hasOwnProperty("selector")){var w=d.selector;if(i[w])throw new Error("json-dom-parser: selector must be unique");i[w]=v;I(v).attr("joint-selector",w)}c.appendChild(v);var b=d.children;if(Array.isArray(b))l.push(b,v,o)}}return{fragment:s,selectors:i}},sortedIndex:i.sortedIndexBy||i.sortedIndex,uniq:i.uniqBy||i.uniq,uniqueId:i.uniqueId,sortBy:i.sortBy,isFunction:i.isFunction,result:i.result,union:i.union,invoke:i.invokeMap||i.invoke,difference:i.difference,intersection:i.intersection,omit:i.omit,pick:i.pick,has:i.has,bindAll:i.bindAll,assign:i.assign,defaults:i.defaults,defaultsDeep:i.defaultsDeep,isPlainObject:i.isPlainObject,isEmpty:i.isEmpty,isEqual:i.isEqual,noop:function(){},cloneDeep:i.cloneDeep,toArray:i.toArray,flattenDeep:i.flattenDeep,camelCase:i.camelCase,groupBy:i.groupBy,forIn:i.forIn,without:i.without,debounce:i.debounce,clone:i.clone,isBoolean:function(t){var e=Object.prototype.toString;return t===true||t===false||!!t&&typeof t==="object"&&e.call(t)==="[object Boolean]"},isObject:function(t){return!!t&&(typeof t==="object"||typeof t==="function")},isNumber:function(t){var e=Object.prototype.toString;return typeof t==="number"||!!t&&typeof t==="object"&&e.call(t)==="[object Number]"},isString:function(t){var e=Object.prototype.toString;return typeof t==="string"||!!t&&typeof t==="object"&&e.call(t)==="[object String]"},merge:function(){if(i.mergeWith){var t=Array.from(arguments);var e=t[t.length-1];var r=this.isFunction(e)?e:this.noop;t.push(function(t,e){var i=r(t,e);if(i!==undefined){return i}if(Array.isArray(t)&&!Array.isArray(e)){return e}});return i.mergeWith.apply(this,t)}return i.merge.apply(this,arguments)}}};s.mvc.View=e.View.extend({options:{},theme:null,themeClassNamePrefix:s.util.addClassNamePrefix("theme-"),requireSetThemeOverride:false,defaultTheme:s.config.defaultTheme,children:null,childNodes:null,constructor:function(t){this.requireSetThemeOverride=t&&!!t.theme;this.options=s.util.assign({},this.options,t);e.View.call(this,t)},initialize:function(t){s.util.bindAll(this,"setTheme","onSetTheme","remove","onRemove");s.mvc.views[this.cid]=this;this.setTheme(this.options.theme||this.defaultTheme);this.init()},renderChildren:function(t){t||(t=this.children);if(t){var e=a.namespace[this.svgElement?"xmlns":"xhtml"];var i=s.util.parseDOMJSON(t,e);this.vel.empty().append(i.fragment);this.childNodes=i.selectors}return this},_ensureElement:function(){if(!this.el){var t=s.util.result(this,"tagName");var e=s.util.assign({},s.util.result(this,"attributes"));if(this.id)e.id=s.util.result(this,"id");this.setElement(this._createElement(t));this._setAttributes(e)}else{this.setElement(s.util.result(this,"el"))}this._ensureElClassName()},_setAttributes:function(t){if(this.svgElement){this.vel.attr(t)}else{this.$el.attr(t)}},_createElement:function(t){if(this.svgElement){return document.createElementNS(a.namespace.xmlns,t)}else{return document.createElement(t)}},_setElement:function(t){this.$el=t instanceof e.$?t:e.$(t);this.el=this.$el[0];if(this.svgElement)this.vel=a(this.el)},_ensureElClassName:function(){var t=s.util.result(this,"className");var e=s.util.addClassNamePrefix(t);if(this.svgElement){this.vel.removeClass(t).addClass(e)}else{this.$el.removeClass(t).addClass(e)}},init:function(){},onRender:function(){},setTheme:function(t,e){e=e||{};if(this.theme&&this.requireSetThemeOverride&&!e.override){return this}this.removeThemeClassName();this.addThemeClassName(t);this.onSetTheme(this.theme,t);this.theme=t;return this},addThemeClassName:function(t){t=t||this.theme;var e=this.themeClassNamePrefix+t;if(this.svgElement){this.vel.addClass(e)}else{this.$el.addClass(e)}return this},removeThemeClassName:function(t){t=t||this.theme;var e=this.themeClassNamePrefix+t;if(this.svgElement){this.vel.removeClass(e)}else{this.$el.removeClass(e)}return this},onSetTheme:function(t,e){},remove:function(){this.onRemove();this.undelegateDocumentEvents();s.mvc.views[this.cid]=null;e.View.prototype.remove.apply(this,arguments);return this},onRemove:function(){},getEventNamespace:function(){return".joint-event-ns-"+this.cid},delegateElementEvents:function(t,e,i){if(!e)return this;i||(i={});var n=this.getEventNamespace();for(var a in e){var o=e[a];if(typeof o!=="function")o=this[o];if(!o)continue;r(t).on(a+n,i,o.bind(this))}return this},undelegateElementEvents:function(t){r(t).off(this.getEventNamespace());return this},delegateDocumentEvents:function(t,e){t||(t=s.util.result(this,"documentEvents"));return this.delegateElementEvents(document,t,e)},undelegateDocumentEvents:function(){return this.undelegateElementEvents(document)},eventData:function(t,e){if(!t)throw new Error("eventData(): event object required.");var i=t.data;var r="__"+this.cid+"__";if(e===undefined){if(!i)return{};return i[r]||{}}i||(i=t.data={});i[r]||(i[r]={});s.util.assign(i[r],e);return this}},{extend:function(){var t=Array.from(arguments);var i=t[0]&&s.util.assign({},t[0])||{};var r=t[1]&&s.util.assign({},t[1])||{};var n=i.render||this.prototype&&this.prototype.render||null;i.render=function(){if(n){n.apply(this,arguments)}this.onRender();return this};return e.View.extend.call(this,i,r)}});s.dia.GraphCells=e.Collection.extend({cellNamespace:s.shapes,initialize:function(t,e){if(e.cellNamespace){this.cellNamespace=e.cellNamespace}this.graph=e.graph},model:function(t,e){var i=e.collection;var r=i.cellNamespace;var n=t.type==="link"?s.dia.Link:s.util.getByPath(r,t.type,".")||s.dia.Element;var a=new n(t,e);if(!e.dry){a.graph=i.graph}return a},comparator:function(t){return t.get("z")||0}});s.dia.Graph=e.Model.extend({_batches:{},initialize:function(t,i){i=i||{};var r=new s.dia.GraphCells([],{model:i.cellModel,cellNamespace:i.cellNamespace,graph:this});e.Model.prototype.set.call(this,"cells",r);r.on("all",this.trigger,this);this.on("change:z",this._sortOnChangeZ,this);this._out={};this._in={};this._nodes={};this._edges={};r.on("add",this._restructureOnAdd,this);r.on("remove",this._restructureOnRemove,this);r.on("reset",this._restructureOnReset,this);r.on("change:source",this._restructureOnChangeSource,this);r.on("change:target",this._restructureOnChangeTarget,this);r.on("remove",this._removeCell,this)},_sortOnChangeZ:function(){this.get("cells").sort()},_restructureOnAdd:function(t){if(t.isLink()){this._edges[t.id]=true;var e=t.get("source");var i=t.get("target");if(e.id){(this._out[e.id]||(this._out[e.id]={}))[t.id]=true}if(i.id){(this._in[i.id]||(this._in[i.id]={}))[t.id]=true}}else{this._nodes[t.id]=true}},_restructureOnRemove:function(t){if(t.isLink()){delete this._edges[t.id];var e=t.get("source");var i=t.get("target");if(e.id&&this._out[e.id]&&this._out[e.id][t.id]){delete this._out[e.id][t.id]}if(i.id&&this._in[i.id]&&this._in[i.id][t.id]){delete this._in[i.id][t.id]}}else{delete this._nodes[t.id]}},_restructureOnReset:function(t){t=t.models;this._out={};this._in={};this._nodes={};this._edges={};t.forEach(this._restructureOnAdd,this)},_restructureOnChangeSource:function(t){var e=t.previous("source");if(e.id&&this._out[e.id]){delete this._out[e.id][t.id]}var i=t.get("source");if(i.id){(this._out[i.id]||(this._out[i.id]={}))[t.id]=true}},_restructureOnChangeTarget:function(t){var e=t.previous("target");if(e.id&&this._in[e.id]){delete this._in[e.id][t.id]}var i=t.get("target");if(i.id){(this._in[i.id]||(this._in[i.id]={}))[t.id]=true}},getOutboundEdges:function(t){return this._out&&this._out[t]||{}},getInboundEdges:function(t){return this._in&&this._in[t]||{}},toJSON:function(){var t=e.Model.prototype.toJSON.apply(this,arguments);t.cells=this.get("cells").toJSON();return t},fromJSON:function(t,e){if(!t.cells){throw new Error("Graph JSON must contain cells array.")}return this.set(t,e)},set:function(t,i,r){var n;if(typeof t==="object"){n=t;r=i}else{(n={})[t]=i}if(n.hasOwnProperty("cells")){this.resetCells(n.cells,r);n=s.util.omit(n,"cells")}return e.Model.prototype.set.call(this,n,r)},clear:function(t){t=s.util.assign({},t,{clear:true});var e=this.get("cells");if(e.length===0)return this;this.startBatch("clear",t);var i=e.sortBy(function(t){return t.isLink()?1:2});do{i.shift().remove(t)}while(i.length>0);this.stopBatch("clear");return this},_prepareCell:function(t,i){var r;if(t instanceof e.Model){r=t.attributes;if(!t.graph&&(!i||!i.dry)){t.graph=this}}else{r=t}if(!s.util.isString(r.type)){throw new TypeError("dia.Graph: cell type must be a string.")}return t},minZIndex:function(){var t=this.get("cells").first();return t?t.get("z")||0:0},maxZIndex:function(){var t=this.get("cells").last();return t?t.get("z")||0:0},addCell:function(t,i){if(Array.isArray(t)){return this.addCells(t,i)}if(t instanceof e.Model){if(!t.has("z")){t.set("z",this.maxZIndex()+1)}}else if(t.z===undefined){t.z=this.maxZIndex()+1}this.get("cells").add(this._prepareCell(t,i),i||{});return this},addCells:function(t,e){if(t.length){t=s.util.flattenDeep(t);e.position=t.length;this.startBatch("add");t.forEach(function(t){e.position--;this.addCell(t,e)},this);this.stopBatch("add")}return this},resetCells:function(t,e){var i=s.util.toArray(t).map(function(t){return this._prepareCell(t,e)},this);this.get("cells").reset(i,e);return this},removeCells:function(t,e){if(t.length){this.startBatch("remove");s.util.invoke(t,"remove",e);this.stopBatch("remove")}return this},_removeCell:function(t,e,i){i=i||{};if(!i.clear){if(i.disconnectLinks){this.disconnectLinks(t,i)}else{this.removeLinks(t,i)}}this.get("cells").remove(t,{silent:true});if(t.graph===this){t.graph=null}},getCell:function(t){return this.get("cells").get(t)},getCells:function(){return this.get("cells").toArray()},getElements:function(){return Object.keys(this._nodes).map(this.getCell,this)},getLinks:function(){return Object.keys(this._edges).map(this.getCell,this)},getFirstCell:function(){return this.get("cells").first()},getLastCell:function(){return this.get("cells").last()},getConnectedLinks:function(t,e){e=e||{};var i=e.inbound;var r=e.outbound;if(i===undefined&&r===undefined){i=r=true}var n=[];var a={};if(r){s.util.forIn(this.getOutboundEdges(t.id),function(t,e){if(!a[e]){n.push(this.getCell(e));a[e]=true}}.bind(this))}if(i){s.util.forIn(this.getInboundEdges(t.id),function(t,e){if(!a[e]){n.push(this.getCell(e));a[e]=true}}.bind(this))}if(e.deep){var o=t.getEmbeddedCells({deep:true});var l={};o.forEach(function(t){if(t.isLink()){l[t.id]=true}});o.forEach(function(t){if(t.isLink())return;if(r){s.util.forIn(this.getOutboundEdges(t.id),function(t,e){if(!a[e]&&!l[e]){n.push(this.getCell(e));a[e]=true}}.bind(this))}if(i){s.util.forIn(this.getInboundEdges(t.id),function(t,e){if(!a[e]&&!l[e]){n.push(this.getCell(e));a[e]=true}}.bind(this))}},this)}return n},getNeighbors:function(t,e){e=e||{};var i=e.inbound;var r=e.outbound;if(i===undefined&&r===undefined){i=r=true}var n=this.getConnectedLinks(t,e).reduce(function(n,a){var o=a.get("source");var l=a.get("target");var c=a.hasLoop(e);if(i&&s.util.has(o,"id")&&!n[o.id]){var u=this.getCell(o.id);if(c||u&&u!==t&&(!e.deep||!u.isEmbeddedIn(t))){n[o.id]=u}}if(r&&s.util.has(l,"id")&&!n[l.id]){var g=this.getCell(l.id);if(c||g&&g!==t&&(!e.deep||!g.isEmbeddedIn(t))){n[l.id]=g}}return n}.bind(this),{});return s.util.toArray(n)},getCommonAncestor:function(){var t=Array.from(arguments).map(function(t){var e=[];var i=t.get("parent");while(i){e.push(i);i=this.getCell(i).get("parent")}return e},this);t=t.sort(function(t,e){return t.length-e.length});var e=s.util.toArray(t.shift()).find(function(e){return t.every(function(t){return t.includes(e)})});return this.getCell(e)},getSuccessors:function(t,e){e=e||{};var i=[];this.search(t,function(e){if(e!==t){i.push(e)}},s.util.assign({},e,{outbound:true}));return i},cloneCells:function(t){t=s.util.uniq(t);var e=s.util.toArray(t).reduce(function(t,e){t[e.id]=e.clone();return t},{});s.util.toArray(t).forEach(function(t){var i=e[t.id];if(i.isLink()){var r=i.get("source");var n=i.get("target");if(r.id&&e[r.id]){i.prop("source/id",e[r.id].id)}if(n.id&&e[n.id]){i.prop("target/id",e[n.id].id)}}var a=t.get("parent");if(a&&e[a]){i.set("parent",e[a].id)}var o=s.util.toArray(t.get("embeds")).reduce(function(t,i){if(e[i]){t.push(e[i].id)}return t},[]);if(!s.util.isEmpty(o)){i.set("embeds",o)}});return e},cloneSubgraph:function(t,e){var i=this.getSubgraph(t,e);return this.cloneCells(i)},getSubgraph:function(t,e){e=e||{};var i=[];var r={};var n=[];var a=[];s.util.toArray(t).forEach(function(t){if(!r[t.id]){i.push(t);r[t.id]=t;if(t.isLink()){a.push(t)}else{n.push(t)}}if(e.deep){var o=t.getEmbeddedCells({deep:true});o.forEach(function(t){if(!r[t.id]){i.push(t);r[t.id]=t;if(t.isLink()){a.push(t)}else{n.push(t)}}})}});a.forEach(function(t){var e=t.get("source");var a=t.get("target");if(e.id&&!r[e.id]){var o=this.getCell(e.id);i.push(o);r[o.id]=o;n.push(o)}if(a.id&&!r[a.id]){var s=this.getCell(a.id);i.push(this.getCell(a.id));r[s.id]=s;n.push(s)}},this);n.forEach(function(t){var n=this.getConnectedLinks(t,e);n.forEach(function(t){var e=t.get("source");var n=t.get("target");if(!r[t.id]&&e.id&&r[e.id]&&n.id&&r[n.id]){i.push(t);r[t.id]=t}})},this);return i},getPredecessors:function(t,e){e=e||{};var i=[];this.search(t,function(e){if(e!==t){i.push(e)}},s.util.assign({},e,{inbound:true}));return i},search:function(t,e,i){i=i||{};if(i.breadthFirst){this.bfs(t,e,i)}else{this.dfs(t,e,i)}},bfs:function(t,e,i){i=i||{};var r={};var n={};var a=[];a.push(t);n[t.id]=0;while(a.length>0){var o=a.shift();if(!r[o.id]){r[o.id]=true;if(e(o,n[o.id])===false)return;this.getNeighbors(o,i).forEach(function(t){n[t.id]=n[o.id]+1;a.push(t)})}}},dfs:function(t,e,i,r,n){i=i||{};var a=r||{};var o=n||0;if(e(t,o)===false)return;a[t.id]=true;this.getNeighbors(t,i).forEach(function(t){if(!a[t.id]){this.dfs(t,e,i,a,o+1)}},this)},getSources:function(){var t=[];s.util.forIn(this._nodes,function(e,i){if(!this._in[i]||s.util.isEmpty(this._in[i])){t.push(this.getCell(i))}}.bind(this));return t},getSinks:function(){var t=[];s.util.forIn(this._nodes,function(e,i){if(!this._out[i]||s.util.isEmpty(this._out[i])){t.push(this.getCell(i))}}.bind(this));return t},isSource:function(t){return!this._in[t.id]||s.util.isEmpty(this._in[t.id])},isSink:function(t){return!this._out[t.id]||s.util.isEmpty(this._out[t.id])},isSuccessor:function(t,e){var i=false;this.search(t,function(r){if(r===e&&r!==t){i=true;return false}},{outbound:true});return i},isPredecessor:function(t,e){var i=false;this.search(t,function(r){if(r===e&&r!==t){i=true;return false}},{inbound:true});return i},isNeighbor:function(t,e,i){i=i||{};var r=i.inbound;var n=i.outbound;if(r===undefined&&n===undefined){r=n=true}var a=false;this.getConnectedLinks(t,i).forEach(function(t){var i=t.get("source");var o=t.get("target");if(r&&s.util.has(i,"id")&&i.id===e.id){a=true;return false}if(n&&s.util.has(o,"id")&&o.id===e.id){a=true;return false}});return a},disconnectLinks:function(t,e){this.getConnectedLinks(t).forEach(function(i){i.set(i.get("source").id===t.id?"source":"target",{x:0,y:0},e)})},removeLinks:function(t,e){s.util.invoke(this.getConnectedLinks(t),"remove",e)},findModelsFromPoint:function(t){return this.getElements().filter(function(e){return e.getBBox().containsPoint(t)})},findModelsInArea:function(t,e){t=n.rect(t);e=s.util.defaults(e||{},{strict:false});var i=e.strict?"containsRect":"intersect";return this.getElements().filter(function(e){return t[i](e.getBBox())})},findModelsUnderElement:function(t,e){e=s.util.defaults(e||{},{searchBy:"bbox"});var i=t.getBBox();var r=e.searchBy==="bbox"?this.findModelsInArea(i):this.findModelsFromPoint(i[e.searchBy]());return r.filter(function(e){return t.id!==e.id&&!e.isEmbeddedIn(t)})},getBBox:function(t,e){return this.getCellsBBox(t||this.getElements(),e)},getCellsBBox:function(t,e){return s.util.toArray(t).reduce(function(t,i){if(i.isLink())return t;if(t){return t.union(i.getBBox(e))}else{return i.getBBox(e)}},null)},translate:function(t,e,i){var r=this.getCells().filter(function(t){return!t.isEmbedded()});s.util.invoke(r,"translate",t,e,i);return this},resize:function(t,e,i){return this.resizeCells(t,e,this.getCells(),i)},resizeCells:function(t,e,i,r){var n=this.getCellsBBox(i);if(n){var a=Math.max(t/n.width,0);var o=Math.max(e/n.height,0);s.util.invoke(i,"scale",a,o,n.origin(),r)}return this},startBatch:function(t,e){e=e||{};this._batches[t]=(this._batches[t]||0)+1;return this.trigger("batch:start",s.util.assign({},e,{batchName:t}))},stopBatch:function(t,e){e=e||{};this._batches[t]=(this._batches[t]||0)-1;return this.trigger("batch:stop",s.util.assign({},e,{batchName:t}))},hasActiveBatch:function(t){if(arguments.length===0){return s.util.toArray(this._batches).some(function(t){return t>0})}if(Array.isArray(t)){return t.some(function(t){return!!this._batches[t]},this)}return!!this._batches[t]}},{validations:{multiLinks:function(t,e){var i=e.get("source");var r=e.get("target");if(i.id&&r.id){var n=e.getSourceElement();if(n){var a=t.getConnectedLinks(n,{outbound:true});var o=a.filter(function(t){var e=t.get("source");var n=t.get("target");return e&&e.id===i.id&&(!e.port||e.port===i.port)&&n&&n.id===r.id&&(!n.port||n.port===r.port)});if(o.length>1){return false}}}return true},linkPinning:function(t,e){return e.source().id&&e.target().id}}});s.util.wrapWith(s.dia.Graph.prototype,["resetCells","addCells","removeCells"],"cells");(function(t,e,i,r,n){function a(t,e){return function(i,r){var a=n.isPercentage(i);i=parseFloat(i);if(a){i/=100}var o={};if(isFinite(i)){var s=a||i>=0&&i<=1?i*r[e]:Math.max(i+r[e],0);o[t]=s}return o}}function o(t,e,r){return function(a,o){var s=n.isPercentage(a);a=parseFloat(a);if(s){a/=100}var l;if(isFinite(a)){var c=o[r]();if(s||a>0&&a<1){l=c[t]+o[e]*a}else{l=c[t]+a}}var u=i.Point();u[t]=l||0;return u}}function s(t,e,r){return function(a,o){var s;if(a==="middle"){s=o[e]/2}else if(a===r){s=o[e]}else if(isFinite(a)){s=a>-1&&a<1?-o[e]*a:-a}else if(n.isPercentage(a)){s=o[e]*parseFloat(a)/100}else{s=0}var l=i.Point();l[t]=-(o[t]+s);return l}}function l(t,e){var i="joint-shape";var n=e&&e.resetOffset;return function(e,a,o){var s=r(o);var l=s.data(i);if(!l||l.value!==e){var c=t(e);l={value:e,shape:c,shapeBBox:c.bbox()};s.data(i,l)}var u=l.shape.clone();var g=l.shapeBBox.clone();var h=g.origin();var d=a.origin();g.x=d.x;g.y=d.y;var f=a.maxRectScaleToFit(g,d);var v=g.width===0||a.width===0?1:f.sx;var p=g.height===0||a.height===0?1:f.sy;u.scale(v,p,h);if(n){u.translate(-h.x,-h.y)}return u}}function c(t){function r(t){return new i.Path(e.normalizePathData(t))}var n=l(r,t);return function(t,e,i){var r=n(t,e,i);return{d:r.serialize()}}}function u(t){var e=l(i.Polyline,t);return function(t,i,r){var n=e(t,i,r);return{points:n.serialize()}}}function g(t,e){var r=new i.Point(1,0);return function(i){var n,a;var o=this[t](i);if(o){a=e.rotate?o.vector().vectorAngle(r):0;n=o.start}else{n=this.path.start;a=0}if(a===0)return{transform:"translate("+n.x+","+n.y+")"};return{transform:"translate("+n.x+","+n.y+") rotate("+a+")"}}}function h(t,e,i){return i.text!==undefined}function d(){return this instanceof t.dia.LinkView}function f(t){var e={};var i=t.stroke;if(typeof i==="string"){e["stroke"]=i;e["fill"]=i}var r=t.strokeOpacity;if(r===undefined)r=t["stroke-opacity"];if(r===undefined)r=t.opacity;if(r!==undefined){e["stroke-opacity"]=r;e["fill-opacity"]=r}return e}var v=t.dia.attributes={xlinkHref:{set:"xlink:href"},xlinkShow:{set:"xlink:show"},xlinkRole:{set:"xlink:role"},xlinkType:{set:"xlink:type"},xlinkArcrole:{set:"xlink:arcrole"},xlinkTitle:{set:"xlink:title"},xlinkActuate:{set:"xlink:actuate"},xmlSpace:{set:"xml:space"},xmlBase:{set:"xml:base"},xmlLang:{set:"xml:lang"},preserveAspectRatio:{set:"preserveAspectRatio"},requiredExtension:{set:"requiredExtension"},requiredFeatures:{set:"requiredFeatures"},systemLanguage:{set:"systemLanguage"},externalResourcesRequired:{set:"externalResourceRequired"},filter:{qualify:n.isPlainObject,set:function(t){return"url(#"+this.paper.defineFilter(t)+")"}},fill:{qualify:n.isPlainObject,set:function(t){return"url(#"+this.paper.defineGradient(t)+")"}},stroke:{qualify:n.isPlainObject,set:function(t){return"url(#"+this.paper.defineGradient(t)+")"}},sourceMarker:{qualify:n.isPlainObject,set:function(t,e,i,r){t=n.assign(f(r),t);return{"marker-start":"url(#"+this.paper.defineMarker(t)+")"}}},targetMarker:{qualify:n.isPlainObject,set:function(t,e,i,r){t=n.assign(f(r),{transform:"rotate(180)"},t);return{"marker-end":"url(#"+this.paper.defineMarker(t)+")"}}},vertexMarker:{qualify:n.isPlainObject,set:function(t,e,i,r){t=n.assign(f(r),t);return{"marker-mid":"url(#"+this.paper.defineMarker(t)+")"}}},text:{qualify:function(t,e,i){return!i.textWrap||!n.isPlainObject(i.textWrap)},set:function(i,a,o,s){var l=r(o);var c="joint-text";var u=l.data(c);var g=t.util.pick(s,"lineHeight","annotations","textPath","x","textVerticalAnchor","eol");var h=g.fontSize=s["font-size"]||s["fontSize"];var d=JSON.stringify([i,g]);if(u===undefined||u!==d){if(h)o.setAttribute("font-size",h);var f=g.textPath;if(n.isObject(f)){var v=f.selector;if(typeof v==="string"){var p=this.findBySelector(v)[0];if(p instanceof SVGPathElement){g.textPath=n.assign({"xlink:href":"#"+p.id},f)}}}e(o).text(""+i,g);l.data(c,d)}}},textWrap:{qualify:n.isPlainObject,set:function(e,i,r,a){var o=e.width||0;if(n.isPercentage(o)){i.width*=parseFloat(o)/100}else if(o<=0){i.width+=o}else{i.width=o}var s=e.height||0;if(n.isPercentage(s)){i.height*=parseFloat(s)/100}else if(s<=0){i.height+=s}else{i.height=s}var l=e.text;if(l===undefined)l=attr.text;if(l!==undefined){var c=t.util.breakText(""+l,i,{"font-weight":a["font-weight"]||a.fontWeight,"font-size":a["font-size"]||a.fontSize,"font-family":a["font-family"]||a.fontFamily,lineHeight:a.lineHeight},{svgDocument:this.paper.svg})}t.dia.attributes.text.set.call(this,c,i,r,a)}},title:{qualify:function(t,e){return e instanceof SVGElement},set:function(t,e,i){var n=r(i);var a="joint-title";var o=n.data(a);if(o===undefined||o!==t){n.data(a,t);var s=i.firstChild;if(s&&s.tagName.toUpperCase()==="TITLE"){s.textContent=t}else{var l=document.createElementNS(i.namespaceURI,"title");l.textContent=t;i.insertBefore(l,s)}}}},lineHeight:{qualify:h},textVerticalAnchor:{qualify:h},textPath:{qualify:h},annotations:{qualify:h},port:{set:function(t){return t===null||t.id===undefined?t:t.id}},style:{qualify:n.isPlainObject,set:function(t,e,i){r(i).css(t)}},html:{set:function(t,e,i){r(i).html(t+"")}},ref:{},refX:{position:o("x","width","origin")},refY:{position:o("y","height","origin")},refDx:{position:o("x","width","corner")},refDy:{position:o("y","height","corner")},refWidth:{set:a("width","width")},refHeight:{set:a("height","height")},refRx:{set:a("rx","width")},refRy:{set:a("ry","height")},refRInscribed:{set:function(t){var e=a(t,"width");var i=a(t,"height");return function(t,r){var n=r.height>r.width?e:i;return n(t,r)}}("r")},refRCircumscribed:{set:function(t,e){var i=n.isPercentage(t);t=parseFloat(t);if(i){t/=100}var r=Math.sqrt(e.height*e.height+e.width*e.width);var a;if(isFinite(t)){if(i||t>=0&&t<=1)a=t*r;else a=Math.max(t+r,0)}return{r:a}}},refCx:{set:a("cx","width")},refCy:{set:a("cy","height")},xAlignment:{offset:s("x","width","right")},yAlignment:{offset:s("y","height","bottom")},resetOffset:{offset:function(t,e){return t?{x:-e.x,y:-e.y}:{x:0,y:0}}},refDResetOffset:{set:c({resetOffset:true})},refDKeepOffset:{set:c({resetOffset:false})},refPointsResetOffset:{set:u({resetOffset:true})},refPointsKeepOffset:{set:u({resetOffset:false})},connection:{qualify:d,set:function(){return{d:this.getSerializedConnection()}}},atConnectionLengthKeepGradient:{qualify:d,set:g("getTangentAtLength",{rotate:true})},atConnectionLengthIgnoreGradient:{qualify:d,set:g("getTangentAtLength",{rotate:false})},atConnectionRatioKeepGradient:{qualify:d,set:g("getTangentAtRatio",{rotate:true})},atConnectionRatioIgnoreGradient:{qualify:d,set:g("getTangentAtRatio",{rotate:false})}};v.refR=v.refRInscribed;v.refD=v.refDResetOffset;v.refPoints=v.refPointsResetOffset;v.atConnectionLength=v.atConnectionLengthKeepGradient;v.atConnectionRatio=v.atConnectionRatioKeepGradient;v.refX2=v.refX;v.refY2=v.refY;v["ref-x"]=v.refX;v["ref-y"]=v.refY;v["ref-dy"]=v.refDy;v["ref-dx"]=v.refDx;v["ref-width"]=v.refWidth;v["ref-height"]=v.refHeight;v["x-alignment"]=v.xAlignment;v["y-alignment"]=v.yAlignment})(s,a,n,r,s.util);(function(t,e){var i=t.mvc.View.extend({name:null,tagName:"g",className:"tool",svgElement:true,_visible:true,init:function(){var t=this.name;if(t)this.vel.attr("data-tool-name",t)},configure:function(t,e){this.relatedView=t;this.paper=t.paper;this.parentView=e;this.simulateRelatedView(this.el);return this},simulateRelatedView:function(t){if(t)t.setAttribute("model-id",this.relatedView.model.id)},getName:function(){return this.name},show:function(){this.el.style.display="";this._visible=true},hide:function(){this.el.style.display="none";this._visible=false},isVisible:function(){return!!this._visible},focus:function(){var t=this.options.focusOpacity;if(isFinite(t))this.el.style.opacity=t;this.parentView.focusTool(this)},blur:function(){this.el.style.opacity="";this.parentView.blurTool(this)},update:function(){}});var r=t.mvc.View.extend({tagName:"g",className:"tools",svgElement:true,tools:null,options:{tools:null,relatedView:null,name:null,component:false},configure:function(r){r=e.assign(this.options,r);var n=r.tools;if(!Array.isArray(n))return this;var a=r.relatedView;if(!(a instanceof t.dia.CellView))return this;var o=this.tools=[];for(var s=0,l=n.length;s<l;s++){var c=n[s];if(!(c instanceof i))continue;c.configure(a,this);c.render();this.vel.append(c.el);o.push(c)}return this},getName:function(){return this.options.name},update:function(t){t||(t={});var e=this.tools;if(!e)return;for(var i=0,r=e.length;i<r;i++){var n=e[i];if(t.tool!==n.cid&&n.isVisible()){n.update()}}return this},focusTool:function(t){var e=this.tools;if(!e)return this;for(var i=0,r=e.length;i<r;i++){var n=e[i];if(t===n){n.show()}else{n.hide()}}return this},blurTool:function(t){var e=this.tools;if(!e)return this;for(var i=0,r=e.length;i<r;i++){var n=e[i];if(n!==t&&!n.isVisible()){n.show();n.update()}}return this},hide:function(){return this.focusTool(null)},show:function(){return this.blurTool(null)},onRemove:function(){var t=this.tools;if(!t)return this;for(var e=0,i=t.length;e<i;e++){t[e].remove()}this.tools=null},mount:function(){var t=this.options;var e=t.relatedView;if(e){var i=t.component?e.el:e.paper.tools;i.appendChild(this.el)}return this}});t.dia.ToolsView=r;t.dia.ToolView=i})(s,s.util);s.dia.Cell=e.Model.extend({constructor:function(t,e){var i;var r=t||{};this.cid=s.util.uniqueId("c");this.attributes={};if(e&&e.collection)this.collection=e.collection;if(e&&e.parse)r=this.parse(r,e)||{};if(i=s.util.result(this,"defaults")){r=s.util.merge({},i,r)}this.set(r,e);this.changed={};this.initialize.apply(this,arguments)},translate:function(t,e,i){throw new Error("Must define a translate() method.")},toJSON:function(){var t=this.constructor.prototype.defaults.attrs||{};var e=this.attributes.attrs;var i={};s.util.forIn(e,function(e,r){var n=t[r];s.util.forIn(e,function(t,e){if(s.util.isObject(t)&&!Array.isArray(t)){s.util.forIn(t,function(t,a){if(!n||!n[e]||!s.util.isEqual(n[e][a],t)){i[r]=i[r]||{};(i[r][e]||(i[r][e]={}))[a]=t}})}else if(!n||!s.util.isEqual(n[e],t)){i[r]=i[r]||{};i[r][e]=t}})});var r=s.util.cloneDeep(s.util.omit(this.attributes,"attrs"));r.attrs=i;return r},initialize:function(t){if(!t||!t.id){this.set("id",s.util.uuid(),{silent:true})}this._transitionIds={};this.processPorts();this.on("change:attrs",this.processPorts,this)},processPorts:function(){var t=this.ports;var e={};s.util.forIn(this.get("attrs"),function(t,i){if(t&&t.port){if(t.port.id!==undefined){e[t.port.id]=t.port}else{e[t.port]={id:t.port}}}});var i={};s.util.forIn(t,function(t,r){if(!e[r])i[r]=true});if(this.graph&&!s.util.isEmpty(i)){var r=this.graph.getConnectedLinks(this,{inbound:true});r.forEach(function(t){if(i[t.get("target").port])t.remove()});var n=this.graph.getConnectedLinks(this,{outbound:true});n.forEach(function(t){if(i[t.get("source").port])t.remove()})}this.ports=e},remove:function(t){t=t||{};var e=this.graph;if(e){e.startBatch("remove")}var i=this.getParentCell();if(i)i.unembed(this);s.util.invoke(this.getEmbeddedCells(),"remove",t);this.trigger("remove",this,this.collection,t);if(e){e.stopBatch("remove")}return this},toFront:function(t){var e=this.graph;if(e){t=t||{};var i=e.maxZIndex();var r;if(t.deep){r=this.getEmbeddedCells({deep:true,breadthFirst:true});r.unshift(this)}else{r=[this]}i=i-r.length+1;var n=e.get("cells");var a=n.indexOf(this)!==n.length-r.length;if(!a){a=r.some(function(t,e){return t.get("z")!==i+e})}if(a){this.startBatch("to-front");i=i+r.length;r.forEach(function(e,r){e.set("z",i+r,t)});this.stopBatch("to-front")}}return this},toBack:function(t){var e=this.graph;if(e){t=t||{};var i=e.minZIndex();var r;if(t.deep){r=this.getEmbeddedCells({deep:true,breadthFirst:true});r.unshift(this)}else{r=[this]}var n=e.get("cells");var a=n.indexOf(this)!==0;if(!a){a=r.some(function(t,e){return t.get("z")!==i+e})}if(a){this.startBatch("to-back");i-=r.length;r.forEach(function(e,r){e.set("z",i+r,t)});this.stopBatch("to-back")}}return this},parent:function(t,e){if(t===undefined)return this.get("parent");return this.set("parent",t,e)},embed:function(t,e){if(this===t||this.isEmbeddedIn(t)){throw new Error("Recursive embedding not allowed.")}else{this.startBatch("embed");var i=s.util.assign([],this.get("embeds"));i[t.isLink()?"unshift":"push"](t.id);t.parent(this.id,e);this.set("embeds",s.util.uniq(i),e);this.stopBatch("embed")}return this},unembed:function(t,e){this.startBatch("unembed");t.unset("parent",e);this.set("embeds",s.util.without(this.get("embeds"),t.id),e);this.stopBatch("unembed");return this},getParentCell:function(){var t=this.parent();var e=this.graph;return t&&e&&e.getCell(t)||null},getAncestors:function(){var t=[];if(!this.graph){return t}var e=this.getParentCell();while(e){t.push(e);e=e.getParentCell()}return t},getEmbeddedCells:function(t){t=t||{};if(this.graph){var e;if(t.deep){if(t.breadthFirst){e=[];var i=this.getEmbeddedCells();while(i.length>0){var r=i.shift();e.push(r);i.push.apply(i,r.getEmbeddedCells())}}else{e=this.getEmbeddedCells();e.forEach(function(i){e.push.apply(e,i.getEmbeddedCells(t))})}}else{e=s.util.toArray(this.get("embeds")).map(this.graph.getCell,this.graph)}return e}return[]},isEmbeddedIn:function(t,e){var i=s.util.isString(t)?t:t.id;var r=this.parent();e=s.util.defaults({deep:true},e);if(this.graph&&e.deep){while(r){if(r===i){return true}r=this.graph.getCell(r).parent()}return false}else{return r===i}},isEmbedded:function(){return!!this.parent()},clone:function(t){t=t||{};if(!t.deep){var i=e.Model.prototype.clone.apply(this,arguments);i.set("id",s.util.uuid());i.unset("embeds");i.unset("parent");return i}else{return s.util.toArray(s.dia.Graph.prototype.cloneCells.call(null,[this].concat(this.getEmbeddedCells({deep:true}))))}},prop:function(t,e,i){var r="/";var n=s.util.isString(t);if(n||Array.isArray(t)){if(arguments.length>1){var a;var o;if(n){a=t;o=a.split("/")}else{a=t.join(r);o=t.slice()}var l=o[0];var c=o.length;i=i||{};i.propertyPath=a;i.propertyValue=e;i.propertyPathArray=o;if(c===1){return this.set(l,e,i)}var u={};var g=u;var h=l;for(var d=1;d<c;d++){var f=o[d];var v=Number.isFinite(n?Number(f):f);g=g[h]=v?[]:{};h=f}u=s.util.setByPath(u,o,e,"/");var p=s.util.merge({},this.attributes);i.rewrite&&s.util.unsetByPath(p,a,"/");var I=s.util.merge(p,u);return this.set(l,I[l],i)}else{return s.util.getByPath(this.attributes,t,r)}}return this.set(s.util.merge({},this.attributes,t),e)},removeProp:function(t,e){e=e||{};e.dirty=true;var i=Array.isArray(t)?t:t.split("/");if(i.length===1){return this.unset(t,e)}var r=i[0];var n=i.slice(1);var a=s.util.cloneDeep(this.get(r));s.util.unsetByPath(a,n,"/");return this.set(r,a,e)},attr:function(t,e,i){var r=Array.from(arguments);if(r.length===0){return this.get("attrs")}if(Array.isArray(t)){r[0]=["attrs"].concat(t)}else if(s.util.isString(t)){r[0]="attrs/"+t}else{r[0]={attrs:t}}return this.prop.apply(this,r)},removeAttr:function(t,e){if(Array.isArray(t)){return this.removeProp(["attrs"].concat(t))}return this.removeProp("attrs/"+t,e)},transition:function(t,e,i,r){r=r||"/";var n={duration:100,delay:10,timingFunction:s.util.timing.linear,valueFunction:s.util.interpolate.number};i=s.util.assign(n,i);var a=0;var o;var l=function(e){var r,n,c;a=a||e;e-=a;n=e/i.duration;if(n<1){this._transitionIds[t]=r=s.util.nextFrame(l)}else{n=1;delete this._transitionIds[t]}c=o(i.timingFunction(n));i.transitionId=r;this.prop(t,c,i);if(!r)this.trigger("transition:end",this,t)}.bind(this);var c=function(n){this.stopTransitions(t);o=i.valueFunction(s.util.getByPath(this.attributes,t,r),e);this._transitionIds[t]=s.util.nextFrame(n);this.trigger("transition:start",this,t)}.bind(this);return setTimeout(c,i.delay,l)},getTransitions:function(){return Object.keys(this._transitionIds)},stopTransitions:function(t,e){e=e||"/";var i=t&&t.split(e);Object.keys(this._transitionIds).filter(i&&function(t){return s.util.isEqual(i,t.split(e).slice(0,i.length))}).forEach(function(t){s.util.cancelFrame(this._transitionIds[t]);delete this._transitionIds[t];this.trigger("transition:end",this,t)},this);return this},addTo:function(t,e){t.addCell(this,e);return this},findView:function(t){return t.findViewByModel(this)},isElement:function(){return false},isLink:function(){return false},startBatch:function(t,e){if(this.graph){this.graph.startBatch(t,s.util.assign({},e,{cell:this}))}return this},stopBatch:function(t,e){if(this.graph){this.graph.stopBatch(t,s.util.assign({},e,{cell:this}))}return this}},{getAttributeDefinition:function(t){var e=this.attributes;var i=s.dia.attributes;return e&&e[t]||i[t]},define:function(t,e,i,r){i=s.util.assign({defaults:s.util.defaultsDeep({type:t},e,this.prototype.defaults)},i);var n=this.extend(i,r);s.util.setByPath(s.shapes,t,n,".");return n}});s.dia.CellView=s.mvc.View.extend({tagName:"g",svgElement:true,selector:"root",className:function(){var t=["cell"];var e=this.model.get("type");if(e){e.toLowerCase().split(".").forEach(function(e,i,r){t.push("type-"+r.slice(0,i+1).join("-"))})}return t.join(" ")},attributes:function(){return{"model-id":this.model.id}},constructor:function(t){t.id=t.id||s.util.guid(this);s.mvc.View.call(this,t)},init:function(){s.util.bindAll(this,"remove","update");this.$el.data("view",this);this.$el.attr("data-type",this.model.get("type"));this.listenTo(this.model,"change:attrs",this.onChangeAttrs)},onChangeAttrs:function(t,e,i){if(i.dirty){return this.render()}return this.update(t,e,i)},can:function(t){var e=s.util.isFunction(this.options.interactive)?this.options.interactive(this):this.options.interactive;return s.util.isObject(e)&&e[t]!==false||s.util.isBoolean(e)&&e!==false},findBySelector:function(t,e,i){e||(e=this.el);i||(i=this.selectors);if(!t||t===".")return[e];if(i&&i[t])return[i[t]];return r(e).find(t).toArray()},notify:function(t){if(this.paper){var e=Array.prototype.slice.call(arguments,1);this.trigger.apply(this,[t].concat(e));this.paper.trigger.apply(this.paper,[t,this].concat(e))}},getStrokeBBox:function(t){var e=!!t;t=t||this.el;var i=a(t).getBBox({target:this.paper.viewport});var r;if(e){r=a(t).attr("stroke-width")}else{r=this.model.attr("rect/stroke-width")||this.model.attr("circle/stroke-width")||this.model.attr("ellipse/stroke-width")||this.model.attr("path/stroke-width")}r=parseFloat(r)||0;return n.rect(i).moveAndExpand({x:-r/2,y:-r/2,width:r,height:r})},getBBox:function(){return this.vel.getBBox({target:this.paper.svg})},highlight:function(t,e){t=!t?this.el:this.$(t)[0]||this.el;e=e||{};e.partial=t!==this.el;this.notify("cell:highlight",t,e);return this},unhighlight:function(t,e){t=!t?this.el:this.$(t)[0]||this.el;e=e||{};e.partial=t!=this.el;this.notify("cell:unhighlight",t,e);return this},findMagnet:function(t){var e=this.$(t);var i=this.$el;if(e.length===0){e=i}do{var r=e.attr("magnet");if((r||e.is(i))&&r!=="false"){return e[0]}e=e.parent()}while(e.length>0);return undefined},getSelector:function(t,e){if(t===this.el){return e}var i;if(t){var r=a(t).index()+1;i=t.tagName+":nth-child("+r+")";if(e){i+=" > "+e}i=this.getSelector(t.parentNode,i)}return i},getLinkEnd:function(t,e,i,r,a){var o=this.model;var s=o.id;var l=this.findAttribute("port",t);var c=t.getAttribute("joint-selector");var u={id:s};if(c!=null)u.magnet=c;if(l!=null){u.port=l;if(!o.hasPort(l)&&!c){u.selector=this.getSelector(t)}}else if(c==null&&this.el!==t){u.selector=this.getSelector(t)}var g=this.paper;var h=g.options.connectionStrategy;if(typeof h==="function"){var d=h.call(g,u,this,t,new n.Point(e,i),r,a);if(d)u=d}return u},getMagnetFromLinkEnd:function(t){var e=this.el;var i=t.port;var r=t.magnet;var n;if(i!=null&&this.model.hasPort(i)){n=this.findPortNode(i,r)||e}else{n=this.findBySelector(r||t.selector,e,this.selectors)[0]}return n},findAttribute:function(t,e){if(!e)return null;var i=e.getAttribute(t);if(i===null){if(e===this.el)return null;var r=e.parentNode;while(r&&r!==this.el&&r.nodeType===1){i=r.getAttribute(t);if(i!==null)break;r=r.parentNode}}return i},getAttributeDefinition:function(t){return this.model.constructor.getAttributeDefinition(t)},setNodeAttributes:function(t,e){if(!s.util.isEmpty(e)){if(t instanceof SVGElement){a(t).attr(e)}else{r(t).attr(e)}}},processNodeAttributes:function(t,e){var i,r,n,a,o;var l,c,u,g;var h=[];for(i in e){if(!e.hasOwnProperty(i))continue;r=e[i];n=this.getAttributeDefinition(i);if(n&&(!s.util.isFunction(n.qualify)||n.qualify.call(this,r,t,e))){if(s.util.isString(n.set)){l||(l={});l[n.set]=r}if(r!==null){h.push(i,n)}}else{l||(l={});l[s.util.toKebabCase(i)]=r}}for(a=0,o=h.length;a<o;a+=2){i=h[a];n=h[a+1];r=e[i];if(s.util.isFunction(n.set)){c||(c={});c[i]=r}if(s.util.isFunction(n.position)){u||(u={});u[i]=r}if(s.util.isFunction(n.offset)){g||(g={});g[i]=r}}return{raw:e,normal:l,set:c,position:u,offset:g}},updateRelativeAttributes:function(t,e,i,r){r||(r={});var o,l,c;var u=e.raw||{};var g=e.normal||{};var h=e.set;var d=e.position;var f=e.offset;for(o in h){l=h[o];c=this.getAttributeDefinition(o);var v=c.set.call(this,l,i.clone(),t,u);if(s.util.isObject(v)){s.util.assign(g,v)}else if(v!==undefined){g[o]=v}}if(t instanceof HTMLElement){this.setNodeAttributes(t,g);return}var p=g.transform;var I=a.transformStringToMatrix(p);var m=n.Point(I.e,I.f);if(p){g=s.util.omit(g,"transform");I.e=I.f=0}var A,C,w;if(d||f){var b=this.getNodeScale(t,r.scalableNode);A=b.sx;C=b.sy}var y=false;for(o in d){l=d[o];c=this.getAttributeDefinition(o);w=c.position.call(this,l,i.clone(),t,u);if(w){m.offset(n.Point(w).scale(A,C));y||(y=true)}}this.setNodeAttributes(t,g);var N=false;if(f){var M=t.getBoundingClientRect();if(M.width>0&&M.height>0){var x=a.transformRect(t.getBBox(),I).scale(1/A,1/C);for(o in f){l=f[o];c=this.getAttributeDefinition(o);w=c.offset.call(this,l,x,t,u);if(w){m.offset(n.Point(w).scale(A,C));N||(N=true)}}}}if(p!==undefined||y||N){m.round(1);I.e=m.x;I.f=m.y;t.setAttribute("transform",a.matrixToTransformString(I))}},getNodeScale:function(t,e){var i,r;if(e&&e.contains(t)){var n=e.scale();i=1/n.sx;r=1/n.sy}else{i=1;r=1}return{sx:i,sy:r}},findNodesAttributes:function(t,e,i,r){var n={};for(var o in t){if(!t.hasOwnProperty(o))continue;var l=i[o]=this.findBySelector(o,e,r);for(var c=0,u=l.length;c<u;c++){var g=l[c];var h=a.ensureId(g);var d=t[o];var f=n[h];if(f){if(!f.merged){f.merged=true;f.attributes=s.util.cloneDeep(f.attributes)||{}}s.util.merge(f.attributes,d)}else{n[h]={attributes:d,node:g,merged:false}}}}return n},updateDOMSubtreeAttributes:function(t,e,i){i||(i={});i.rootBBox||(i.rootBBox=n.Rect());i.selectors||(i.selectors=this.selectors);var r={};var o={};var s=[];var l,c,u,g,h;var d=i.roAttributes;var f=this.findNodesAttributes(d||e,t,r,i.selectors);var v=d?v=this.findNodesAttributes(e,t,r,i.selectors):f;for(var p in f){g=f[p];u=g.attributes;c=g.node;h=this.processNodeAttributes(c,u);if(!h.set&&!h.position&&!h.offset){this.setNodeAttributes(c,h.normal)}else{var I=v[p]&&v[p].attributes;var m=I&&u.ref===undefined?I.ref:u.ref;var A;if(m){A=(r[m]||this.findBySelector(m,t,i.selectors))[0];if(!A){throw new Error('dia.ElementView: "'+m+'" reference does not exist.')}}else{A=null}l={node:c,refNode:A,processedAttributes:h,allAttributes:I};var C=s.findIndex(function(t){return t.refNode===c});if(C>-1){s.splice(C,0,l)}else{s.push(l)}}}for(var w=0,b=s.length;w<b;w++){l=s[w];c=l.node;A=l.refNode;var y=A?a.ensureId(A):"";var N=o[y];if(!N){N=o[y]=A?a(A).getBBox({target:i.rotatableNode||t}):i.rootBBox}if(d){h=this.processNodeAttributes(c,l.allAttributes);this.mergeProcessedAttributes(h,l.processedAttributes)}else{h=l.processedAttributes}this.updateRelativeAttributes(c,h,N,i)}},mergeProcessedAttributes:function(t,e){t.set||(t.set={});t.position||(t.position={});t.offset||(t.offset={});s.util.assign(t.set,e.set);s.util.assign(t.position,e.position);s.util.assign(t.offset,e.offset);var i=t.normal&&t.normal.transform;if(i!==undefined&&e.normal){e.normal.transform=i}t.normal=e.normal},onRemove:function(){this.removeTools()},_toolsView:null,hasTools:function(t){var e=this._toolsView;if(!e)return false;if(!t)return true;return e.getName()===t},addTools:function(t){this.removeTools();if(t instanceof s.dia.ToolsView){this._toolsView=t;t.configure({relatedView:this});t.listenTo(this.paper,"tools:event",this.onToolEvent.bind(this));t.mount()}return this},updateTools:function(t){var e=this._toolsView;if(e)e.update(t);return this},removeTools:function(){var t=this._toolsView;if(t){t.remove();this._toolsView=null}return this},hideTools:function(){var t=this._toolsView;if(t)t.hide();return this},showTools:function(){var t=this._toolsView;if(t)t.show();return this},onToolEvent:function(t){switch(t){case"remove":this.removeTools();break;case"hide":this.hideTools();break;case"show":this.showTools();break}},pointerdblclick:function(t,e,i){this.notify("cell:pointerdblclick",t,e,i)},pointerclick:function(t,e,i){this.notify("cell:pointerclick",t,e,i)},contextmenu:function(t,e,i){this.notify("cell:contextmenu",t,e,i)},pointerdown:function(t,e,i){if(this.model.graph){this.model.startBatch("pointer");this._graph=this.model.graph}this.notify("cell:pointerdown",t,e,i)},pointermove:function(t,e,i){this.notify("cell:pointermove",t,e,i)},pointerup:function(t,e,i){this.notify("cell:pointerup",t,e,i);if(this._graph){this._graph.stopBatch("pointer",{cell:this.model});delete this._graph}},mouseover:function(t){this.notify("cell:mouseover",t)},mouseout:function(t){this.notify("cell:mouseout",t)},mouseenter:function(t){this.notify("cell:mouseenter",t)},mouseleave:function(t){this.notify("cell:mouseleave",t)},mousewheel:function(t,e,i,r){this.notify("cell:mousewheel",t,e,i,r)},onevent:function(t,e,i,r){this.notify(e,t,i,r)},onmagnet:function(){},setInteractivity:function(t){this.options.interactive=t}},{dispatchToolsEvent:function(t,e){if(typeof e==="string"&&t instanceof s.dia.Paper){t.trigger("tools:event",e)}}});s.dia.Element=s.dia.Cell.extend({defaults:{position:{x:0,y:0},size:{width:1,height:1},angle:0},initialize:function(){this._initializePorts();s.dia.Cell.prototype.initialize.apply(this,arguments)},_initializePorts:function(){},isElement:function(){return true},position:function(t,e,i){var r=s.util.isNumber(e);i=(r?i:t)||{};if(i.parentRelative){if(!this.graph)throw new Error("Element must be part of a graph.");var a=this.getParentCell();var o=a&&!a.isLink()?a.get("position"):{x:0,y:0}}if(r){if(i.parentRelative){t+=o.x;e+=o.y}if(i.deep){var l=this.get("position");this.translate(t-l.x,e-l.y,i)}else{this.set("position",{x:t,y:e},i)}return this}else{var c=n.point(this.get("position"));return i.parentRelative?c.difference(o):c}},translate:function(t,e,i){t=t||0;e=e||0;if(t===0&&e===0){return this}i=i||{};i.translateBy=i.translateBy||this.id;var r=this.get("position")||{x:0,y:0};if(i.restrictedArea&&i.translateBy===this.id){var n=this.getBBox({deep:true});var a=i.restrictedArea;var o=r.x-n.x;var l=r.y-n.y;var c=Math.max(a.x+o,Math.min(a.x+a.width+o-n.width,r.x+t));var u=Math.max(a.y+l,Math.min(a.y+a.height+l-n.height,r.y+e));t=c-r.x;e=u-r.y}var g={x:r.x+t,y:r.y+e};i.tx=t;i.ty=e;if(i.transition){if(!s.util.isObject(i.transition))i.transition={};this.transition("position",g,s.util.assign({},i.transition,{valueFunction:s.util.interpolate.object}))}else{this.set("position",g,i)}s.util.invoke(this.getEmbeddedCells(),"translate",t,e,i);return this},size:function(t,e,i){var r=this.get("size");if(t===undefined){return{width:r.width,height:r.height}}if(s.util.isObject(t)){i=e;e=s.util.isNumber(t.height)?t.height:r.height;t=s.util.isNumber(t.width)?t.width:r.width}return this.resize(t,e,i)},resize:function(t,e,i){i=i||{};this.startBatch("resize",i);if(i.direction){var r=this.get("size");switch(i.direction){case"left":case"right":e=r.height;break;case"top":case"bottom":t=r.width;break}var a=n.normalizeAngle(this.get("angle")||0);var o={"top-right":0,right:0,"top-left":1,top:1,"bottom-left":2,left:2,"bottom-right":3,bottom:3}[i.direction];if(i.absolute){o+=Math.floor((a+45)/90);o%=4}var s=this.getBBox();var l=s[["bottomLeft","corner","topRight","origin"][o]]();var c=n.point(l).rotate(s.center(),-a);var u=Math.sqrt(t*t+e*e)/2;var g=o*Math.PI/2;g+=Math.atan(o%2==0?e/t:t/e);g-=n.toRad(a);var h=n.point.fromPolar(u,g,c);var d=n.point(h).offset(t/-2,e/-2);this.set("size",{width:t,height:e},i);this.position(d.x,d.y,i)}else{this.set("size",{width:t,height:e},i)}this.stopBatch("resize",i);return this},scale:function(t,e,i,r){var n=this.getBBox().scale(t,e,i);this.startBatch("scale",r);this.position(n.x,n.y,r);this.resize(n.width,n.height,r);this.stopBatch("scale");return this},fitEmbeds:function(t){t=t||{};if(!this.graph)throw new Error("Element must be part of a graph.");var e=this.getEmbeddedCells();if(e.length>0){this.startBatch("fit-embeds",t);if(t.deep){s.util.invoke(e,"fitEmbeds",t)}var i=this.graph.getCellsBBox(e);var r=s.util.normalizeSides(t.padding);i.moveAndExpand({x:-r.left,y:-r.top,width:r.right+r.left,height:r.bottom+r.top});this.set({position:{x:i.x,y:i.y},size:{width:i.width,height:i.height}},t);this.stopBatch("fit-embeds")}return this},rotate:function(t,e,i,r){if(i){var n=this.getBBox().center();var a=this.get("size");var o=this.get("position");n.rotate(i,this.get("angle")-t);var s=n.x-a.width/2-o.x;var l=n.y-a.height/2-o.y;this.startBatch("rotate",{angle:t,absolute:e,origin:i});this.position(o.x+s,o.y+l,r);this.rotate(t,e,null,r);this.stopBatch("rotate")}else{this.set("angle",e?t:(this.get("angle")+t)%360,r)}return this},angle:function(){return n.normalizeAngle(this.get("angle")||0)},getBBox:function(t){t=t||{};if(t.deep&&this.graph){var e=this.getEmbeddedCells({deep:true,breadthFirst:true});e.push(this);return this.graph.getCellsBBox(e)}var i=this.get("position");var r=this.get("size");return new n.Rect(i.x,i.y,r.width,r.height)}});s.dia.ElementView=s.dia.CellView.extend({_removePorts:function(){},_renderPorts:function(){},className:function(){var t=s.dia.CellView.prototype.className.apply(this).split(" ");t.push("element");return t.join(" ")},metrics:null,initialize:function(){s.dia.CellView.prototype.initialize.apply(this,arguments);var t=this.model;this.listenTo(t,"change:position",this.translate);this.listenTo(t,"change:size",this.resize);this.listenTo(t,"change:angle",this.rotate);this.listenTo(t,"change:markup",this.render);this._initializePorts();this.metrics={}},_initializePorts:function(){},update:function(t,e){this.metrics={};this._removePorts();var i=this.model;var r=i.attr();this.updateDOMSubtreeAttributes(this.el,r,{rootBBox:new n.Rect(i.size()),selectors:this.selectors,scalableNode:this.scalableNode,rotatableNode:this.rotatableNode,roAttributes:e===r?null:e});this._renderPorts()},rotatableSelector:"rotatable",scalableSelector:"scalable",scalableNode:null,rotatableNode:null,renderMarkup:function(){var t=this.model;var e=t.get("markup")||t.markup;if(!e)throw new Error("dia.ElementView: markup required");if(Array.isArray(e))return this.renderJSONMarkup(e);if(typeof e==="string")return this.renderStringMarkup(e);throw new Error("dia.ElementView: invalid markup")},renderJSONMarkup:function(t){var e=s.util.parseDOMJSON(t);var i=this.selectors=e.selectors;var r=this.selector;if(i[r])throw new Error("dia.ElementView: ambiguous root selector.");i[r]=this.el;this.rotatableNode=a(i[this.rotatableSelector])||null;this.scalableNode=a(i[this.scalableSelector])||null;this.vel.append(e.fragment)},renderStringMarkup:function(t){var e=this.vel;e.append(a(t));this.rotatableNode=e.findOne(".rotatable");this.scalableNode=e.findOne(".scalable");var i=this.selectors={};i[this.selector]=this.el},render:function(){this.vel.empty();this.renderMarkup();if(this.scalableNode){this.update()}this.resize();if(this.rotatableNode){this.rotate();this.translate();return this}this.updateTransformation();return this},resize:function(){if(this.scalableNode)return this.sgResize.apply(this,arguments);if(this.model.attributes.angle)this.rotate();this.update()},translate:function(){if(this.rotatableNode)return this.rgTranslate();this.updateTransformation()},rotate:function(){if(this.rotatableNode)return this.rgRotate();this.updateTransformation()},updateTransformation:function(){var t=this.getTranslateString();var e=this.getRotateString();if(e)t+=" "+e;this.vel.attr("transform",t)},getTranslateString:function(){var t=this.model.attributes.position;return"translate("+t.x+","+t.y+")"},getRotateString:function(){var t=this.model.attributes;var e=t.angle;if(!e)return null;var i=t.size;return"rotate("+e+","+i.width/2+","+i.height/2+")"},getBBox:function(t){var e;if(t&&t.useModelGeometry){var i=this.model;e=i.getBBox().bbox(i.angle())}else{e=this.getNodeBBox(this.el)}return this.paper.localToPaperRect(e)},nodeCache:function(t){var e=a.ensureId(t);var i=this.metrics[e];if(!i)i=this.metrics[e]={};return i},getNodeData:function(t){var e=this.nodeCache(t);if(!e.data)e.data={};return e.data},getNodeBBox:function(t){var e=this.getNodeBoundingRect(t);var i=this.getNodeMatrix(t);var r=this.getRootTranslateMatrix();var n=this.getRootRotateMatrix();return a.transformRect(e,r.multiply(n).multiply(i))},getNodeBoundingRect:function(t){var e=this.nodeCache(t);if(e.boundingRect===undefined)e.boundingRect=a(t).getBBox();return new n.Rect(e.boundingRect)},getNodeUnrotatedBBox:function(t){var e=this.getNodeBoundingRect(t);var i=this.getNodeMatrix(t);var r=this.getRootTranslateMatrix();return a.transformRect(e,r.multiply(i))},getNodeShape:function(t){var e=this.nodeCache(t);if(e.geometryShape===undefined)e.geometryShape=a(t).toGeometryShape();return e.geometryShape.clone()},getNodeMatrix:function(t){var e=this.nodeCache(t);if(e.magnetMatrix===undefined){var i=this.rotatableNode||this.el;e.magnetMatrix=a(t).getTransformToElement(i)}return a.createSVGMatrix(e.magnetMatrix)},getRootTranslateMatrix:function(){var t=this.model;var e=t.position();var i=a.createSVGMatrix().translate(e.x,e.y);return i},getRootRotateMatrix:function(){var t=a.createSVGMatrix();var e=this.model;var i=e.angle();if(i){var r=e.getBBox();var n=r.width/2;var o=r.height/2;t=t.translate(n,o).rotate(i).translate(-n,-o)}return t},rgRotate:function(){this.rotatableNode.attr("transform",this.getRotateString())},rgTranslate:function(){this.vel.attr("transform",this.getTranslateString())},sgResize:function(t,e,i){var r=this.model;var n=r.get("angle")||0;var a=r.get("size")||{width:1,height:1};var o=this.scalableNode;var s=false;if(o.node.getElementsByTagName("path").length>0){s=true}var l=o.getBBox({recursive:s});var c=a.width/(l.width||1);var u=a.height/(l.height||1);o.attr("transform","scale("+c+","+u+")");var g=this.rotatableNode;var h=g&&g.attr("transform");if(h&&h!==null){g.attr("transform",h+" rotate("+-n+","+a.width/2+","+a.height/2+")");var d=o.getBBox({target:this.paper.viewport});r.set("position",{x:d.x,y:d.y},i);this.rotate()}this.update()},prepareEmbedding:function(t){t||(t={});var e=t.model||this.model;var i=t.paper||this.paper;var r=i.model;e.startBatch("to-front");e.toFront({deep:true,ui:true});var n=r.get("cells").max("z").get("z");var a=r.getConnectedLinks(e,{deep:true});s.util.invoke(a,"set","z",n+1,{ui:true});e.stopBatch("to-front");var o=e.parent();o&&r.getCell(o).unembed(e,{ui:true})},processEmbedding:function(t){t||(t={});var e=t.model||this.model;var i=t.paper||this.paper;var r=i.options;var n=[];if(s.util.isFunction(r.findParentBy)){var a=s.util.toArray(r.findParentBy.call(i.model,this));n=a.filter(function(t){return t instanceof s.dia.Cell&&this.model.id!==t.id&&!t.isEmbeddedIn(this.model)}.bind(this))}else{n=i.model.findModelsUnderElement(e,{searchBy:r.findParentBy})}if(r.frontParentOnly){n=n.slice(-1)}var o=null;var l=t.candidateEmbedView;for(var c=n.length-1;c>=0;c--){var u=n[c];if(l&&l.model.id==u.id){o=l;break}else{var g=u.findView(i);if(r.validateEmbedding.call(i,this,g)){o=g;break}}}if(o&&o!=l){this.clearEmbedding(t);t.candidateEmbedView=o.highlight(null,{embedding:true})}if(!o&&l){this.clearEmbedding(t)}},clearEmbedding:function(t){t||(t={});var e=t.candidateEmbedView;if(e){e.unhighlight(null,{embedding:true});t.candidateEmbedView=null}},finalizeEmbedding:function(t){t||(t={});var e=t.candidateEmbedView;var i=t.model||this.model;var r=t.paper||this.paper;if(e){e.model.embed(i,{ui:true});e.unhighlight(null,{embedding:true});t.candidateEmbedView=null}s.util.invoke(r.model.getConnectedLinks(i,{deep:true}),"reparent",{ui:true})},pointerdblclick:function(t,e,i){s.dia.CellView.prototype.pointerdblclick.apply(this,arguments);this.notify("element:pointerdblclick",t,e,i)},pointerclick:function(t,e,i){s.dia.CellView.prototype.pointerclick.apply(this,arguments);this.notify("element:pointerclick",t,e,i)},contextmenu:function(t,e,i){s.dia.CellView.prototype.contextmenu.apply(this,arguments);this.notify("element:contextmenu",t,e,i)},pointerdown:function(t,e,i){s.dia.CellView.prototype.pointerdown.apply(this,arguments);this.notify("element:pointerdown",t,e,i);this.dragStart(t,e,i)},pointermove:function(t,e,i){var r=this.eventData(t);switch(r.action){case"move":this.drag(t,e,i);break;case"magnet":this.dragMagnet(t,e,i);break}if(!r.stopPropagation){s.dia.CellView.prototype.pointermove.apply(this,arguments);this.notify("element:pointermove",t,e,i)}this.eventData(t,r)},pointerup:function(t,e,i){var r=this.eventData(t);switch(r.action){case"move":this.dragEnd(t,e,i);break;case"magnet":this.dragMagnetEnd(t,e,i);return}if(!r.stopPropagation){this.notify("element:pointerup",t,e,i);s.dia.CellView.prototype.pointerup.apply(this,arguments)}},mouseover:function(t){s.dia.CellView.prototype.mouseover.apply(this,arguments);this.notify("element:mouseover",t)},mouseout:function(t){s.dia.CellView.prototype.mouseout.apply(this,arguments);this.notify("element:mouseout",t)},mouseenter:function(t){s.dia.CellView.prototype.mouseenter.apply(this,arguments);this.notify("element:mouseenter",t)},mouseleave:function(t){s.dia.CellView.prototype.mouseleave.apply(this,arguments);this.notify("element:mouseleave",t)},mousewheel:function(t,e,i,r){s.dia.CellView.prototype.mousewheel.apply(this,arguments);this.notify("element:mousewheel",t,e,i,r)},onmagnet:function(t,e,i){this.dragMagnetStart(t,e,i);var r=this.eventData(t).stopPropagation;if(r)t.stopPropagation()},dragStart:function(t,e,i){if(!this.can("elementMove"))return;this.eventData(t,{action:"move",x:e,y:i,restrictedArea:this.paper.getRestrictedArea(this)})},dragMagnetStart:function(t,e,i){if(!this.can("addLinkFromMagnet"))return;this.model.startBatch("add-link");var r=this.paper;var n=r.model;var a=t.target;var o=r.getDefaultLink(this,a);var l=this.getLinkEnd(a,e,i,o,"source");var c={x:e,y:i};o.set({source:l,target:c});o.addTo(n,{async:false,ui:true});var u=o.findView(r);s.dia.CellView.prototype.pointerdown.apply(u,arguments);u.notify("link:pointerdown",t,e,i);var g=u.startArrowheadMove("target",{whenNotAllowed:"remove"});u.eventData(t,g);this.eventData(t,{action:"magnet",linkView:u,stopPropagation:true});this.paper.delegateDragEvents(this,t.data)},drag:function(t,e,i){var r=this.paper;var a=r.options.gridSize;var o=this.model;var s=o.position();var l=this.eventData(t);var c=n.snapToGrid(s.x,a)-s.x+n.snapToGrid(e-l.x,a);var u=n.snapToGrid(s.y,a)-s.y+n.snapToGrid(i-l.y,a);o.translate(c,u,{restrictedArea:l.restrictedArea,ui:true});var g=!!l.embedding;if(r.options.embeddingMode){if(!g){this.prepareEmbedding(l);g=true}this.processEmbedding(l)}this.eventData(t,{x:n.snapToGrid(e,a),y:n.snapToGrid(i,a),embedding:g})},dragMagnet:function(t,e,i){var r=this.eventData(t);var n=r.linkView;if(n)n.pointermove(t,e,i)},dragEnd:function(t,e,i){var r=this.eventData(t);if(r.embedding)this.finalizeEmbedding(r)},dragMagnetEnd:function(t,e,i){var r=this.eventData(t);var n=r.linkView;if(n)n.pointerup(t,e,i);this.model.stopBatch("add-link")}});s.dia.Link=s.dia.Cell.extend({markup:['<path class="connection" stroke="black" d="M 0 0 0 0"/>','<path class="marker-source" fill="black" stroke="black" d="M 0 0 0 0"/>','<path class="marker-target" fill="black" stroke="black" d="M 0 0 0 0"/>','<path class="connection-wrap" d="M 0 0 0 0"/>','<g class="labels"/>','<g class="marker-vertices"/>','<g class="marker-arrowheads"/>','<g class="link-tools"/>'].join(""),toolMarkup:['<g class="link-tool">','<g class="tool-remove" event="remove">','<circle r="11" />','<path transform="scale(.8) translate(-16, -16)" d="M24.778,21.419 19.276,15.917 24.777,10.415 21.949,7.585 16.447,13.087 10.945,7.585 8.117,10.415 13.618,15.917 8.116,21.419 10.946,24.248 16.447,18.746 21.948,24.248z" />',"<title>Remove link.</title>","</g>",'<g class="tool-options" event="link:options">','<circle r="11" transform="translate(25)"/>','<path fill="white" transform="scale(.55) translate(29, -16)" d="M31.229,17.736c0.064-0.571,0.104-1.148,0.104-1.736s-0.04-1.166-0.104-1.737l-4.377-1.557c-0.218-0.716-0.504-1.401-0.851-2.05l1.993-4.192c-0.725-0.91-1.549-1.734-2.458-2.459l-4.193,1.994c-0.647-0.347-1.334-0.632-2.049-0.849l-1.558-4.378C17.165,0.708,16.588,0.667,16,0.667s-1.166,0.041-1.737,0.105L12.707,5.15c-0.716,0.217-1.401,0.502-2.05,0.849L6.464,4.005C5.554,4.73,4.73,5.554,4.005,6.464l1.994,4.192c-0.347,0.648-0.632,1.334-0.849,2.05l-4.378,1.557C0.708,14.834,0.667,15.412,0.667,16s0.041,1.165,0.105,1.736l4.378,1.558c0.217,0.715,0.502,1.401,0.849,2.049l-1.994,4.193c0.725,0.909,1.549,1.733,2.459,2.458l4.192-1.993c0.648,0.347,1.334,0.633,2.05,0.851l1.557,4.377c0.571,0.064,1.148,0.104,1.737,0.104c0.588,0,1.165-0.04,1.736-0.104l1.558-4.377c0.715-0.218,1.399-0.504,2.049-0.851l4.193,1.993c0.909-0.725,1.733-1.549,2.458-2.458l-1.993-4.193c0.347-0.647,0.633-1.334,0.851-2.049L31.229,17.736zM16,20.871c-2.69,0-4.872-2.182-4.872-4.871c0-2.69,2.182-4.872,4.872-4.872c2.689,0,4.871,2.182,4.871,4.872C20.871,18.689,18.689,20.871,16,20.871z"/>',"<title>Link options.</title>","</g>","</g>"].join(""),doubleToolMarkup:undefined,vertexMarkup:['<g class="marker-vertex-group" transform="translate(<%= x %>, <%= y %>)">','<circle class="marker-vertex" idx="<%= idx %>" r="10" />','<path class="marker-vertex-remove-area" idx="<%= idx %>" d="M16,5.333c-7.732,0-14,4.701-14,10.5c0,1.982,0.741,3.833,2.016,5.414L2,25.667l5.613-1.441c2.339,1.317,5.237,2.107,8.387,2.107c7.732,0,14-4.701,14-10.5C30,10.034,23.732,5.333,16,5.333z" transform="translate(5, -33)"/>','<path class="marker-vertex-remove" idx="<%= idx %>" transform="scale(.8) translate(9.5, -37)" d="M24.778,21.419 19.276,15.917 24.777,10.415 21.949,7.585 16.447,13.087 10.945,7.585 8.117,10.415 13.618,15.917 8.116,21.419 10.946,24.248 16.447,18.746 21.948,24.248z">',"<title>Remove vertex.</title>","</path>","</g>"].join(""),arrowheadMarkup:['<g class="marker-arrowhead-group marker-arrowhead-group-<%= end %>">','<path class="marker-arrowhead" end="<%= end %>" d="M 26 0 L 0 13 L 26 26 z" />',"</g>"].join(""),defaultLabel:undefined,labelMarkup:undefined,_builtins:{defaultLabel:{markup:[{tagName:"rect",selector:"rect"},{tagName:"text",selector:"text"}],attrs:{text:{fill:"#000000",fontSize:14,textAnchor:"middle",yAlignment:"middle",pointerEvents:"none"},rect:{ref:"text",fill:"#ffffff",rx:3,ry:3,refWidth:1,refHeight:1,refX:0,refY:0}},position:{distance:.5}}},defaults:{type:"link",source:{},target:{}},isLink:function(){return true},disconnect:function(t){return this.set({source:{x:0,y:0},target:{x:0,y:0}},t)},source:function(t,e,i){if(t===undefined){return s.util.clone(this.get("source"))}var r;var a;var o=t instanceof s.dia.Cell;if(o){r=s.util.clone(e)||{};r.id=t.id;a=i;return this.set("source",r,a)}var l=t instanceof n.Point;if(l){r=s.util.clone(e)||{};r.x=t.x;r.y=t.y;a=i;return this.set("source",r,a)}r=t;a=e;return this.set("source",r,a)},target:function(t,e,i){if(t===undefined){return s.util.clone(this.get("target"))}var r;var a;var o=t instanceof s.dia.Cell;if(o){r=s.util.clone(e)||{};r.id=t.id;a=i;return this.set("target",r,a)}var l=t instanceof n.Point;if(l){r=s.util.clone(e)||{};r.x=t.x;r.y=t.y;a=i;return this.set("target",r,a)}r=t;a=e;return this.set("target",r,a)},router:function(t,e,i){if(t===undefined){router=this.get("router");if(!router){if(this.get("manhattan"))return{name:"orthogonal"};return null}if(typeof router==="object")return s.util.clone(router);return router}var r=typeof t==="object"||typeof t==="function";var n=r?t:{name:t,args:e};var a=r?e:i;return this.set("router",n,a)},connector:function(t,e,i){if(t===undefined){connector=this.get("connector");if(!connector){if(this.get("smooth"))return{name:"smooth"};return null}if(typeof connector==="object")return s.util.clone(connector);return connector}var r=typeof t==="object"||typeof t==="function";var n=r?t:{name:t,args:e};var a=r?e:i;return this.set("connector",n,a)},label:function(t,e,i){var r=this.labels();t=isFinite(t)&&t!==null?t|0:0;if(t<0)t=r.length+t;if(arguments.length<=1)return this.prop(["labels",t]);return this.prop(["labels",t],e,i)},labels:function(t,e){if(arguments.length===0){t=this.get("labels");if(!Array.isArray(t))return[];return t.slice()}if(!Array.isArray(t))t=[];return this.set("labels",t,e)},insertLabel:function(t,e,i){if(!e)throw new Error("dia.Link: no label provided");var r=this.labels();var n=r.length;t=isFinite(t)&&t!==null?t|0:n;if(t<0)t=n+t+1;r.splice(t,0,e);return this.labels(r,i)},appendLabel:function(t,e){return this.insertLabel(-1,t,e)},removeLabel:function(t,e){var i=this.labels();t=isFinite(t)&&t!==null?t|0:-1;i.splice(t,1);return this.labels(i,e)},vertex:function(t,e,i){var r=this.vertices();t=isFinite(t)&&t!==null?t|0:0;if(t<0)t=r.length+t;if(arguments.length<=1)return this.prop(["vertices",t]);return this.prop(["vertices",t],e,i)},vertices:function(t,e){if(arguments.length===0){t=this.get("vertices");if(!Array.isArray(t))return[];return t.slice()}if(!Array.isArray(t))t=[];return this.set("vertices",t,e)},insertVertex:function(t,e,i){if(!e)throw new Error("dia.Link: no vertex provided");var r=this.vertices();var n=r.length;t=isFinite(t)&&t!==null?t|0:n;if(t<0)t=n+t+1;r.splice(t,0,e);return this.vertices(r,i)},removeVertex:function(t,e){var i=this.vertices();t=isFinite(t)&&t!==null?t|0:-1;i.splice(t,1);return this.vertices(i,e)},translate:function(t,e,i){i=i||{};i.translateBy=i.translateBy||this.id;i.tx=t;i.ty=e;return this.applyToPoints(function(i){return{x:(i.x||0)+t,y:(i.y||0)+e}},i)},scale:function(t,e,i,r){return this.applyToPoints(function(r){return n.point(r).scale(t,e,i).toJSON()},r)},applyToPoints:function(t,e){if(!s.util.isFunction(t)){throw new TypeError("dia.Link: applyToPoints expects its first parameter to be a function.")}var i={};var r=this.source();if(!r.id){i.source=t(r)}var n=this.target();if(!n.id){i.target=t(n)}var a=this.vertices();if(a.length>0){i.vertices=a.map(t)}return this.set(i,e)},reparent:function(t){var e;if(this.graph){var i=this.getSourceElement();var r=this.getTargetElement();var n=this.getParentCell();if(i&&r){e=this.graph.getCommonAncestor(i,r)}if(n&&(!e||e.id!==n.id)){n.unembed(this,t)}if(e){e.embed(this,t)}}return e},hasLoop:function(t){t=t||{};var e=this.source().id;var i=this.target().id;if(!e||!i){return false}var r=e===i;if(!r&&t.deep&&this.graph){var n=this.getSourceElement();var a=this.getTargetElement();r=n.isEmbeddedIn(a)||a.isEmbeddedIn(n)}return r},getSourceElement:function(){var t=this.source();var e=this.graph;return t&&t.id&&e&&e.getCell(t.id)||null},getTargetElement:function(){var t=this.target();var e=this.graph;return t&&t.id&&e&&e.getCell(t.id)||null},getRelationshipAncestor:function(){var t;if(this.graph){var e=[this,this.getSourceElement(),this.getTargetElement()].filter(function(t){return!!t});t=this.graph.getCommonAncestor.apply(this.graph,e)}return t||null},isRelationshipEmbeddedIn:function(t){var e=s.util.isString(t)||s.util.isNumber(t)?t:t.id;var i=this.getRelationshipAncestor();return!!i&&(i.id===e||i.isEmbeddedIn(e))},_getDefaultLabel:function(){var t=this.get("defaultLabel")||this.defaultLabel||{};var e={};e.markup=t.markup||this.get("labelMarkup")||this.labelMarkup;e.position=t.position;e.attrs=t.attrs;e.size=t.size;return e}},{endsEqual:function(t,e){var i=t.port===e.port||!t.port&&!e.port;return t.id===e.id&&i}});s.dia.LinkView=s.dia.CellView.extend({className:function(){var t=s.dia.CellView.prototype.className.apply(this).split(" ");t.push("link");return t.join(" ")},options:{shortLinkLength:105,doubleLinkTools:false,longLinkLength:155,linkToolsOffset:40,doubleLinkToolsOffset:65,sampleInterval:50},_labelCache:null,_labelSelectors:null,_markerCache:null,_V:null,_dragData:null,metrics:null,decimalsRounding:2,initialize:function(t){s.dia.CellView.prototype.initialize.apply(this,arguments);if(typeof this.constructor.prototype.watchSource!=="function"){this.constructor.prototype.watchSource=this.createWatcher("source");this.constructor.prototype.watchTarget=this.createWatcher("target")}this._labelCache={};this._labelSelectors={};this._markerCache={};this._V={},this.metrics={},this.startListening()},startListening:function(){var t=this.model;this.listenTo(t,"change:markup",this.render);this.listenTo(t,"change:smooth change:manhattan change:router change:connector",this.update);this.listenTo(t,"change:toolMarkup",this.onToolsChange);this.listenTo(t,"change:labels change:labelMarkup",this.onLabelsChange);this.listenTo(t,"change:vertices change:vertexMarkup",this.onVerticesChange);this.listenTo(t,"change:source",this.onSourceChange);this.listenTo(t,"change:target",this.onTargetChange)},onSourceChange:function(t,e,i){this.watchSource(t,e);var r=this.model;if(!i.translateBy||!r.get("target").id||!e.id){this.update(r,null,i)}},onTargetChange:function(t,e,i){this.watchTarget(t,e);var r=this.model;if(!i.translateBy||r.get("source").id&&!e.id&&s.util.isEmpty(r.get("vertices"))){this.update(r,null,i)}},onVerticesChange:function(t,e,i){this.renderVertexMarkers();if(!i.translateBy||i.translateBy===this.model.id){this.update(t,null,i)}},onToolsChange:function(){this.renderTools().updateToolsPosition()},onLabelsChange:function(t,e,i){var r=true;var n=this.model.previous("labels");if(n){if("propertyPathArray"in i&&"propertyValue"in i){var a=i.propertyPathArray||[];var o=a.length;if(o>1){var s=!!n[a[1]];if(s){if(o===2){r="markup"in Object(i.propertyValue)}else if(a[2]!=="markup"){r=false}}}}}if(r){this.renderLabels()}else{this.updateLabels()}this.updateLabelPositions()},render:function(){this.vel.empty();this._V={};this.renderMarkup();this.renderLabels();var t=this.model;this.watchSource(t,t.source()).watchTarget(t,t.target()).update();return this},renderMarkup:function(){var t=this.model;var e=t.get("markup")||t.markup;if(!e)throw new Error("dia.LinkView: markup required");if(Array.isArray(e))return this.renderJSONMarkup(e);if(typeof e==="string")return this.renderStringMarkup(e);throw new Error("dia.LinkView: invalid markup")},renderJSONMarkup:function(t){var e=s.util.parseDOMJSON(t);var i=this.selectors=e.selectors;var r=this.selector;if(i[r])throw new Error("dia.LinkView: ambiguous root selector.");i[r]=this.el;this.vel.append(e.fragment)},renderStringMarkup:function(t){var e=a(t);if(!Array.isArray(e))e=[e];var i=this._V;for(var n=0,o=e.length;n<o;n++){var l=e[n];var c=l.attr("class");if(c){c=s.util.removeClassNamePrefix(c);i[r.camelCase(c)]=l}}this.renderTools();this.renderVertexMarkers();this.renderArrowheadMarkers();this.vel.append(e)},_getLabelMarkup:function(t){if(!t)return undefined;if(Array.isArray(t))return this._getLabelJSONMarkup(t);if(typeof t==="string")return this._getLabelStringMarkup(t);throw new Error("dia.linkView: invalid label markup")},_getLabelJSONMarkup:function(t){return s.util.parseDOMJSON(t)},_getLabelStringMarkup:function(t){var e=a(t);var i=document.createDocumentFragment();if(!Array.isArray(e)){i.append(e.node)}else{for(var r=0,n=e.length;r<n;r++){var o=e[r].node;i.appendChild(o)}}return{fragment:i,selectors:{}}},_normalizeLabelMarkup:function(t){if(!t)return undefined;var e=t.fragment;if(!(t.fragment instanceof DocumentFragment)||!t.fragment.hasChildNodes())throw new Error("dia.LinkView: invalid label markup.");var i;var r=e.childNodes;if(r.length>1||r[0].nodeName.toUpperCase()!=="G"){i=a("g");i.append(e);i.addClass("label")}else{i=a(r[0]);i.addClass("label")}return{node:i.node,selectors:t.selectors}},renderLabels:function(){var t=this._V;var e=t.labels;var i=this._labelCache={};var r=this._labelSelectors={};if(e)e.empty();var n=this.model;var o=n.get("labels")||[];var s=o.length;if(s===0)return this;if(!e){e=t.labels=a("g").addClass("labels").appendTo(this.el)}for(var l=0;l<s;l++){var c=o[l];var u=this._normalizeLabelMarkup(this._getLabelMarkup(c.markup));var g;var h;if(u){g=u.node;h=u.selectors}else{var d=n._builtins.defaultLabel;var f=this._normalizeLabelMarkup(this._getLabelMarkup(d.markup));var v=n._getDefaultLabel();var p=this._normalizeLabelMarkup(this._getLabelMarkup(v.markup));var I=p||f;g=I.node;h=I.selectors}var m=a(g);m.attr("label-idx",l);m.appendTo(e);i[l]=m;h[this.selector]=m.node;r[l]=h}this.updateLabels();return this},_mergeLabelAttrs:function(t,e,i,r){if(e===null)return null;if(e===undefined){if(i===null)return null;if(i===undefined){if(t)return undefined;return r}if(t)return i;return s.util.merge({},r,i)}if(t)return s.util.merge({},i,e);return s.util.merge({},r,i,e)},updateLabels:function(){if(!this._V.labels)return this;var t=this.model;var e=t.get("labels")||[];var i=this.can("labelMove");var r=t._builtins.defaultLabel;var a=r.attrs;var o=t._getDefaultLabel();var s=o.markup;var l=o.attrs;for(var c=0,u=e.length;c<u;c++){var g=this._labelCache[c];g.attr("cursor",i?"move":"default");var h=this._labelSelectors[c];var d=e[c];var f=d.markup;var v=d.attrs;var p=this._mergeLabelAttrs(f||s,v,l,a);this.updateDOMSubtreeAttributes(g.node,p,{rootBBox:new n.Rect(d.size),selectors:h})}return this},renderTools:function(){if(!this._V.linkTools)return this;var t=r(this._V.linkTools.node).empty();var e=s.util.template(this.model.get("toolMarkup")||this.model.toolMarkup);var i=a(e());t.append(i.node);this._toolCache=i;if(this.options.doubleLinkTools){var n;if(this.model.get("doubleToolMarkup")||this.model.doubleToolMarkup){e=s.util.template(this.model.get("doubleToolMarkup")||this.model.doubleToolMarkup);n=a(e())}else{n=i.clone()}t.append(n.node);this._tool2Cache=n}return this},renderVertexMarkers:function(){if(!this._V.markerVertices)return this;var t=r(this._V.markerVertices.node).empty();var e=s.util.template(this.model.get("vertexMarkup")||this.model.vertexMarkup);this.model.vertices().forEach(function(i,r){t.append(a(e(s.util.assign({idx:r},i))).node)});return this},renderArrowheadMarkers:function(){if(!this._V.markerArrowheads)return this;var t=r(this._V.markerArrowheads.node);t.empty();var e=s.util.template(this.model.get("arrowheadMarkup")||this.model.arrowheadMarkup);this._V.sourceArrowhead=a(e({end:"source"}));this._V.targetArrowhead=a(e({end:"target"}));t.append(this._V.sourceArrowhead.node,this._V.targetArrowhead.node);return this},update:function(t,e,i){i||(i={});this.updateConnection(i);this.updateDOMSubtreeAttributes(this.el,this.model.attr(),{selectors:this.selectors});this.updateDefaultConnectionPath();this.updateLabelPositions();this.updateToolsPosition();this.updateArrowheadMarkers();this.updateTools(i);this.options.perpendicular=null;this.updatePostponed=false;return this},removeRedundantLinearVertices:function(t){var e=this.model;var i=e.vertices();var r=[];var a=i.length;var o=0;for(var s=0;s<a;s++){var l=new n.Point(i[s]).round();var c=new n.Point(r[o-1]||this.sourceAnchor).round();if(c.equals(l))continue;var u=new n.Point(i[s+1]||this.targetAnchor).round();if(c.equals(u))continue;var g=new n.Line(c,u);if(g.pointOffset(l)===0)continue;r.push(i[s]);o++}if(a===o)return 0;e.vertices(r,t);return a-o},updateDefaultConnectionPath:function(){var t=this._V;if(t.connection){t.connection.attr("d",this.getSerializedConnection())}if(t.connectionWrap){t.connectionWrap.attr("d",this.getSerializedConnection())}if(t.markerSource&&t.markerTarget){this._translateAndAutoOrientArrows(t.markerSource,t.markerTarget)}},getEndView:function(t){switch(t){case"source":return this.sourceView||null;case"target":return this.targetView||null;default:throw new Error("dia.LinkView: type parameter required.")}},getEndAnchor:function(t){switch(t){case"source":return new n.Point(this.sourceAnchor);case"target":return new n.Point(this.targetAnchor);default:throw new Error("dia.LinkView: type parameter required.")}},getEndMagnet:function(t){switch(t){case"source":var e=this.sourceView;if(!e)break;return this.sourceMagnet||e.el;case"target":var i=this.targetView;if(!i)break;return this.targetMagnet||i.el;default:throw new Error("dia.LinkView: type parameter required.")}return null},updateConnection:function(t){t=t||{};var e=this.model;var i,r;if(t.translateBy&&e.isRelationshipEmbeddedIn(t.translateBy)){var a=t.tx||0;var o=t.ty||0;i=new n.Polyline(this.route).translate(a,o).points;this._translateConnectionPoints(a,o);r=this.path;r.translate(a,o)}else{var s=e.vertices();var l=this.findAnchors(s);var c=this.sourceAnchor=l.source;var u=this.targetAnchor=l.target;i=this.findRoute(s,t);var g=this.findConnectionPoints(i,c,u);var h=this.sourcePoint=g.source;var d=this.targetPoint=g.target;var f=this.findMarkerPoints(i,h,d);r=this.findPath(i,f.source||h,f.target||d)}this.route=i;this.path=r;this.metrics={}},findMarkerPoints:function(t,e,i){var r=t[0];var a=t[t.length-1];var o=this._markerCache;var s,l;if(this._V.markerSource){o.sourceBBox=o.sourceBBox||this._V.markerSource.getBBox();s=n.point(e).move(r||i,o.sourceBBox.width*this._V.markerSource.scale().sx*-1).round()}if(this._V.markerTarget){o.targetBBox=o.targetBBox||this._V.markerTarget.getBBox();l=n.point(i).move(a||e,o.targetBBox.width*this._V.markerTarget.scale().sx*-1).round()}o.sourcePoint=s||e.clone();o.targetPoint=l||i.clone();return{source:s,target:l}},findAnchors:function(t){var e=this.model;var i=t[0];var r=t[t.length-1];var a=e.get("source");var o=e.get("target");var s=this.sourceView;var l=this.targetView;var c,u;var g;if(s){c=this.sourceMagnet||s.el;var h;if(i){h=new n.Point(i)}else if(l){h=this.targetMagnet||l.el}else{h=new n.Point(o)}g=this.getAnchor(a.anchor,s,c,h,"source")}else{g=new n.Point(a)}var d;if(l){u=this.targetMagnet||l.el;var f=new n.Point(r||g);d=this.getAnchor(o.anchor,l,u,f,"target")}else{d=new n.Point(o)}return{source:g,target:d}},findConnectionPoints:function(t,e,i){var r=t[0];var a=t[t.length-1];var o=this.model;var s=o.get("source");var l=o.get("target");var c=this.sourceView;var u=this.targetView;var g=this.paper.options;var h,d;var f;if(c){h=this.sourceMagnet||c.el;var v=s.connectionPoint||g.defaultConnectionPoint;var p=r||i;var I=new n.Line(p,e);f=this.getConnectionPoint(v,c,h,I,"source")}else{f=e}var m;if(u){d=this.targetMagnet||u.el;var A=l.connectionPoint||g.defaultConnectionPoint;var C=a||e;var w=new n.Line(C,i);m=this.getConnectionPoint(A,u,d,w,"target")}else{m=i}return{source:f,target:m}},getAnchor:function(t,e,i,r,a){if(!t){var o=this.paper.options;if(o.perpendicularLinks||this.options.perpendicular){t={name:"perpendicular"}}else{t=o.defaultAnchor}}if(!t)throw new Error("Anchor required.");var l;if(typeof t==="function"){l=t}else{var c=t.name;l=s.anchors[c];if(typeof l!=="function")throw new Error("Unknown anchor: "+c)}var u=l.call(this,e,i,r,t.args||{},a,this);if(u)return u.round(this.decimalsRounding);return new n.Point},getConnectionPoint:function(t,e,i,r,n){var a;var o=r.end;var l=this.paper.options;if(typeof l.linkConnectionPoint==="function"){a=l.linkConnectionPoint(this,e,i,r.start,n);if(a)return a}if(!t)return o;var c;if(typeof t==="function"){c=t}else{var u=t.name;c=s.connectionPoints[u];if(typeof c!=="function")throw new Error("Unknown connection point: "+u)}a=c.call(this,r,e,i,t.args||{},n,this);if(a)return a.round(this.decimalsRounding);return o},_translateConnectionPoints:function(t,e){var i=this._markerCache;i.sourcePoint.offset(t,e);i.targetPoint.offset(t,e);this.sourcePoint.offset(t,e);this.targetPoint.offset(t,e);this.sourceAnchor.offset(t,e);this.targetAnchor.offset(t,e)},_normalizeLabelPosition:function(t){if(typeof t==="number")return{distance:t,offset:null,args:null};return t},updateLabelPositions:function(){if(!this._V.labels)return this;var t=this.path;if(!t)return this;var e=this.model;var i=e.get("labels")||[];if(!i.length)return this;var r=e._builtins.defaultLabel;var n=r.position;var a=e._getDefaultLabel();var o=this._normalizeLabelPosition(a.position);var l=s.util.merge({},n,o);for(var c=0,u=i.length;c<u;c++){var g=i[c];var h=this._normalizeLabelPosition(g.position);var d=s.util.merge({},l,h);var f=this.getLabelCoordinates(d);this._labelCache[c].attr("transform","translate("+f.x+", "+f.y+")")}return this},updateToolsPosition:function(){if(!this._V.linkTools)return this;var t="";var e=this.options.linkToolsOffset;var i=this.getConnectionLength();if(!Number.isNaN(i)){if(i<this.options.shortLinkLength){t="scale(.5)";e/=2}var r=this.getPointAtLength(e);this._toolCache.attr("transform","translate("+r.x+", "+r.y+") "+t);if(this.options.doubleLinkTools&&i>=this.options.longLinkLength){var n=this.options.doubleLinkToolsOffset||e;r=this.getPointAtLength(i-n);this._tool2Cache.attr("transform","translate("+r.x+", "+r.y+") "+t);this._tool2Cache.attr("visibility","visible")}else if(this.options.doubleLinkTools){this._tool2Cache.attr("visibility","hidden")}}return this},updateArrowheadMarkers:function(){if(!this._V.markerArrowheads)return this;if(r.css(this._V.markerArrowheads.node,"display")==="none")return this;var t=this.getConnectionLength()<this.options.shortLinkLength?.5:1;this._V.sourceArrowhead.scale(t);this._V.targetArrowhead.scale(t);this._translateAndAutoOrientArrows(this._V.sourceArrowhead,this._V.targetArrowhead);return this},createWatcher:function(t){var e=function(e,i){this.onEndModelChange(t,e,i)};function i(i,r){r=r||{};var n=null;var a=i.previous(t)||{};if(a.id){this.stopListening(this.paper.getModelById(a.id),"change",e)}if(r.id){n=this.paper.getModelById(r.id);this.listenTo(n,"change",e)}e.call(this,n,{cacheOnly:true});return this}return i},onEndModelChange:function(t,e,i){var r=!i.cacheOnly;var n=this.model;var a=n.get(t)||{};if(e){var o=this.constructor.makeSelector(a);var l=t=="source"?"target":"source";var c=n.get(l)||{};var u=a.id;var g=c.id;var h=g&&this.constructor.makeSelector(c);if(i.handleBy===this.cid&&u===g&&o==h){this[t+"View"]=this[l+"View"];this[t+"Magnet"]=this[l+"Magnet"]}else if(i.translateBy){}else{var d=this.paper.model.getCell(u);if(!d)throw new Error("LinkView: invalid "+t+" cell.");var f=d.findView(this.paper);if(f){var v=f.getMagnetFromLinkEnd(a);if(v===f.el)v=null;this[t+"View"]=f;this[t+"Magnet"]=v}else{this[t+"View"]=this[t+"Magnet"]=null}}if(i.handleBy===this.cid&&i.translateBy&&n.isEmbeddedIn(e)&&!s.util.isEmpty(n.get("vertices"))){r=false}if(!this.updatePostponed&&g){var p=this.paper.getModelById(g);if(a.id===c.id){i.handleBy=this.cid}if(i.handleBy===this.cid||i.translateBy&&p.isEmbeddedIn(i.translateBy)){this.updatePostponed=true;r=false}}}else{this[t+"View"]=this[t+"Magnet"]=null}if(r){this.update(n,null,i)}},_translateAndAutoOrientArrows:function(t,e){var i=s.util.toArray(this.route);if(t){t.translateAndAutoOrient(this.sourcePoint,i[0]||this.targetPoint,this.paper.viewport)}if(e){e.translateAndAutoOrient(this.targetPoint,i[i.length-1]||this.sourcePoint,this.paper.viewport)}},_getDefaultLabelPositionArgs:function(){var t=this.model._getDefaultLabel();var e=t.position||{};return e.args},_getLabelPositionArgs:function(t){var e=this.model.label(t).position||{};return e.args},_mergeLabelPositionArgs:function(t,e){if(t===null)return null;if(t===undefined){if(e===null)return null;return e}return s.util.merge({},e,t)},addLabel:function(t,e,i){var r=typeof t!=="number";var n=r?t.x:t;var a=r?t.y:e;var o=r?e:i;var s=this._getDefaultLabelPositionArgs();var l=o;var c=this._mergeLabelPositionArgs(l,s);var u={position:this.getLabelPosition(n,a,c)};var g=-1;this.model.insertLabel(g,u,o);return g},addVertex:function(t,e,i){var r=typeof t!=="number";var n=r?t.x:t;var a=r?t.y:e;var o=r?e:i;var s={x:n,y:a};var l=this.getVertexIndex(n,a);this.model.insertVertex(l,s,o);return l},sendToken:function(t,e,i){function r(t,e){return function(){t.remove();if(typeof e==="function"){e()}}}var n,o,l;if(s.util.isObject(e)){n=e.duration;o=e.direction==="reverse";l=e.connection}else{n=e;o=false;l=null}n=n||1e3;var c={dur:n+"ms",repeatCount:1,calcMode:"linear",fill:"freeze"};if(o){c.keyPoints="1;0";c.keyTimes="0;1"}var u=a(t);var g;if(typeof l==="string"){g=this.findBySelector(l,this.el,this.selectors)[0]}else{var h=this._V;g=h.connection?h.connection.node:this.el.querySelector("path")}if(!(g instanceof SVGPathElement)){throw new Error("dia.LinkView: token animation requires a valid connection path.")}u.appendTo(this.paper.viewport).animateAlongPath(c,g);setTimeout(r(u,i),n)},findRoute:function(t){t||(t=[]);var e=s.routers;var i=this.model.router();var r=this.paper.options.defaultRouter;if(!i){if(r)i=r;else return t.map(n.Point,n)}var a=s.util.isFunction(i)?i:e[i.name];if(!s.util.isFunction(a)){throw new Error('dia.LinkView: unknown router: "'+i.name+'".')}var o=i.args||{};var l=a.call(this,t,o,this);if(!l)return t.map(n.Point,n);return l},findPath:function(t,e,i){var r=s.connectors;var o=this.model.connector();var l=this.paper.options.defaultConnector;if(!o){o=l||{}}var c=s.util.isFunction(o)?o:r[o.name];if(!s.util.isFunction(c)){throw new Error('dia.LinkView: unknown connector: "'+o.name+'".')}var u=s.util.clone(o.args||{});u.raw=true;var g=c.call(this,e,i,t,u,this);if(typeof g==="string"){g=new n.Path(a.normalizePathData(g))}return g},getConnection:function(){var t=this.path;if(!t)return null;return t.clone()},getSerializedConnection:function(){var t=this.path;if(!t)return null;var e=this.metrics;if(e.hasOwnProperty("data"))return e.data;var i=t.serialize();e.data=i;return i},getConnectionSubdivisions:function(){var t=this.path;if(!t)return null;var e=this.metrics;if(e.hasOwnProperty("segmentSubdivisions"))return e.segmentSubdivisions;var i=t.getSegmentSubdivisions();e.segmentSubdivisions=i;return i},getConnectionLength:function(){var t=this.path;if(!t)return 0;var e=this.metrics;if(e.hasOwnProperty("length"))return e.length;var i=t.length({segmentSubdivisions:this.getConnectionSubdivisions()});e.length=i;return i},getPointAtLength:function(t){var e=this.path;if(!e)return null;return e.pointAtLength(t,{segmentSubdivisions:this.getConnectionSubdivisions()})},getPointAtRatio:function(t){var e=this.path;if(!e)return null;return e.pointAt(t,{segmentSubdivisions:this.getConnectionSubdivisions()})},getTangentAtLength:function(t){var e=this.path;if(!e)return null;return e.tangentAtLength(t,{segmentSubdivisions:this.getConnectionSubdivisions()})},getTangentAtRatio:function(t){var e=this.path;if(!e)return null;return e.tangentAt(t,{segmentSubdivisions:this.getConnectionSubdivisions()})},getClosestPoint:function(t){var e=this.path;if(!e)return null;return e.closestPoint(t,{segmentSubdivisions:this.getConnectionSubdivisions()})},getClosestPointLength:function(t){var e=this.path;if(!e)return null;return e.closestPointLength(t,{segmentSubdivisions:this.getConnectionSubdivisions()})},getClosestPointRatio:function(t){var e=this.path;if(!e)return null;return e.closestPointNormalizedLength(t,{segmentSubdivisions:this.getConnectionSubdivisions()})},getLabelPosition:function(t,e,i){var r={};var a=i||{};if(i)r.args=i;var o=!a.absoluteDistance;var s=a.absoluteDistance&&a.reverseDistance;var l=a.absoluteOffset;var c=this.path;var u={segmentSubdivisions:this.getConnectionSubdivisions()};var g=new n.Point(t,e);var h=c.closestPointT(g,u);var d=c.lengthAtT(h,u);if(o)d=d/this.getConnectionLength()||0;if(s)d=-1*(this.getConnectionLength()-d)||1;r.distance=d;var f;if(!l)f=c.tangentAtT(h);var v;if(f){v=f.pointOffset(g)}else{var p=c.pointAtT(h);var I=g.difference(p);v={x:I.x,y:I.y}}r.offset=v;return r},getLabelCoordinates:function(t){var e;if(typeof t==="number")e=t;else if(typeof t.distance==="number")e=t.distance;else throw new Error("dia.LinkView: invalid label position distance.");var i=e>0&&e<=1;var r=0;var n={x:0,y:0};if(t.offset){var a=t.offset;if(typeof a==="number")r=a;if(a.x)n.x=a.x;if(a.y)n.y=a.y}var o=n.x!==0||n.y!==0||r===0;var s=this.path;var l={segmentSubdivisions:this.getConnectionSubdivisions()};var c=i?e*this.getConnectionLength():e;var u;if(o){u=s.pointAtLength(c,l);u.offset(n)}else{var g=s.tangentAtLength(c,l);if(g){g.rotate(g.start,-90);g.setLength(r);u=g.end}else{u=s.start}}return u},getVertexIndex:function(t,e){var i=this.model;var r=i.vertices();var a=this.getClosestPointLength(new n.Point(t,e));var o=0;for(var s=r.length;o<s;o++){var l=r[o];var c=this.getClosestPointLength(l);if(a<c)break}return o},pointerdblclick:function(t,e,i){s.dia.CellView.prototype.pointerdblclick.apply(this,arguments);this.notify("link:pointerdblclick",t,e,i)},pointerclick:function(t,e,i){s.dia.CellView.prototype.pointerclick.apply(this,arguments);this.notify("link:pointerclick",t,e,i)},contextmenu:function(t,e,i){s.dia.CellView.prototype.contextmenu.apply(this,arguments);this.notify("link:contextmenu",t,e,i)},pointerdown:function(t,e,i){s.dia.CellView.prototype.pointerdown.apply(this,arguments);this.notify("link:pointerdown",t,e,i);var r=t.target.getAttribute("class");switch(r){case"marker-vertex":this.dragVertexStart(t,e,i);return;case"marker-vertex-remove":case"marker-vertex-remove-area":this.dragVertexRemoveStart(t,e,i);return;case"marker-arrowhead":this.dragArrowheadStart(t,e,i);return;case"connection":case"connection-wrap":this.dragConnectionStart(t,e,i);return;case"marker-source":case"marker-target":return}this.dragStart(t,e,i)},pointermove:function(t,e,i){var r=this._dragData;if(r)this.eventData(t,r);var n=this.eventData(t);switch(n.action){case"vertex-move":this.dragVertex(t,e,i);break;case"label-move":this.dragLabel(t,e,i);break;case"arrowhead-move":this.dragArrowhead(t,e,i);break;case"move":this.drag(t,e,i);break}if(r)s.util.assign(r,this.eventData(t));s.dia.CellView.prototype.pointermove.apply(this,arguments);this.notify("link:pointermove",t,e,i)},pointerup:function(t,e,i){var r=this._dragData;if(r){this.eventData(t,r);this._dragData=null}var n=this.eventData(t);switch(n.action){case"vertex-move":this.dragVertexEnd(t,e,i);break;case"label-move":this.dragLabelEnd(t,e,i);break;case"arrowhead-move":this.dragArrowheadEnd(t,e,i);break;case"move":this.dragEnd(t,e,i)}this.notify("link:pointerup",t,e,i);s.dia.CellView.prototype.pointerup.apply(this,arguments)},mouseover:function(t){s.dia.CellView.prototype.mouseover.apply(this,arguments);this.notify("link:mouseover",t)},mouseout:function(t){s.dia.CellView.prototype.mouseout.apply(this,arguments);this.notify("link:mouseout",t)},mouseenter:function(t){s.dia.CellView.prototype.mouseenter.apply(this,arguments);this.notify("link:mouseenter",t)},mouseleave:function(t){s.dia.CellView.prototype.mouseleave.apply(this,arguments);this.notify("link:mouseleave",t)},mousewheel:function(t,e,i,r){s.dia.CellView.prototype.mousewheel.apply(this,arguments);this.notify("link:mousewheel",t,e,i,r)},onevent:function(t,e,i,r){var n=a(t.target).findParentByClass("link-tool",this.el);if(n){t.stopPropagation();if(this.can("useLinkTools")){if(e==="remove"){this.model.remove({ui:true})}else{this.notify(e,t,i,r)}}}else{s.dia.CellView.prototype.onevent.apply(this,arguments)}},onlabel:function(t,e,i){this.dragLabelStart(t,e,i);var r=this.eventData(t).stopPropagation;if(r)t.stopPropagation()},dragConnectionStart:function(t,e,i){if(!this.can("vertexAdd"))return;var r=this.addVertex({x:e,y:i},{ui:true});this.eventData(t,{action:"vertex-move",vertexIdx:r})},dragLabelStart:function(t,e,i){if(!this.can("labelMove")){this.eventData(t,{stopPropagation:true});return}var r=t.currentTarget;var n=parseInt(r.getAttribute("label-idx"),10);var a=this._getDefaultLabelPositionArgs();var o=this._getLabelPositionArgs(n);var s=this._mergeLabelPositionArgs(o,a);this.eventData(t,{action:"label-move",labelIdx:n,positionArgs:s,stopPropagation:true});this.paper.delegateDragEvents(this,t.data)},dragVertexStart:function(t,e,i){if(!this.can("vertexMove"))return;var r=t.target;var n=parseInt(r.getAttribute("idx"),10);this.eventData(t,{action:"vertex-move",vertexIdx:n})},dragVertexRemoveStart:function(t,e,i){if(!this.can("vertexRemove"))return;var r=t.target;var n=parseInt(r.getAttribute("idx"),10);this.model.removeVertex(n)},dragArrowheadStart:function(t,e,i){if(!this.can("arrowheadMove"))return;var r=t.target;var n=r.getAttribute("end");var a=this.startArrowheadMove(n,{ignoreBackwardsCompatibility:true});this.eventData(t,a)},dragStart:function(t,e,i){if(!this.can("linkMove"))return;this.eventData(t,{action:"move",dx:e,dy:i})},dragLabel:function(t,e,i){var r=this.eventData(t);var n={position:this.getLabelPosition(e,i,r.positionArgs)};this.model.label(r.labelIdx,n)},dragVertex:function(t,e,i){var r=this.eventData(t);this.model.vertex(r.vertexIdx,{x:e,y:i},{ui:true})},dragArrowhead:function(t,e,i){var r=this.eventData(t);if(this.paper.options.snapLinks){this._snapArrowhead(e,i,r)}else{var n=t.type==="mousemove"?t.target:document.elementFromPoint(t.clientX,t.clientY);this._connectArrowhead(n,e,i,r)}},drag:function(t,e,i){var r=this.eventData(t);this.model.translate(e-r.dx,i-r.dy,{ui:true});this.eventData(t,{dx:e,dy:i})},dragLabelEnd:function(){},dragVertexEnd:function(){},dragArrowheadEnd:function(t,e,i){var r=this.eventData(t);var n=this.paper;if(n.options.snapLinks){this._snapArrowheadEnd(r)}else{this._connectArrowheadEnd(r,e,i)}if(!n.linkAllowed(this)){this._disallow(r)}else{this._finishEmbedding(r);this._notifyConnectEvent(r,t)}this._afterArrowheadMove(r);if(!this.vel.contains(t.target)){this.mouseleave(t)}},dragEnd:function(){},_disallow:function(t){switch(t.whenNotAllowed){case"remove":this.model.remove({ui:true});break;case"revert":default:this.model.set(t.arrowhead,t.initialEnd,{ui:true});break}},_finishEmbedding:function(t){if(this.paper.options.embeddingMode&&this.model.reparent()){t.z=null}},_notifyConnectEvent:function(t,e){var i=t.arrowhead;var r=t.initialEnd;var n=this.model.prop(i);var a=n&&!s.dia.Link.endsEqual(r,n);if(a){var o=this.paper;if(r.id){this.notify("link:disconnect",e,o.findViewByModel(r.id),t.initialMagnet,i)}if(n.id){this.notify("link:connect",e,o.findViewByModel(n.id),t.magnetUnderPointer,i)}}},_snapArrowhead:function(t,e,i){var r=this.paper.options.snapLinks.radius||50;var a=this.paper.findViewsInArea({x:t-r,y:e-r,width:2*r,height:2*r});if(i.closestView){i.closestView.unhighlight(i.closestMagnet,{connecting:true,snapping:true})}i.closestView=i.closestMagnet=null;var o;var s=Number.MAX_VALUE;var l=n.point(t,e);var c=this.paper;a.forEach(function(t){if(t.el.getAttribute("magnet")!=="false"){o=t.model.getBBox().center().distance(l);if(o<r&&o<s){if(c.options.validateConnection.apply(c,i.validateConnectionArgs(t,null))){s=o;i.closestView=t;i.closestMagnet=t.el}}}t.$("[magnet]").each(function(e,n){var a=t.getNodeBBox(n);o=l.distance({x:a.x+a.width/2,y:a.y+a.height/2});if(o<r&&o<s){if(c.options.validateConnection.apply(c,i.validateConnectionArgs(t,n))){s=o;i.closestView=t;i.closestMagnet=n}}}.bind(this))},this);var u;var g=i.closestView;var h=i.closestMagnet;var d=i.arrowhead;if(g){g.highlight(h,{connecting:true,snapping:true});u=g.getLinkEnd(h,t,e,this.model,d)}else{u={x:t,y:e}}this.model.set(d,u||{x:t,y:e},{ui:true})},_snapArrowheadEnd:function(t){var e=t.closestView;var i=t.closestMagnet;if(e&&i){e.unhighlight(i,{connecting:true,snapping:true});t.magnetUnderPointer=e.findMagnet(i)}t.closestView=t.closestMagnet=null},_connectArrowhead:function(t,e,i,r){if(r.eventTarget!==t){if(r.magnetUnderPointer){r.viewUnderPointer.unhighlight(r.magnetUnderPointer,{connecting:true})}r.viewUnderPointer=this.paper.findView(t);if(r.viewUnderPointer){r.magnetUnderPointer=r.viewUnderPointer.findMagnet(t);if(r.magnetUnderPointer&&this.paper.options.validateConnection.apply(this.paper,r.validateConnectionArgs(r.viewUnderPointer,r.magnetUnderPointer))){if(r.magnetUnderPointer){r.viewUnderPointer.highlight(r.magnetUnderPointer,{connecting:true})}}else{r.magnetUnderPointer=null}}else{r.magnetUnderPointer=null}}r.eventTarget=t;this.model.set(r.arrowhead,{x:e,y:i},{ui:true})},_connectArrowheadEnd:function(t,e,i){var r=t.viewUnderPointer;var n=t.magnetUnderPointer;if(!n||!r)return;r.unhighlight(n,{connecting:true});var a=t.arrowhead;var o=r.getLinkEnd(n,e,i,this.model,a);this.model.set(a,o,{ui:true})},_beforeArrowheadMove:function(t){t.z=this.model.get("z");this.model.toFront();this.el.style.pointerEvents="none";if(this.paper.options.markAvailable){this._markAvailableMagnets(t)}},_afterArrowheadMove:function(t){if(t.z!==null){this.model.set("z",t.z,{ui:true});t.z=null}this.el.style.pointerEvents="visiblePainted";if(this.paper.options.markAvailable){this._unmarkAvailableMagnets(t)}},_createValidateConnectionArgs:function(t){var e=[];e[4]=t;e[5]=this;var i;var r=0;var n=0;if(t==="source"){r=2;i="target"}else{n=2;i="source"}var a=this.model.get(i);if(a.id){e[r]=this.paper.findViewByModel(a.id);e[r+1]=a.selector&&e[r].el.querySelector(a.selector)}function o(t,i){e[n]=t;e[n+1]=t.el===i?undefined:i;return e}return o},_markAvailableMagnets:function(t){function e(t,e){var i=t.paper;var r=i.options.validateConnection;return r.apply(i,this.validateConnectionArgs(t,e))}var i=this.paper;var r=i.model.getElements();t.marked={};for(var n=0,a=r.length;n<a;n++){var o=r[n].findView(i);if(!o){continue}var s=Array.prototype.slice.call(o.el.querySelectorAll("[magnet]"));if(o.el.getAttribute("magnet")!=="false"){s.push(o.el)}var l=s.filter(e.bind(t,o));if(l.length>0){for(var c=0,u=l.length;c<u;c++){o.highlight(l[c],{magnetAvailability:true})}o.highlight(null,{elementAvailability:true});t.marked[o.model.id]=l}}},_unmarkAvailableMagnets:function(t){var e=Object.keys(t.marked);var i;var r;for(var n=0,a=e.length;n<a;n++){i=e[n];r=t.marked[i];var o=this.paper.findViewByModel(i);if(o){for(var s=0,l=r.length;s<l;s++){o.unhighlight(r[s],{magnetAvailability:true})}o.unhighlight(null,{elementAvailability:true})}}t.marked=null},startArrowheadMove:function(t,e){e||(e={});var i={action:"arrowhead-move",arrowhead:t,whenNotAllowed:e.whenNotAllowed||"revert",initialMagnet:this[t+"Magnet"]||(this[t+"View"]?this[t+"View"].el:null),initialEnd:s.util.clone(this.model.get(t)),validateConnectionArgs:this._createValidateConnectionArgs(t)};this._beforeArrowheadMove(i);if(e.ignoreBackwardsCompatibility!==true){this._dragData=i}return i}},{makeSelector:function(t){var e="";if(t.port){e+='[port="'+t.port+'"]'}else if(t.selector){e+=t.selector}return e}});Object.defineProperty(s.dia.LinkView.prototype,"sourceBBox",{enumerable:true,get:function(){var t=this.sourceView;var e=this.sourceMagnet;if(t){if(!e)e=t.el;return t.getNodeBBox(e)}var i=this.model.source();return new n.Rect(i.x,i.y,1,1)}});Object.defineProperty(s.dia.LinkView.prototype,"targetBBox",{enumerable:true,get:function(){var t=this.targetView;var e=this.targetMagnet;if(t){if(!e)e=t.el;return t.getNodeBBox(e)}var i=this.model.target();return new n.Rect(i.x,i.y,1,1)}});s.dia.Paper=s.mvc.View.extend({className:"paper",options:{width:800,height:600,origin:{x:0,y:0},gridSize:1,drawGrid:false,background:false,perpendicularLinks:false,elementView:s.dia.ElementView,linkView:s.dia.LinkView,snapLinks:false,multiLinks:true,guard:function(t,e){return false},highlighting:{default:{name:"stroke",options:{padding:3}},magnetAvailability:{name:"addClass",options:{className:"available-magnet"}},elementAvailability:{name:"addClass",options:{className:"available-cell"}}},preventContextMenu:true,preventDefaultBlankAction:true,restrictTranslate:false,markAvailable:false,defaultLink:new s.dia.Link,defaultConnector:{name:"normal"},defaultRouter:{name:"normal"},defaultAnchor:{name:"center"},defaultConnectionPoint:{name:"bbox"},connectionStrategy:null,validateMagnet:function(t,e){return e.getAttribute("magnet")!=="passive"},validateConnection:function(t,e,i,r,n,a){return(n==="target"?i:t)instanceof s.dia.ElementView},embeddingMode:false,validateEmbedding:function(t,e){return true},findParentBy:"bbox",frontParentOnly:true,interactive:{labelMove:false},linkPinning:true,allowLink:null,clickThreshold:0,moveThreshold:0,cellViewNamespace:s.shapes,highlighterNamespace:s.highlighters},events:{dblclick:"pointerdblclick",click:"pointerclick",touchend:"pointerclick",contextmenu:"contextmenu",mousedown:"pointerdown",touchstart:"pointerdown",mouseover:"mouseover",mouseout:"mouseout",mouseenter:"mouseenter",mouseleave:"mouseleave",mousewheel:"mousewheel",DOMMouseScroll:"mousewheel","mouseenter .joint-cell":"mouseenter","mouseleave .joint-cell":"mouseleave","mouseenter .joint-tools":"mouseenter","mouseleave .joint-tools":"mouseleave","mousedown .joint-cell [event]":"onevent","touchstart .joint-cell [event]":"onevent","mousedown .joint-cell [magnet]":"onmagnet","touchstart .joint-cell [magnet]":"onmagnet","mousedown .joint-link .label":"onlabel","touchstart .joint-link .label":"onlabel","dragstart .joint-cell image":"onImageDragStart"},documentEvents:{mousemove:"pointermove",touchmove:"pointermove",mouseup:"pointerup",touchend:"pointerup",touchcancel:"pointerup"},_highlights:{},init:function(){s.util.bindAll(this,"pointerup");var t=this.model=this.options.model||new s.dia.Graph;this.setGrid(this.options.drawGrid);this.cloneOptions();this.render();this.setDimensions();this.listenTo(t,"add",this.onCellAdded).listenTo(t,"remove",this.removeView).listenTo(t,"reset",this.resetViews).listenTo(t,"sort",this._onSort).listenTo(t,"batch:stop",this._onBatchStop);this.on("cell:highlight",this.onCellHighlight).on("cell:unhighlight",this.onCellUnhighlight).on("scale translate",this.update);this._mousemoved=0;this._views={};this.$document=r(this.el.ownerDocument)},cloneOptions:function(){var t=this.options;t.origin=s.util.assign({},t.origin);t.defaultConnector=s.util.assign({},t.defaultConnector);t.highlighting=s.util.defaultsDeep({},t.highlighting,this.constructor.prototype.options.highlighting)},render:function(){this.$el.empty();this.svg=a("svg").attr({width:"100%",height:"100%"}).node;this.viewport=a("g").addClass(s.util.addClassNamePrefix("viewport")).node;this.defs=a("defs").node;this.tools=a("g").addClass(s.util.addClassNamePrefix("tools-container")).node;a(this.svg).append([this.defs,this.viewport,this.tools]);this.$background=r("<div/>").addClass(s.util.addClassNamePrefix("paper-background"));if(this.options.background){this.drawBackground(this.options.background)}this.$grid=r("<div/>").addClass(s.util.addClassNamePrefix("paper-grid"));if(this.options.drawGrid){this.drawGrid()}this.$el.append(this.$background,this.$grid,this.svg);return this},update:function(){if(this.options.drawGrid){this.drawGrid()}if(this._background){this.updateBackgroundImage(this._background)}return this},_viewportMatrix:null,_viewportTransformString:null,matrix:function(t){var e=this.viewport;if(t===undefined){var i=e.getAttribute("transform");if((this._viewportTransformString||null)===i){t=this._viewportMatrix}else{t=e.getCTM();this._viewportMatrix=t;this._viewportTransformString=i}return a.createSVGMatrix(t)}t=a.createSVGMatrix(t);ctmString=a.matrixToTransformString(t);e.setAttribute("transform",ctmString);this.tools.setAttribute("transform",ctmString);this._viewportMatrix=t;this._viewportTransformString=e.getAttribute("transform");return this},clientMatrix:function(){return a.createSVGMatrix(this.viewport.getScreenCTM())},_sortDelayingBatches:["add","to-front","to-back"],_onSort:function(){if(!this.model.hasActiveBatch(this._sortDelayingBatches)){this.sortViews()}},_onBatchStop:function(t){var e=t&&t.batchName;if(this._sortDelayingBatches.includes(e)&&!this.model.hasActiveBatch(this._sortDelayingBatches)){this.sortViews()}},onRemove:function(){this.removeViews()},setDimensions:function(t,e){t=this.options.width=t||this.options.width;e=this.options.height=e||this.options.height;this.$el.css({width:Math.round(t),height:Math.round(e)});this.trigger("resize",t,e)},setOrigin:function(t,e){return this.translate(t||0,e||0,{absolute:true})},fitToContent:function(t,e,i,r){if(s.util.isObject(t)){r=t;t=r.gridWidth||1;e=r.gridHeight||1;i=r.padding||0}else{r=r||{};t=t||1;e=e||1;i=i||0}i=s.util.normalizeSides(i);var n=a(this.viewport).getBBox();var o=this.scale();var l=this.translate();n.x*=o.sx;n.y*=o.sy;n.width*=o.sx;n.height*=o.sy;var c=Math.max(Math.ceil((n.width+n.x)/t),1)*t;var u=Math.max(Math.ceil((n.height+n.y)/e),1)*e;var g=0;var h=0;if(r.allowNewOrigin=="negative"&&n.x<0||r.allowNewOrigin=="positive"&&n.x>=0||r.allowNewOrigin=="any"){g=Math.ceil(-n.x/t)*t;g+=i.left;c+=g}if(r.allowNewOrigin=="negative"&&n.y<0||r.allowNewOrigin=="positive"&&n.y>=0||r.allowNewOrigin=="any"){h=Math.ceil(-n.y/e)*e;h+=i.top;u+=h}c+=i.right;u+=i.bottom;c=Math.max(c,r.minWidth||0);u=Math.max(u,r.minHeight||0);c=Math.min(c,r.maxWidth||Number.MAX_VALUE);u=Math.min(u,r.maxHeight||Number.MAX_VALUE);var d=c!=this.options.width||u!=this.options.height;var f=g!=l.tx||h!=l.ty;if(f){this.translate(g,h)}if(d){this.setDimensions(c,u)}},scaleContentToFit:function(t){var e=this.getContentBBox();if(!e.width||!e.height)return;t=t||{};s.util.defaults(t,{padding:0,preserveAspectRatio:true,scaleGrid:null,minScale:0,maxScale:Number.MAX_VALUE});var i=t.padding;var r=t.minScaleX||t.minScale;var a=t.maxScaleX||t.maxScale;var o=t.minScaleY||t.minScale;var l=t.maxScaleY||t.maxScale;var c;if(t.fittingBBox){c=t.fittingBBox}else{var u=this.translate();c={x:u.tx,y:u.ty,width:this.options.width,height:this.options.height}}c=n.rect(c).moveAndExpand({x:i,y:i,width:-2*i,height:-2*i});var g=this.scale();var h=c.width/e.width*g.sx;var d=c.height/e.height*g.sy;if(t.preserveAspectRatio){h=d=Math.min(h,d)}if(t.scaleGrid){var f=t.scaleGrid;h=f*Math.floor(h/f);d=f*Math.floor(d/f)}h=Math.min(a,Math.max(r,h));d=Math.min(l,Math.max(o,d));this.scale(h,d);var v=this.getContentBBox();var p=c.x-v.x;var I=c.y-v.y;this.translate(p,I)},getContentArea:function(){return a(this.viewport).getBBox()},getContentBBox:function(){var t=this.viewport.getBoundingClientRect();var e=this.clientMatrix();var i=this.translate();return n.rect({x:t.left-e.e+i.tx,y:t.top-e.f+i.ty,width:t.width,height:t.height})},getArea:function(){return this.paperToLocalRect({x:0,y:0,width:this.options.width,height:this.options.height})},getRestrictedArea:function(){var t;if(s.util.isFunction(this.options.restrictTranslate)){t=this.options.restrictTranslate.apply(this,arguments)}else if(this.options.restrictTranslate===true){t=this.getArea()}else{t=this.options.restrictTranslate||null}return t},createViewForModel:function(t){var i;var r;var n=this.options.cellViewNamespace;var a=t.get("type")+"View";var o=s.util.getByPath(n,a,".");if(t.isLink()){i=this.options.linkView;r=s.dia.LinkView}else{i=this.options.elementView;r=s.dia.ElementView}var l=i.prototype instanceof e.View?o||i:i.call(this,t)||o||r;return new l({model:t,interactive:this.options.interactive})},onCellAdded:function(t,e,i){if(this.options.async&&i.async!==false&&s.util.isNumber(i.position)){this._asyncCells=this._asyncCells||[];this._asyncCells.push(t);if(i.position==0){if(this._frameId)throw new Error("another asynchronous rendering in progress");this.asyncRenderViews(this._asyncCells,i);delete this._asyncCells}}else{this.renderView(t)}},removeView:function(t){var e=this._views[t.id];if(e){e.remove();delete this._views[t.id]}return e},renderView:function(t){var e=this._views[t.id]=this.createViewForModel(t);a(this.viewport).append(e.el);e.paper=this;e.render();return e},onImageDragStart:function(){return false},beforeRenderViews:function(t){t.sort(function(t){return t.isLink()?1:-1});return t},afterRenderViews:function(){this.sortViews()},resetViews:function(t,e){this.removeViews();var i=t.models.slice();i=this.beforeRenderViews(i,e)||i;this.cancelRenderViews();if(this.options.async){this.asyncRenderViews(i,e)}else{for(var r=0,n=i.length;r<n;r++){this.renderView(i[r])}this.sortViews()}},cancelRenderViews:function(){if(this._frameId){s.util.cancelFrame(this._frameId);delete this._frameId}},removeViews:function(){s.util.invoke(this._views,"remove");this._views={}},asyncBatchAdded:s.util.noop,asyncRenderViews:function(t,e){if(this._frameId){var i=this.options.async&&this.options.async.batchSize||50;var r=t.splice(0,i);r.forEach(function(t){if(t.graph===this.model)this.renderView(t)},this);this.asyncBatchAdded()}if(!t.length){delete this._frameId;this.afterRenderViews(e);this.trigger("render:done",e)}else{this._frameId=s.util.nextFrame(function(){this.asyncRenderViews(t,e)},this)}},sortViews:function(){var t=r(this.viewport).children("[model-id]");var e=this.model.get("cells");s.util.sortElements(t,function(t,i){var n=e.get(r(t).attr("model-id"));var a=e.get(r(i).attr("model-id"));return(n.get("z")||0)>(a.get("z")||0)?1:-1})},scale:function(t,e,i,r){if(t===undefined){return a.matrixToScale(this.matrix())}if(e===undefined){e=t}if(i===undefined){i=0;r=0}var n=this.translate();if(i||r||n.tx||n.ty){var o=n.tx-i*(t-1);var s=n.ty-r*(e-1);this.translate(o,s)}var l=this.matrix();l.a=t||0;l.d=e||0;this.matrix(l);this.trigger("scale",t,e,i,r);return this},rotate:function(t,e,i){if(t===undefined){return a.matrixToRotate(this.matrix())}if(e===undefined){var r=this.viewport.getBBox();e=r.width/2;i=r.height/2}var n=this.matrix().translate(e,i).rotate(t).translate(-e,-i);this.matrix(n);return this},translate:function(t,e){if(t===undefined){return a.matrixToTranslate(this.matrix())}var i=this.matrix();i.e=t||0;i.f=e||0;this.matrix(i);var r=this.translate();var n=this.options.origin;n.x=r.tx;n.y=r.ty;this.trigger("translate",r.tx,r.ty);if(this.options.drawGrid){this.drawGrid()}return this},findView:function(t){var e=s.util.isString(t)?this.viewport.querySelector(t):t instanceof r?t[0]:t;while(e&&e!==this.el&&e!==document){var i=e.getAttribute("model-id");if(i)return this._views[i];e=e.parentNode}return undefined},findViewByModel:function(t){var e=s.util.isString(t)||s.util.isNumber(t)?t:t&&t.id;return this._views[e]},findViewsFromPoint:function(t){t=n.point(t);var e=this.model.getElements().map(this.findViewByModel,this);return e.filter(function(e){return e&&e.vel.getBBox({target:this.viewport}).containsPoint(t)},this)},findViewsInArea:function(t,e){e=s.util.defaults(e||{},{strict:false});t=n.rect(t);var i=this.model.getElements().map(this.findViewByModel,this);var r=e.strict?"containsRect":"intersect";return i.filter(function(e){return e&&t[r](e.vel.getBBox({target:this.viewport}))},this)},removeTools:function(){s.dia.CellView.dispatchToolsEvent(this,"remove");return this},hideTools:function(){s.dia.CellView.dispatchToolsEvent(this,"hide");return this},showTools:function(){s.dia.CellView.dispatchToolsEvent(this,"show");return this},getModelById:function(t){return this.model.getCell(t)},snapToGrid:function(t,e){return this.clientToLocalPoint(t,e).snapToGrid(this.options.gridSize)},localToPaperPoint:function(t,e){var i=n.Point(t,e);var r=a.transformPoint(i,this.matrix());return n.Point(r)},localToPaperRect:function(t,e,i,r){var o=n.Rect(t,e);var s=a.transformRect(o,this.matrix());return n.Rect(s)},paperToLocalPoint:function(t,e){var i=n.Point(t,e);var r=a.transformPoint(i,this.matrix().inverse());return n.Point(r)},paperToLocalRect:function(t,e,i,r){var o=n.Rect(t,e,i,r);var s=a.transformRect(o,this.matrix().inverse());return n.Rect(s)},localToClientPoint:function(t,e){var i=n.Point(t,e);var r=a.transformPoint(i,this.clientMatrix());return n.Point(r)},localToClientRect:function(t,e,i,r){var o=n.Rect(t,e,i,r);var s=a.transformRect(o,this.clientMatrix());return n.Rect(s)},clientToLocalPoint:function(t,e){var i=n.Point(t,e);var r=a.transformPoint(i,this.clientMatrix().inverse());return n.Point(r)},clientToLocalRect:function(t,e,i,r){var o=n.Rect(t,e,i,r);var s=a.transformRect(o,this.clientMatrix().inverse());return n.Rect(s)},localToPagePoint:function(t,e){return this.localToPaperPoint(t,e).offset(this.pageOffset())},localToPageRect:function(t,e,i,r){return this.localToPaperRect(t,e,i,r).moveAndExpand(this.pageOffset())},pageToLocalPoint:function(t,e){var i=n.Point(t,e);var r=i.difference(this.pageOffset());return this.paperToLocalPoint(r)},pageToLocalRect:function(t,e,i,r){var a=this.pageOffset();var o=n.Rect(t,e,i,r);o.x-=a.x;o.y-=a.y;return this.paperToLocalRect(o)},clientOffset:function(){var t=this.svg.getBoundingClientRect();return n.Point(t.left,t.top)},pageOffset:function(){return this.clientOffset().offset(window.scrollX,window.scrollY)},linkAllowed:function(t){if(!(t instanceof s.dia.LinkView)){throw new Error("Must provide a linkView.")}var e=t.model;var i=this.options;var r=this.model;var n=r.constructor.validations;if(!i.multiLinks){if(!n.multiLinks.call(this,r,e))return false}if(!i.linkPinning){if(!n.linkPinning.call(this,r,e))return false}if(typeof i.allowLink==="function"){if(!i.allowLink.call(this,t,this))return false}return true},getDefaultLink:function(t,e){return s.util.isFunction(this.options.defaultLink)?this.options.defaultLink.call(this,t,e):this.options.defaultLink.clone()},resolveHighlighter:function(t){t=t||{};var e=t.highlighter;var i=this.options;if(e===undefined){var r=["embedding","connecting","magnetAvailability","elementAvailability"].find(function(e){return!!t[e]});e=r&&i.highlighting[r]||i.highlighting["default"]}if(!e)return false;if(s.util.isString(e)){e={name:e}}var n=e.name;var a=i.highlighterNamespace[n];if(!a){throw new Error('Unknown highlighter ("'+n+'")')}if(typeof a.highlight!=="function"){throw new Error('Highlighter ("'+n+'") is missing required highlight() method')}if(typeof a.unhighlight!=="function"){throw new Error('Highlighter ("'+n+'") is missing required unhighlight() method')}return{highlighter:a,options:e.options||{},name:n}},onCellHighlight:function(t,e,i){i=this.resolveHighlighter(i);if(!i)return;if(!e.id){e.id=a.uniqueId()}var r=i.name+e.id+JSON.stringify(i.options);if(!this._highlights[r]){var n=i.highlighter;n.highlight(t,e,s.util.assign({},i.options));this._highlights[r]={cellView:t,magnetEl:e,opt:i.options,highlighter:n}}},onCellUnhighlight:function(t,e,i){i=this.resolveHighlighter(i);if(!i)return;var r=i.name+e.id+JSON.stringify(i.options);var n=this._highlights[r];if(n){n.highlighter.unhighlight(n.cellView,n.magnetEl,n.opt);this._highlights[r]=null}},pointerdblclick:function(t){t.preventDefault();t=s.util.normalizeEvent(t);var e=this.findView(t.target);if(this.guard(t,e))return;var i=this.snapToGrid({x:t.clientX,y:t.clientY});if(e){e.pointerdblclick(t,i.x,i.y)}else{this.trigger("blank:pointerdblclick",t,i.x,i.y)}},pointerclick:function(t){if(this._mousemoved<=this.options.clickThreshold){t=s.util.normalizeEvent(t);var e=this.findView(t.target);if(this.guard(t,e))return;var i=this.snapToGrid({x:t.clientX,y:t.clientY});if(e){e.pointerclick(t,i.x,i.y)}else{this.trigger("blank:pointerclick",t,i.x,i.y)}}},contextmenu:function(t){if(this.options.preventContextMenu)t.preventDefault();t=s.util.normalizeEvent(t);var e=this.findView(t.target);if(this.guard(t,e))return;var i=this.snapToGrid({x:t.clientX,y:t.clientY});if(e){e.contextmenu(t,i.x,i.y)}else{this.trigger("blank:contextmenu",t,i.x,i.y)}},pointerdown:function(t){t=s.util.normalizeEvent(t);var e=this.findView(t.target);if(this.guard(t,e))return;var i=this.snapToGrid({x:t.clientX,y:t.clientY});if(e){t.preventDefault();e.pointerdown(t,i.x,i.y)}else{if(this.options.preventDefaultBlankAction)t.preventDefault();this.trigger("blank:pointerdown",t,i.x,i.y)}this.delegateDragEvents(e,t.data)},pointermove:function(t){t.preventDefault();var e=this.eventData(t);e.mousemoved||(e.mousemoved=0);var i=++e.mousemoved;if(i<=this.options.moveThreshold)return;t=s.util.normalizeEvent(t);var r=this.snapToGrid({x:t.clientX,y:t.clientY});var n=e.sourceView;if(n){n.pointermove(t,r.x,r.y)}else{this.trigger("blank:pointermove",t,r.x,r.y)}this.eventData(t,e)},pointerup:function(t){this.undelegateDocumentEvents();t=s.util.normalizeEvent(t);var e=this.snapToGrid({x:t.clientX,y:t.clientY});var i=this.eventData(t).sourceView;if(i){i.pointerup(t,e.x,e.y)}else{this.trigger("blank:pointerup",t,e.x,e.y)}this.delegateEvents()},mouseover:function(t){t=s.util.normalizeEvent(t);var e=this.findView(t.target);if(this.guard(t,e))return;if(e){e.mouseover(t)}else{if(this.el===t.target)return;this.trigger("blank:mouseover",t)}},mouseout:function(t){t=s.util.normalizeEvent(t);var e=this.findView(t.target);if(this.guard(t,e))return;if(e){e.mouseout(t)}else{if(this.el===t.target)return;this.trigger("blank:mouseout",t)}},mouseenter:function(t){t=s.util.normalizeEvent(t);var e=this.findView(t.target);if(this.guard(t,e))return;var i=this.findView(t.relatedTarget);if(e){if(i===e)return;e.mouseenter(t)}else{if(i)return;this.trigger("paper:mouseenter",t)}},mouseleave:function(t){t=s.util.normalizeEvent(t);var e=this.findView(t.target);if(this.guard(t,e))return;var i=this.findView(t.relatedTarget);if(e){if(i===e)return;e.mouseleave(t)}else{if(i)return;this.trigger("paper:mouseleave",t)}},mousewheel:function(t){t=s.util.normalizeEvent(t);var e=this.findView(t.target);if(this.guard(t,e))return;var i=t.originalEvent;var r=this.snapToGrid({x:i.clientX,y:i.clientY});var n=Math.max(-1,Math.min(1,i.wheelDelta||-i.detail));if(e){e.mousewheel(t,r.x,r.y,n)}else{this.trigger("blank:mousewheel",t,r.x,r.y,n)}},onevent:function(t){var e=t.currentTarget;var i=e.getAttribute("event");if(i){var r=this.findView(e);if(r){t=s.util.normalizeEvent(t);if(this.guard(t,r))return;var n=this.snapToGrid({x:t.clientX,y:t.clientY});r.onevent(t,i,n.x,n.y)}}},onmagnet:function(t){var e=t.currentTarget;var i=e.getAttribute("magnet");if(i){var r=this.findView(e);if(r){t=s.util.normalizeEvent(t);if(this.guard(t,r))return;if(!this.options.validateMagnet(r,e))return;var n=this.snapToGrid(t.clientX,t.clientY);r.onmagnet(t,n.x,n.y)}}},onlabel:function(t){var e=t.currentTarget;var i=this.findView(e);if(i){t=s.util.normalizeEvent(t);if(this.guard(t,i))return;var r=this.snapToGrid(t.clientX,t.clientY);i.onlabel(t,r.x,r.y)}},delegateDragEvents:function(t,e){e||(e={});this.eventData({data:e},{sourceView:t||null,mousemoved:0});this.delegateDocumentEvents(null,e);this.undelegateEvents()},guard:function(t,e){if(this.options.guard&&this.options.guard(t,e)){return true}if(t.data&&t.data.guarded!==undefined){return t.data.guarded}if(e&&e.model&&e.model instanceof s.dia.Cell){return false}if(this.svg===t.target||this.el===t.target||r.contains(this.svg,t.target)){return false}return true},setGridSize:function(t){this.options.gridSize=t;if(this.options.drawGrid){this.drawGrid()}return this},clearGrid:function(){if(this.$grid){this.$grid.css("backgroundImage","none")}return this},_getGriRefs:function(){if(!this._gridCache){this._gridCache={root:a("svg",{width:"100%",height:"100%"},a("defs")),patterns:{},add:function(t,e){a(this.root.node.childNodes[0]).append(e);this.patterns[t]=e;this.root.append(a("rect",{width:"100%",height:"100%",fill:"url(#"+t+")"}))},get:function(t){return this.patterns[t]},exist:function(t){return this.patterns[t]!==undefined}}}return this._gridCache},setGrid:function(t){this.clearGrid();this._gridCache=null;this._gridSettings=[];var e=Array.isArray(t)?t:[t||{}];e.forEach(function(t){this._gridSettings.push.apply(this._gridSettings,this._resolveDrawGridOption(t))},this);return this},_resolveDrawGridOption:function(t){var e=this.constructor.gridPatterns;if(s.util.isString(t)&&Array.isArray(e[t])){return e[t].map(function(t){return s.util.assign({},t)})}var i=t||{args:[{}]};var r=Array.isArray(i);var n=i.name;if(!r&&!n&&!i.markup){n="dot"}if(n&&Array.isArray(e[n])){var a=e[n].map(function(t){return s.util.assign({},t)});var o=Array.isArray(i.args)?i.args:[i.args||{}];s.util.defaults(o[0],s.util.omit(t,"args"));for(var l=0;l<o.length;l++){if(a[l]){s.util.assign(a[l],o[l])}}return a}return r?i:[i]},drawGrid:function(t){var e=this.options.gridSize;if(e<=1){return this.clearGrid()}var i=Array.isArray(t)?t:[t];var r=this.matrix();var n=this._getGriRefs();this._gridSettings.forEach(function(t,o){var l="pattern_"+o;var c=s.util.merge(t,i[o],{sx:r.a||1,sy:r.d||1,ox:r.e||0,oy:r.f||0});c.width=e*(r.a||1)*(c.scaleFactor||1);c.height=e*(r.d||1)*(c.scaleFactor||1);if(!n.exist(l)){n.add(l,a("pattern",{id:l,patternUnits:"userSpaceOnUse"},a(c.markup)))}var u=n.get(l);if(s.util.isFunction(c.update)){c.update(u.node.childNodes[0],c)}var g=c.ox%c.width;if(g<0)g+=c.width;var h=c.oy%c.height;if(h<0)h+=c.height;u.attr({x:g,y:h,width:c.width,height:c.height})});var o=(new XMLSerializer).serializeToString(n.root.node);o="url(data:image/svg+xml;base64,"+btoa(o)+")";this.$grid.css("backgroundImage",o);return this},updateBackgroundImage:function(t){t=t||{};var e=t.position||"center";var i=t.size||"auto auto";var r=this.scale();var a=this.translate();if(s.util.isObject(e)){var o=a.tx+r.sx*(e.x||0);var l=a.ty+r.sy*(e.y||0);e=o+"px "+l+"px"}if(s.util.isObject(i)){i=n.rect(i).scale(r.sx,r.sy);i=i.width+"px "+i.height+"px"}this.$background.css({backgroundSize:i,backgroundPosition:e})},drawBackgroundImage:function(t,e){if(!(t instanceof HTMLImageElement)){this.$background.css("backgroundImage","");return}e=e||{};var i;var r=e.size;var n=e.repeat||"no-repeat";var a=e.opacity||1;var o=Math.abs(e.quality)||1;var l=this.constructor.backgroundPatterns[s.util.camelCase(n)];if(s.util.isFunction(l)){t.width*=o;t.height*=o;var c=l(t,e);if(!(c instanceof HTMLCanvasElement)){throw new Error("dia.Paper: background pattern must return an HTML Canvas instance")}i=c.toDataURL("image/png");n="repeat";if(s.util.isObject(r)){r.width*=c.width/t.width;r.height*=c.height/t.height}else if(r===undefined){e.size={width:c.width/o,height:c.height/o}}}else{i=t.src;if(r===undefined){e.size={width:t.width,height:t.height}}}this.$background.css({opacity:a,backgroundRepeat:n,backgroundImage:"url("+i+")"});this.updateBackgroundImage(e)},updateBackgroundColor:function(t){this.$el.css("backgroundColor",t||"")},drawBackground:function(t){t=t||{};this.updateBackgroundColor(t.color);if(t.image){t=this._background=s.util.cloneDeep(t);var e=document.createElement("img");e.onload=this.drawBackgroundImage.bind(this,e,t);e.src=t.image}else{this.drawBackgroundImage(null);this._background=null}return this},setInteractivity:function(t){this.options.interactive=t;s.util.invoke(this._views,"setInteractivity",t)},isDefined:function(t){return!!this.svg.getElementById(t)},defineFilter:function(t){if(!s.util.isObject(t)){throw new TypeError("dia.Paper: defineFilter() requires 1. argument to be an object.")}var e=t.id;var i=t.name;if(!e){e=i+this.svg.id+s.util.hashCode(JSON.stringify(t))}if(!this.isDefined(e)){var r=s.util.filter;var n=r[i]&&r[i](t.args||{});if(!n){throw new Error("Non-existing filter "+i)}var o=s.util.assign({filterUnits:"objectBoundingBox",x:-1,y:-1,width:3,height:3},t.attrs,{id:e});a(n,o).appendTo(this.defs)}return e},defineGradient:function(t){if(!s.util.isObject(t)){throw new TypeError("dia.Paper: defineGradient() requires 1. argument to be an object.")}var e=t.id;var i=t.type;var r=t.stops;if(!e){e=i+this.svg.id+s.util.hashCode(JSON.stringify(t))}if(!this.isDefined(e)){var n=s.util.template('<stop offset="${offset}" stop-color="${color}" stop-opacity="${opacity}"/>');var o=s.util.toArray(r).map(function(t){return n({offset:t.offset,color:t.color,opacity:Number.isFinite(t.opacity)?t.opacity:1})});var l=["<"+i+">",o.join(""),"</"+i+">"].join("");var c=s.util.assign({id:e},t.attrs);a(l,c).appendTo(this.defs)}return e},defineMarker:function(t){if(!s.util.isObject(t)){throw new TypeError("dia.Paper: defineMarker() requires 1. argument to be an object.")}var e=t.id;if(!e){e=this.svg.id+s.util.hashCode(JSON.stringify(t))}if(!this.isDefined(e)){var i=s.util.omit(t,"type","userSpaceOnUse");var r=a("marker",{id:e,orient:"auto",overflow:"visible",markerUnits:t.markerUnits||"userSpaceOnUse"},[a(t.type||"path",i)]);r.appendTo(this.defs)}return e}},{backgroundPatterns:{flipXy:function(t){var e=document.createElement("canvas");var i=t.width;var r=t.height;e.width=2*i;e.height=2*r;var n=e.getContext("2d");n.drawImage(t,0,0,i,r);n.setTransform(-1,0,0,-1,e.width,e.height);n.drawImage(t,0,0,i,r);n.setTransform(-1,0,0,1,e.width,0);n.drawImage(t,0,0,i,r);n.setTransform(1,0,0,-1,0,e.height);n.drawImage(t,0,0,i,r);return e},flipX:function(t){var e=document.createElement("canvas");var i=t.width;var r=t.height;e.width=i*2;e.height=r;var n=e.getContext("2d");n.drawImage(t,0,0,i,r);n.translate(2*i,0);n.scale(-1,1);n.drawImage(t,0,0,i,r);return e},flipY:function(t){var e=document.createElement("canvas");var i=t.width;var r=t.height;e.width=i;e.height=r*2;var n=e.getContext("2d");n.drawImage(t,0,0,i,r);n.translate(0,2*r);n.scale(1,-1);n.drawImage(t,0,0,i,r);return e},watermark:function(t,e){e=e||{};var i=t.width;var r=t.height;var a=document.createElement("canvas");a.width=i*3;a.height=r*3;var o=a.getContext("2d");var l=s.util.isNumber(e.watermarkAngle)?-e.watermarkAngle:-20;var c=n.toRad(l);var u=a.width/4;var g=a.height/4;for(var h=0;h<4;h++){for(var d=0;d<4;d++){if((h+d)%2>0){o.setTransform(1,0,0,1,(2*h-1)*u,(2*d-1)*g);o.rotate(c);o.drawImage(t,-i/2,-r/2,i,r)}}}return a}},gridPatterns:{dot:[{color:"#AAAAAA",thickness:1,markup:"rect",update:function(t,e){a(t).attr({width:e.thickness*e.sx,height:e.thickness*e.sy,fill:e.color})}}],fixedDot:[{color:"#AAAAAA",thickness:1,markup:"rect",update:function(t,e){var i=e.sx<=1?e.thickness*e.sx:e.thickness;a(t).attr({width:i,height:i,fill:e.color})}}],mesh:[{color:"#AAAAAA",thickness:1,markup:"path",update:function(t,e){var i;var r=e.width;var n=e.height;var o=e.thickness;if(r-o>=0&&n-o>=0){i=["M",r,0,"H0 M0 0 V0",n].join(" ")}else{i="M 0 0 0 0"}a(t).attr({d:i,stroke:e.color,"stroke-width":e.thickness})}}],doubleMesh:[{color:"#AAAAAA",thickness:1,markup:"path",update:function(t,e){var i;var r=e.width;var n=e.height;var o=e.thickness;if(r-o>=0&&n-o>=0){i=["M",r,0,"H0 M0 0 V0",n].join(" ")}else{i="M 0 0 0 0"}a(t).attr({d:i,stroke:e.color,"stroke-width":e.thickness})}},{color:"#000000",thickness:3,scaleFactor:4,markup:"path",update:function(t,e){var i;var r=e.width;var n=e.height;var o=e.thickness;if(r-o>=0&&n-o>=0){i=["M",r,0,"H0 M0 0 V0",n].join(" ")}else{i="M 0 0 0 0"}a(t).attr({d:i,stroke:e.color,"stroke-width":e.thickness})}}]}});(function(t,e,i){var r=function(e){var r=i.cloneDeep(e)||{};this.ports=[];this.groups={};this.portLayoutNamespace=t.layout.Port;this.portLabelLayoutNamespace=t.layout.PortLabel;this._init(r)};r.prototype={getPorts:function(){return this.ports},getGroup:function(t){return this.groups[t]||{}},getPortsByGroup:function(t){return this.ports.filter(function(e){return e.group===t})},getGroupPortsMetrics:function(t,e){var r=this.getGroup(t);var a=this.getPortsByGroup(t);var o=r.position||{};var s=o.name;var l=this.portLayoutNamespace;if(!l[s]){s="left"}var c=o.args||{};var u=a.map(function(t){return t&&t.position&&t.position.args});var g=l[s](u,e,c);var h={ports:a,result:[]};i.toArray(g).reduce(function(t,i,r){var a=t.ports[r];t.result.push({portId:a.id,portTransformation:i,labelTransformation:this._getPortLabelLayout(a,n.Point(i),e),portAttrs:a.attrs,portSize:a.size,labelSize:a.label.size});return t}.bind(this),h);return h.result},_getPortLabelLayout:function(t,e,i){var r=this.portLabelLayoutNamespace;var n=t.label.position.name||"left";if(r[n]){return r[n](e,i,t.label.position.args)}return null},_init:function(t){if(i.isObject(t.groups)){var e=Object.keys(t.groups);for(var r=0,n=e.length;r<n;r++){var a=e[r];this.groups[a]=this._evaluateGroup(t.groups[a])}}var o=i.toArray(t.items);for(var s=0,l=o.length;s<l;s++){this.ports.push(this._evaluatePort(o[s]))}},_evaluateGroup:function(t){return i.merge(t,{position:this._getPosition(t.position,true),label:this._getLabel(t,true)})},_evaluatePort:function(t){var e=i.assign({},t);var r=this.getGroup(t.group);e.markup=e.markup||r.markup;e.attrs=i.merge({},r.attrs,e.attrs);e.position=this._createPositionNode(r,e);e.label=i.merge({},r.label,this._getLabel(e));e.z=this._getZIndex(r,e);e.size=i.assign({},r.size,e.size);return e},_getZIndex:function(t,e){if(i.isNumber(e.z)){return e.z}if(i.isNumber(t.z)||t.z==="auto"){return t.z}return"auto"},_createPositionNode:function(t,e){return i.merge({name:"left",args:{}},t.position,{args:e.args})},_getPosition:function(t,e){var r={};var n;if(i.isFunction(t)){n="fn";r.fn=t}else if(i.isString(t)){n=t}else if(t===undefined){n=e?"left":null}else if(Array.isArray(t)){n="absolute";r.x=t[0];r.y=t[1]}else if(i.isObject(t)){n=t.name;i.assign(r,t.args)}var a={args:r};if(n){a.name=n}return a},_getLabel:function(t,e){var i=t.label||{};var r=i;r.position=this._getPosition(i.position,e);return r}};i.assign(t.dia.Element.prototype,{_initializePorts:function(){this._createPortData();this.on("change:ports",function(){this._processRemovedPort();this._createPortData()},this)},_processRemovedPort:function(){var t=this.get("ports")||{};var e={};i.toArray(t.items).forEach(function(t){e[t.id]=true});var r=this.previous("ports")||{};var n={};i.toArray(r.items).forEach(function(t){if(!e[t.id]){n[t.id]=true}});var a=this.graph;if(a&&!i.isEmpty(n)){var o=a.getConnectedLinks(this,{inbound:true});o.forEach(function(t){if(n[t.get("target").port])t.remove()});var s=a.getConnectedLinks(this,{outbound:true});s.forEach(function(t){if(n[t.get("source").port])t.remove()})}},hasPorts:function(){return this.prop("ports/items").length>0},hasPort:function(t){return this.getPortIndex(t)!==-1},getPorts:function(){return i.cloneDeep(this.prop("ports/items"))||[]},getPort:function(t){return i.cloneDeep(i.toArray(this.prop("ports/items")).find(function(e){return e.id&&e.id===t}))},getPortsPositions:function(t){var e=this._portSettingsData.getGroupPortsMetrics(t,n.Rect(this.size()));return e.reduce(function(t,e){var i=e.portTransformation;t[e.portId]={x:i.x,y:i.y,angle:i.angle};return t},{})},getPortIndex:function(t){var e=i.isObject(t)?t.id:t;if(!this._isValidPortId(e)){return-1}return i.toArray(this.prop("ports/items")).findIndex(function(t){return t.id===e})},addPort:function(t,e){if(!i.isObject(t)||Array.isArray(t)){throw new Error("Element: addPort requires an object.")}var r=i.assign([],this.prop("ports/items"));r.push(t);this.prop("ports/items",r,e);return this},portProp:function(t,e,r,n){var a=this.getPortIndex(t);if(a===-1){throw new Error("Element: unable to find port with id "+t)}var o=Array.prototype.slice.call(arguments,1);if(Array.isArray(e)){o[0]=["ports","items",a].concat(e)}else if(i.isString(e)){o[0]=["ports/items/",a,"/",e].join("")}else{o=["ports/items/"+a];if(i.isPlainObject(e)){o.push(e);o.push(r)}}return this.prop.apply(this,o)},_validatePorts:function(){var e=this.get("ports")||{};var r=[];e=e||{};var n=i.toArray(e.items);n.forEach(function(t){if(typeof t!=="object"){r.push("Element: invalid port ",t)}if(!this._isValidPortId(t.id)){t.id=i.uuid()}},this);if(t.util.uniq(n,"id").length!==n.length){r.push("Element: found id duplicities in ports.")}return r},_isValidPortId:function(t){return t!==null&&t!==undefined&&!i.isObject(t)},addPorts:function(t,e){if(t.length){this.prop("ports/items",i.assign([],this.prop("ports/items")).concat(t),e)}return this},removePort:function(t,e){var r=e||{};var n=i.assign([],this.prop("ports/items"));var a=this.getPortIndex(t);if(a!==-1){n.splice(a,1);r.rewrite=true;this.prop("ports/items",n,r)}return this},_createPortData:function(){var t=this._validatePorts();if(t.length>0){this.set("ports",this.previous("ports"));throw new Error(t.join(" "))}var e;if(this._portSettingsData){e=this._portSettingsData.getPorts()}this._portSettingsData=new r(this.get("ports"));var i=this._portSettingsData.getPorts();if(e){var n=i.filter(function(t){if(!e.find(function(e){return e.id===t.id})){return t}});var a=e.filter(function(t){if(!i.find(function(e){return e.id===t.id})){return t}});if(a.length>0){this.trigger("ports:remove",this,a)}if(n.length>0){this.trigger("ports:add",this,n)}}}});i.assign(t.dia.ElementView.prototype,{portContainerMarkup:"g",portMarkup:[{tagName:"circle",selector:"circle",attributes:{r:10,fill:"#FFFFFF",stroke:"#000000"}}],portLabelMarkup:[{tagName:"text",selector:"text",attributes:{fill:"#000000"}}],_portElementsCache:null,_initializePorts:function(){this._portElementsCache={};this.listenTo(this.model,"change:ports",function(){this._refreshPorts()})},_refreshPorts:function(){this._removePorts();this._portElementsCache={};this._renderPorts()},_renderPorts:function(){var t=[];var e=this._getContainerElement();for(var r=0,n=e.node.childNodes.length;r<n;r++){t.push(e.node.childNodes[r])}var a=i.groupBy(this.model._portSettingsData.getPorts(),"z");var o="auto";i.toArray(a[o]).forEach(function(i){var r=this._getPortElement(i);e.append(r);t.push(r)},this);var s=Object.keys(a);for(var l=0;l<s.length;l++){var c=s[l];if(c!==o){var u=parseInt(c,10);this._appendPorts(a[c],u,t)}}this._updatePorts()},_getContainerElement:function(){return this.rotatableNode||this.vel},_appendPorts:function(t,e,r){var n=this._getContainerElement();var o=i.toArray(t).map(this._getPortElement,this);if(r[e]||e<0){a(r[Math.max(e,0)]).before(o)}else{n.append(o)}},_getPortElement:function(t){if(this._portElementsCache[t.id]){return this._portElementsCache[t.id].portElement}return this._createPortElement(t)},findPortNode:function(t,e){var i=this._portElementsCache[t];if(!i)return null;var r=i.portContentElement.node;var n=i.portContentSelectors;return this.findBySelector(e,r,n)[0]},_updatePorts:function(){this._updatePortGroup(undefined);var t=Object.keys(this.model._portSettingsData.groups);t.forEach(this._updatePortGroup,this)},_removePorts:function(){i.invoke(this._portElementsCache,"portElement.remove")},_createPortElement:function(t){var e;var r;var n=this._getPortMarkup(t);var o;if(Array.isArray(n)){var s=i.parseDOMJSON(n);var l=s.fragment;if(l.childNodes.length>1){e=a("g").append(l)}else{e=a(l.firstChild)}o=s.selectors}else{e=a(n);if(Array.isArray(e)){e=a("g").append(e)}}if(!e){throw new Error("ElementView: Invalid port markup.")}e.attr({port:t.id,"port-group":t.group});var c=this._getPortLabelMarkup(t.label);var u;if(Array.isArray(c)){var g=i.parseDOMJSON(c);var h=g.fragment;if(h.childNodes.length>1){r=a("g").append(h)}else{r=a(h.firstChild)}u=g.selectors}else{r=a(c);if(Array.isArray(r)){r=a("g").append(r)}}if(!r){throw new Error("ElementView: Invalid port label markup.")}var d;if(o&&u){for(var f in u){if(o[f])throw new Error("ElementView: selectors within port must be unique.")}d=i.assign({},o,u)}else{d=o||u}var v=a(this.portContainerMarkup).addClass("joint-port").append([e.addClass("joint-port-body"),r.addClass("joint-port-label")]);this._portElementsCache[t.id]={portElement:v,portLabelElement:r,portSelectors:d,portLabelSelectors:u,portContentElement:e,portContentSelectors:o};return v},_updatePortGroup:function(t){var e=n.Rect(this.model.size());var i=this.model._portSettingsData.getGroupPortsMetrics(t,e);for(var r=0,a=i.length;r<a;r++){var o=i[r];var s=o.portId;var l=this._portElementsCache[s]||{};var c=o.portTransformation;this.applyPortTransform(l.portElement,c);this.updateDOMSubtreeAttributes(l.portElement.node,o.portAttrs,{rootBBox:new n.Rect(o.portSize),selectors:l.portSelectors});var u=o.labelTransformation;if(u){this.applyPortTransform(l.portLabelElement,u,-c.angle||0);this.updateDOMSubtreeAttributes(l.portLabelElement.node,u.attrs,{rootBBox:new n.Rect(o.labelSize),selectors:l.portLabelSelectors})}}},applyPortTransform:function(t,e,i){var r=a.createSVGMatrix().rotate(i||0).translate(e.x||0,e.y||0).rotate(e.angle||0);t.transform(r,{absolute:true})},_getPortMarkup:function(t){return t.markup||this.model.get("portMarkup")||this.model.portMarkup||this.portMarkup},_getPortLabelMarkup:function(t){return t.markup||this.model.get("portLabelMarkup")||this.model.portLabelMarkup||this.portLabelMarkup}})})(s,i,s.util);s.dia.Element.define("basic.Generic",{attrs:{".":{fill:"#ffffff",stroke:"none"}}});s.shapes.basic.Generic.define("basic.Rect",{attrs:{rect:{fill:"#ffffff",stroke:"#000000",width:100,height:60},text:{fill:"#000000",text:"","font-size":14,"ref-x":.5,"ref-y":.5,"text-anchor":"middle","y-alignment":"middle","font-family":"Arial, helvetica, sans-serif"}}},{markup:'<g class="rotatable"><g class="scalable"><rect/></g><text/></g>'});s.shapes.basic.TextView=s.dia.ElementView.extend({initialize:function(){s.dia.ElementView.prototype.initialize.apply(this,arguments);this.listenTo(this.model,"change:attrs",this.resize)}});s.shapes.basic.Generic.define("basic.Text",{attrs:{text:{"font-size":18,fill:"#000000"}}},{markup:'<g class="rotatable"><g class="scalable"><text/></g></g>'});s.shapes.basic.Generic.define("basic.Circle",{size:{width:60,height:60},attrs:{circle:{fill:"#ffffff",stroke:"#000000",r:30,cx:30,cy:30},text:{"font-size":14,text:"","text-anchor":"middle","ref-x":.5,"ref-y":.5,"y-alignment":"middle",fill:"#000000","font-family":"Arial, helvetica, sans-serif"}}},{markup:'<g class="rotatable"><g class="scalable"><circle/></g><text/></g>'});s.shapes.basic.Generic.define("basic.Ellipse",{size:{width:60,height:40},attrs:{ellipse:{fill:"#ffffff",stroke:"#000000",rx:30,ry:20,cx:30,cy:20},text:{"font-size":14,text:"","text-anchor":"middle","ref-x":.5,"ref-y":.5,"y-alignment":"middle",fill:"#000000","font-family":"Arial, helvetica, sans-serif"}}},{markup:'<g class="rotatable"><g class="scalable"><ellipse/></g><text/></g>'});s.shapes.basic.Generic.define("basic.Polygon",{size:{width:60,height:40},attrs:{polygon:{fill:"#ffffff",stroke:"#000000"},text:{"font-size":14,text:"","text-anchor":"middle","ref-x":.5,"ref-dy":20,"y-alignment":"middle",fill:"#000000","font-family":"Arial, helvetica, sans-serif"}}},{markup:'<g class="rotatable"><g class="scalable"><polygon/></g><text/></g>'});s.shapes.basic.Generic.define("basic.Polyline",{size:{width:60,height:40},attrs:{polyline:{fill:"#ffffff",stroke:"#000000"},text:{"font-size":14,text:"","text-anchor":"middle","ref-x":.5,"ref-dy":20,"y-alignment":"middle",fill:"#000000","font-family":"Arial, helvetica, sans-serif"}}},{markup:'<g class="rotatable"><g class="scalable"><polyline/></g><text/></g>'});s.shapes.basic.Generic.define("basic.Image",{attrs:{text:{"font-size":14,text:"","text-anchor":"middle","ref-x":.5,"ref-dy":20,"y-alignment":"middle",fill:"#000000","font-family":"Arial, helvetica, sans-serif"}}},{markup:'<g class="rotatable"><g class="scalable"><image/></g><text/></g>'});s.shapes.basic.Generic.define("basic.Path",{size:{width:60,height:60},attrs:{path:{fill:"#ffffff",stroke:"#000000"},text:{"font-size":14,text:"","text-anchor":"middle",ref:"path","ref-x":.5,"ref-dy":10,fill:"#000000","font-family":"Arial, helvetica, sans-serif"}}},{markup:'<g class="rotatable"><g class="scalable"><path/></g><text/></g>'});s.shapes.basic.Path.define("basic.Rhombus",{attrs:{path:{d:"M 30 0 L 60 30 30 60 0 30 z"},text:{"ref-y":.5,"ref-dy":null,"y-alignment":"middle"}}});s.shapes.basic.PortsModelInterface={initialize:function(){this.updatePortsAttrs();this.on("change:inPorts change:outPorts",this.updatePortsAttrs,this);this.constructor.__super__.constructor.__super__.initialize.apply(this,arguments)},updatePortsAttrs:function(t){if(this._portSelectors){var e=s.util.omit(this.get("attrs"),this._portSelectors);this.set("attrs",e,{silent:true})}this._portSelectors=[];var i={};s.util.toArray(this.get("inPorts")).forEach(function(t,e,r){var n=this.getPortAttrs(t,e,r.length,".inPorts","in");this._portSelectors=this._portSelectors.concat(Object.keys(n));s.util.assign(i,n)},this);s.util.toArray(this.get("outPorts")).forEach(function(t,e,r){var n=this.getPortAttrs(t,e,r.length,".outPorts","out");this._portSelectors=this._portSelectors.concat(Object.keys(n));s.util.assign(i,n)},this);this.attr(i,{silent:true});this.processPorts();this.trigger("process:ports")},getPortSelector:function(t){var e=".inPorts";var i=this.get("inPorts").indexOf(t);if(i<0){e=".outPorts";i=this.get("outPorts").indexOf(t);if(i<0)throw new Error("getPortSelector(): Port doesn't exist.")}return e+">g:nth-child("+(i+1)+")>.port-body"}};s.shapes.basic.PortsViewInterface={initialize:function(){this.listenTo(this.model,"process:ports",this.update);s.dia.ElementView.prototype.initialize.apply(this,arguments)},update:function(){this.renderPorts();s.dia.ElementView.prototype.update.apply(this,arguments)},renderPorts:function(){var t=this.$(".inPorts").empty();var e=this.$(".outPorts").empty();var i=s.util.template(this.model.portMarkup);var r=this.model.ports||[];r.filter(function(t){return t.type==="in"}).forEach(function(e,r){t.append(a(i({id:r,port:e})).node)});r.filter(function(t){return t.type==="out"}).forEach(function(t,r){e.append(a(i({id:r,port:t})).node)})}};s.shapes.basic.Generic.define("basic.TextBlock",{attrs:{rect:{fill:"#ffffff",stroke:"#000000",width:80,height:100},text:{fill:"#000000","font-size":14,"font-family":"Arial, helvetica, sans-serif"},".content":{text:"","ref-x":.5,"ref-y":.5,"y-alignment":"middle","x-alignment":"middle"}},content:""},{markup:['<g class="rotatable">','<g class="scalable"><rect/></g>',s.env.test("svgforeignobject")?'<foreignObject class="fobj"><body xmlns="http://www.w3.org/1999/xhtml"><div class="content"/></body></foreignObject>':'<text class="content"/>',"</g>"].join(""),initialize:function(){this.listenTo(this,"change:size",this.updateSize);this.listenTo(this,"change:content",this.updateContent);this.updateSize(this,this.get("size"));this.updateContent(this,this.get("content"));s.shapes.basic.Generic.prototype.initialize.apply(this,arguments)},updateSize:function(t,e){this.attr({".fobj":s.util.assign({},e),div:{style:s.util.assign({},e)}})},updateContent:function(t,e){if(s.env.test("svgforeignobject")){this.attr({".content":{html:s.util.sanitizeHTML(e)}})}else{this.attr({".content":{text:e}})}},setForeignObjectSize:function(){this.updateSize.apply(this,arguments)},setDivContent:function(){this.updateContent.apply(this,arguments)}});s.shapes.basic.TextBlockView=s.dia.ElementView.extend({initialize:function(){s.dia.ElementView.prototype.initialize.apply(this,arguments);this.noSVGForeignObjectElement=!s.env.test("svgforeignobject");if(!s.env.test("svgforeignobject")){this.listenTo(this.model,"change:content change:size",function(t){this.updateContent(t)})}},update:function(t,e){var i=this.model;if(!s.env.test("svgforeignobject")){var r=s.util.omit(e||i.get("attrs"),".content");s.dia.ElementView.prototype.update.call(this,i,r);if(!e||s.util.has(e,".content")){this.updateContent(i,e)}}else{s.dia.ElementView.prototype.update.call(this,i,e)}},updateContent:function(t,e){var i=s.util.merge({},(e||t.get("attrs"))[".content"]);i=s.util.omit(i,"text");var r=s.util.breakText(t.get("content"),t.get("size"),i,{svgDocument:this.paper.svg});var n=s.util.setByPath({},".content",i,"/");n[".content"].text=r;s.dia.ElementView.prototype.update.call(this,t,n)}});(function(t,e,i,r){"use strict";var n=t.Element;n.define("standard.Rectangle",{attrs:{body:{refWidth:"100%",refHeight:"100%",strokeWidth:2,stroke:"#000000",fill:"#FFFFFF"},label:{textVerticalAnchor:"middle",textAnchor:"middle",refX:"50%",refY:"50%",fontSize:14,fill:"#333333"}}},{markup:[{tagName:"rect",selector:"body"},{tagName:"text",selector:"label"}]});n.define("standard.Circle",{attrs:{body:{refCx:"50%",refCy:"50%",refR:"50%",strokeWidth:2,stroke:"#333333",fill:"#FFFFFF"},label:{textVerticalAnchor:"middle",textAnchor:"middle",refX:"50%",refY:"50%",fontSize:14,fill:"#333333"}}},{markup:[{tagName:"circle",selector:"body"},{tagName:"text",selector:"label"}]});n.define("standard.Ellipse",{attrs:{body:{refCx:"50%",refCy:"50%",refRx:"50%",refRy:"50%",strokeWidth:2,stroke:"#333333",fill:"#FFFFFF"},label:{textVerticalAnchor:"middle",textAnchor:"middle",refX:"50%",refY:"50%",fontSize:14,fill:"#333333"}}},{markup:[{tagName:"ellipse",selector:"body"},{tagName:"text",selector:"label"}]});n.define("standard.Path",{attrs:{body:{refD:"M 0 0 L 10 0 10 10 0 10 Z",strokeWidth:2,stroke:"#333333",fill:"#FFFFFF"},label:{textVerticalAnchor:"middle",textAnchor:"middle",refX:"50%",refY:"50%",fontSize:14,fill:"#333333"}}},{markup:[{tagName:"path",selector:"body"},{tagName:"text",selector:"label"}]});n.define("standard.Polygon",{attrs:{body:{refPoints:"0 0 10 0 10 10 0 10",strokeWidth:2,stroke:"#333333",fill:"#FFFFFF"},label:{textVerticalAnchor:"middle",textAnchor:"middle",refX:"50%",refY:"50%",fontSize:14,fill:"#333333"}}},{markup:[{tagName:"polygon",selector:"body"},{tagName:"text",selector:"label"}]});n.define("standard.Polyline",{attrs:{body:{refPoints:"0 0 10 0 10 10 0 10 0 0",strokeWidth:2,stroke:"#333333",fill:"#FFFFFF"},label:{textVerticalAnchor:"middle",textAnchor:"middle",refX:"50%",refY:"50%",fontSize:14,fill:"#333333"}}},{markup:[{tagName:"polyline",selector:"body"},{tagName:"text",selector:"label"}]});n.define("standard.Image",{attrs:{image:{refWidth:"100%",refHeight:"100%"},label:{textVerticalAnchor:"top",textAnchor:"middle",refX:"50%",refY:"100%",refY2:10,fontSize:14,fill:"#333333"}}},{markup:[{tagName:"image",selector:"image"},{tagName:"text",selector:"label"}]});n.define("standard.BorderedImage",{attrs:{border:{refWidth:"100%",refHeight:"100%",stroke:"#333333",strokeWidth:2},image:{refWidth:-1,refHeight:-1,x:.5,y:.5},label:{textVerticalAnchor:"top",textAnchor:"middle",refX:"50%",refY:"100%",refY2:10,fontSize:14,fill:"#333333"}}},{markup:[{tagName:"image",selector:"image"},{tagName:"rect",selector:"border",attributes:{fill:"none"}},{tagName:"text",selector:"label"}]});n.define("standard.EmbeddedImage",{attrs:{body:{refWidth:"100%",refHeight:"100%",stroke:"#333333",fill:"#FFFFFF",strokeWidth:2},image:{refWidth:"30%",refHeight:-20,x:10,y:10,preserveAspectRatio:"xMidYMin"},label:{textVerticalAnchor:"top",textAnchor:"left",refX:"30%",refX2:20,refY:10,fontSize:14,fill:"#333333"}}},{markup:[{tagName:"rect",selector:"body"},{tagName:"image",selector:"image"},{tagName:"text",selector:"label"}]});n.define("standard.HeaderedRectangle",{attrs:{body:{refWidth:"100%",refHeight:"100%",strokeWidth:2,stroke:"#000000",fill:"#FFFFFF"},header:{refWidth:"100%",height:30,strokeWidth:2,stroke:"#000000",fill:"#FFFFFF"},headerText:{textVerticalAnchor:"middle",textAnchor:"middle",refX:"50%",refY:15,fontSize:16,fill:"#333333"},bodyText:{textVerticalAnchor:"middle",textAnchor:"middle",refX:"50%",refY:"50%",refY2:15,fontSize:14,fill:"#333333"}}},{markup:[{tagName:"rect",selector:"body"},{tagName:"rect",selector:"header"},{tagName:"text",selector:"headerText"},{tagName:"text",selector:"bodyText"}]});var a=10;s.dia.Element.define("standard.Cylinder",{attrs:{body:{lateralArea:a,fill:"#FFFFFF",stroke:"#333333",strokeWidth:2},top:{refCx:"50%",cy:a,refRx:"50%",ry:a,fill:"#FFFFFF",stroke:"#333333",strokeWidth:2},label:{textVerticalAnchor:"middle",textAnchor:"middle",refX:"50%",refY:"100%",refY2:15,fontSize:14,fill:"#333333"}}},{markup:[{tagName:"path",selector:"body"},{tagName:"ellipse",selector:"top"},{tagName:"text",selector:"label"}],topRy:function(t,i){if(t===undefined)return this.attr("body/lateralArea");var r=e.isPercentage(t);var n={lateralArea:t};var a=r?{refCy:t,refRy:t,cy:null,ry:null}:{refCy:null,refRy:null,cy:t,ry:t};return this.attr({body:n,top:a},i)}},{attributes:{lateralArea:{set:function(t,i){var n=e.isPercentage(t);if(n)t=parseFloat(t)/100;var a=i.x;var o=i.y;var s=i.width;var l=i.height;var c=s/2;var u=n?l*t:t;var g=r.KAPPA;var h=g*c;var d=g*(n?l*t:t);var f=a;var v=a+s/2;var p=a+s;var I=o+u;var m=I-u;var A=o+l-u;var C=o+l;var w=["M",f,I,"L",f,A,"C",a,A+d,v-h,C,v,C,"C",v+h,C,p,A+d,p,A,"L",p,I,"C",p,I-d,v+h,m,v,m,"C",v-h,m,f,I-d,f,I,"Z"];return{d:w.join(" ")}}}}});var o={tagName:"foreignObject",selector:"foreignObject",attributes:{overflow:"hidden"},children:[{tagName:"div",namespaceURI:"http://www.w3.org/1999/xhtml",selector:"label",style:{width:"100%",height:"100%",position:"static",backgroundColor:"transparent",textAlign:"center",margin:0,padding:"0px 5px",boxSizing:"border-box",display:"flex",alignItems:"center",justifyContent:"center"}}]};var l={tagName:"text",selector:"label",attributes:{"text-anchor":"middle"}};n.define("standard.TextBlock",{attrs:{body:{refWidth:"100%",refHeight:"100%",stroke:"#333333",fill:"#ffffff",strokeWidth:2},foreignObject:{refWidth:"100%",refHeight:"100%"},label:{style:{fontSize:14}}}},{markup:[{tagName:"rect",selector:"body"},i.test("svgforeignobject")?o:l]},{attributes:{text:{set:function(i,r,n,a){if(n instanceof HTMLElement){n.textContent=i}else{var o=a.style||{};var s={text:i,width:-5,height:"100%"};var l=e.assign({textVerticalAnchor:"middle"},o);t.attributes.textWrap.set.call(this,s,r,n,l);return{fill:o.color||null}}},position:function(t,e,i){if(i instanceof SVGElement)return e.center()}}}});var c=t.Link;c.define("standard.Link",{attrs:{line:{connection:true,stroke:"#333333",strokeWidth:2,strokeLinejoin:"round",targetMarker:{type:"path",d:"M 10 -5 0 0 10 5 z"}},wrapper:{connection:true,strokeWidth:10,strokeLinejoin:"round"}}},{markup:[{tagName:"path",selector:"wrapper",attributes:{fill:"none",cursor:"pointer",stroke:"transparent"}},{tagName:"path",selector:"line",attributes:{fill:"none","pointer-events":"none"}}]});c.define("standard.DoubleLink",{attrs:{line:{connection:true,stroke:"#DDDDDD",strokeWidth:4,strokeLinejoin:"round",targetMarker:{type:"path",stroke:"#000000",d:"M 10 -3 10 -10 -2 0 10 10 10 3"}},outline:{connection:true,stroke:"#000000",strokeWidth:6,strokeLinejoin:"round"}}},{markup:[{tagName:"path",selector:"outline",attributes:{fill:"none"}},{tagName:"path",selector:"line",attributes:{fill:"none"}}]});c.define("standard.ShadowLink",{attrs:{line:{connection:true,stroke:"#FF0000",strokeWidth:20,strokeLinejoin:"round",targetMarker:{type:"path",stroke:"none",d:"M 0 -10 -10 0 0 10 z"},sourceMarker:{type:"path",stroke:"none",d:"M -10 -10 0 0 -10 10 0 10 0 -10 z"}},shadow:{connection:true,refX:3,refY:6,stroke:"#000000",strokeOpacity:.2,strokeWidth:20,strokeLinejoin:"round",targetMarker:{type:"path",d:"M 0 -10 -10 0 0 10 z",stroke:"none"},sourceMarker:{type:"path",stroke:"none",d:"M -10 -10 0 0 -10 10 0 10 0 -10 z"}}}},{markup:[{tagName:"path",selector:"shadow",attributes:{fill:"none"}},{tagName:"path",selector:"line",attributes:{fill:"none"}}]})})(s.dia,s.util,s.env,a);s.routers.manhattan=function(t,e,i,r){"use strict";var n={step:10,maximumLoops:2e3,precision:10,maxAllowedDirectionChange:90,perpendicular:true,excludeEnds:[],excludeTypes:["basic.Text"],startDirections:["top","right","bottom","left"],endDirections:["top","right","bottom","left"],directionMap:{top:{x:0,y:-1},right:{x:1,y:0},bottom:{x:0,y:1},left:{x:-1,y:0}},cost:function(){return this.step},directions:function(){var t=this.step;var e=this.cost();return[{offsetX:t,offsetY:0,cost:e},{offsetX:0,offsetY:t,cost:e},{offsetX:-t,offsetY:0,cost:e},{offsetX:0,offsetY:-t,cost:e}]},penalties:function(){return{0:0,45:this.step/2,90:this.step/2}},paddingBox:function(){var t=this.step;return{x:-t,y:-t,width:2*t,height:2*t}},fallbackRouter:function(t,e,a){if(!r.isFunction(i.routers.orthogonal)){throw new Error("Manhattan requires the orthogonal router as default fallback.")}return i.routers.orthogonal(t,r.assign({},n,e),a)},fallbackRoute:function(t,e,i){return null},draggingRoute:null};function a(t){this.map={};this.options=t;this.mapGridSize=100}a.prototype.build=function(t,e){var i=this.options;var n=r.toArray(i.excludeEnds).reduce(function(i,r){var n=e.get(r);if(n){var a=t.getCell(n.id);if(a){i.push(a)}}return i},[]);var a=[];var o=t.getCell(e.get("source").id);if(o){a=r.union(a,o.getAncestors().map(function(t){return t.id}))}var s=t.getCell(e.get("target").id);if(s){a=r.union(a,s.getAncestors().map(function(t){return t.id}))}var l=this.mapGridSize;t.getElements().reduce(function(t,e){var o=r.toArray(i.excludeTypes).includes(e.get("type"));var s=n.find(function(t){return t.id===e.id});var c=a.includes(e.id);var u=o||s||c;if(!u){var g=e.getBBox().moveAndExpand(i.paddingBox);var h=g.origin().snapToGrid(l);var d=g.corner().snapToGrid(l);for(var f=h.x;f<=d.x;f+=l){for(var v=h.y;v<=d.y;v+=l){var p=f+"@"+v;t[p]=t[p]||[];t[p].push(g)}}}return t},this.map);return this};a.prototype.isPointAccessible=function(t){var e=t.clone().snapToGrid(this.mapGridSize).toString();return r.toArray(this.map[e]).every(function(e){return!e.containsPoint(t)})};function o(){this.items=[];this.hash={};this.values={};this.OPEN=1;this.CLOSE=2}o.prototype.add=function(t,e){if(this.hash[t]){this.items.splice(this.items.indexOf(t),1)}else{this.hash[t]=this.OPEN}this.values[t]=e;var r=i.util.sortedIndex(this.items,t,function(t){return this.values[t]}.bind(this));this.items.splice(r,0,t)};o.prototype.remove=function(t){this.hash[t]=this.CLOSE};o.prototype.isOpen=function(t){return this.hash[t]===this.OPEN};o.prototype.isClose=function(t){return this.hash[t]===this.CLOSE};o.prototype.isEmpty=function(){return this.items.length===0};o.prototype.pop=function(){var t=this.items.shift();this.remove(t);return t};function s(t,e){if(e&&e.paddingBox)return t.sourceBBox.clone().moveAndExpand(e.paddingBox);return t.sourceBBox.clone()}function l(t,e){if(e&&e.paddingBox)return t.targetBBox.clone().moveAndExpand(e.paddingBox);return t.targetBBox.clone()}function c(t,e){if(t.sourceAnchor)return t.sourceAnchor;var i=s(t,e);return i.center()}function u(t,e){if(t.targetAnchor)return t.targetAnchor;var i=l(t,e);return i.center()}function g(e,i,r,n,a){var o=360/r;var s=e.theta(h(e,i,n,a));var l=t.normalizeAngle(s+o/2);return o*Math.floor(l/o)}function h(e,i,r,n){var a=n.step;var o=i.x-e.x;var s=i.y-e.y;var l=o/r.x;var c=s/r.y;var u=l*a;var g=c*a;return new t.Point(e.x+u,e.y+g)}function d(t,e){var i=Math.abs(t-e);return i>180?360-i:i}function f(t,e,i){var n=i.step;r.toArray(i.directions).forEach(function(t){t.gridOffsetX=t.offsetX/n*e.x;t.gridOffsetY=t.offsetY/n*e.y})}function v(t,e,i){return{source:e.clone(),x:p(i.x-e.x,t),y:p(i.y-e.y,t)}}function p(t,e){if(!t)return e;var i=Math.abs(t);var r=Math.round(i/e);if(!r)return i;var n=r*e;var a=i-n;var o=a/r;return e+o}function I(e,i){var r=i.source;var n=t.snapToGrid(e.x-r.x,i.x)+r.x;var a=t.snapToGrid(e.y-r.y,i.y)+r.y;return new t.Point(n,a)}function m(t,e){if(!t)return t;return t.round(e.precision)}function A(t){return t.clone().round().toString()}function C(e){return new t.Point(e.x===0?0:Math.abs(e.x)/e.x,e.y===0?0:Math.abs(e.y)/e.y)}function w(t,e,i,r,n,a){var o=[];var s=C(n.difference(i));var l=A(i);var c=t[l];var u;while(c){u=m(e[l],a);var g=C(u.difference(m(c.clone(),a)));if(!g.equals(s)){o.unshift(u);s=g}l=A(c);c=t[l]}var h=m(e[l],a);var d=C(h.difference(r));if(!d.equals(s)){o.unshift(h)}return o}function b(t,e){var i=Infinity;for(var r=0,n=e.length;r<n;r++){var a=t.manhattanDistance(e[r]);if(a<i)i=a}return i}function y(e,i,n,a,o){var s=o.directionMap;var l=m(I(e,a),o);var c=m(I(i.center(),a),o);var u=l.difference(c);var g=r.isObject(s)?Object.keys(s):[];var h=r.toArray(n);var d=g.reduce(function(r,n){if(h.includes(n)){var c=s[n];var g=new t.Point(l.x+c.x*(Math.abs(u.x)+i.width),l.y+c.y*(Math.abs(u.y)+i.height));var d=new t.Line(e,g);var f=d.intersect(i)||[];var v=f.length;var p;var A=null;for(var C=0;C<v;C++){var w=f[C];var b=l.squaredDistance(w);if(p===undefined||b>p){p=b;A=I(w,a)}}var y=m(A,o);if(y){if(i.containsPoint(y)){m(y.offset(c.x*a.x,c.y*a.y),o)}r.push(y)}}return r},[]);if(!i.containsPoint(l))d.push(l);return d}function N(e,i,n,a){var s,l;if(e instanceof t.Rect){s=c(this,a).clone()}else{s=e.clone()}if(i instanceof t.Rect){l=u(this,a).clone()}else{l=i.clone()}var h=v(a.step,s,l);var p,C;var N,M;if(e instanceof t.Rect){p=m(I(s,h),a);N=y(p,e,a.startDirections,h,a)}else{p=m(I(s,h),a);N=[p]}if(i instanceof t.Rect){C=m(I(l,h),a);M=y(l,i,a.endDirections,h,a)}else{C=m(I(l,h),a);M=[C]}N=N.filter(n.isPointAccessible,n);M=M.filter(n.isPointAccessible,n);if(N.length>0&&M.length>0){var x=new o;var k={};var z={};var D={};for(var S=0,j=N.length;S<j;S++){var Z=N[S];var G=A(Z);x.add(G,b(Z,M));k[G]=Z;D[G]=0}var P=a.previousDirectionAngle;var L=P===undefined;var T,B;var O=a.directions;f(O,h,a);var Y=O.length;var W=r.toArray(M).reduce(function(t,e){var i=A(e);t.push(i);return t},[]);var E=a.maximumLoops;while(!x.isEmpty()&&E>0){var R=x.pop();var X=k[R];var V=z[R];var U=D[R];var F=V===undefined;var J=X.equals(p);var H;if(!F)H=g(V,X,Y,h,a);else if(!L)H=P;else if(!J)H=g(p,X,Y,h,a);else H=null;if(W.indexOf(R)>=0){a.previousDirectionAngle=H;return w(z,k,X,p,C,a)}for(S=0;S<Y;S++){T=O[S];var Q=T.angle;B=d(H,Q);if(!(L&&J)&&B>a.maxAllowedDirectionChange)continue;var _=X.clone().offset(T.gridOffsetX,T.gridOffsetY);var K=A(_);if(x.isClose(K)||!n.isPointAccessible(_))continue;if(W.indexOf(K)>=0){m(_,a);var q=_.equals(C);if(!q){var $=g(_,C,Y,h,a);var tt=d(Q,$);if(tt>a.maxAllowedDirectionChange)continue}}var et=T.cost;var it=J?0:a.penalties[B];var rt=U+et+it;if(!x.isOpen(K)||rt<D[K]){k[K]=_;z[K]=X;D[K]=rt;x.add(K,rt+b(_,M))}}E--}}return a.fallbackRoute.call(this,p,C,a)}function M(e){e.directions=r.result(e,"directions");e.penalties=r.result(e,"penalties");e.paddingBox=r.result(e,"paddingBox");r.toArray(e.directions).forEach(function(e){var i=new t.Point(0,0);var r=new t.Point(e.offsetX,e.offsetY);e.angle=t.normalizeAngle(i.theta(r))})}function x(e,i,n){M(i);n.options.perpendicular=!!i.perpendicular;var o=s(n,i);var u=l(n,i);var g=c(n,i);var h=new a(i).build(n.paper.model,n.model);var d=r.toArray(e).map(t.Point);var f=[];var v=g;for(var p=0,I=d.length;p<=I;p++){var m=null;var A=C||o;var C=d[p];if(!C){C=u;var w=!n.model.get("source").id||!n.model.get("target").id;if(w&&r.isFunction(i.draggingRoute)){var b=A===o?g:A;var y=C.origin();m=i.draggingRoute.call(n,b,y,i)}}m=m||N.call(n,A,C,h,i);if(m===null){return i.fallbackRouter(e,i,n)}var x=m[0];if(x&&x.equals(v))m.shift();v=m[m.length-1]||v;Array.prototype.push.apply(f,m)}return f}return function(t,e,i){return x(t,r.assign({},n,e),i)}}(n,i,s,s.util);s.routers.metro=function(t){var e={maxAllowedDirectionChange:45,diagonalCost:function(){var t=this.step;return Math.ceil(Math.sqrt(t*t<<1))},directions:function(){var t=this.step;var e=this.cost();var i=this.diagonalCost();return[{offsetX:t,offsetY:0,cost:e},{offsetX:t,offsetY:t,cost:i},{offsetX:0,offsetY:t,cost:e},{offsetX:-t,offsetY:t,cost:i},{offsetX:-t,offsetY:0,cost:e},{offsetX:-t,offsetY:-t,cost:i},{offsetX:0,offsetY:-t,cost:e},{offsetX:t,offsetY:-t,cost:i}]},fallbackRoute:function(t,e,i){var r=t.theta(e);var a=[];var o={x:e.x,y:t.y};var s={x:t.x,y:e.y};if(r%180>90){var l=o;o=s;s=l}var c=r%90<45?o:s;var u=new n.Line(t,c);var g=90*Math.ceil(r/90);var h=n.Point.fromPolar(u.squaredLength(),n.toRad(g+135),c);var d=new n.Line(e,h);var f=u.intersection(d);var v=f?f:e;var p=f?v:t;var I=360/i.directions.length;var m=p.theta(e);var A=n.normalizeAngle(m+I/2);var C=I*Math.floor(A/I);i.previousDirectionAngle=C;if(v)a.push(v.round());a.push(e);return a}};return function(i,r,n){if(!t.isFunction(s.routers.manhattan)){throw new Error("Metro requires the manhattan router.")}return s.routers.manhattan(i,t.assign({},e,r),n)}}(s.util);s.routers.normal=function(t,e,i){return t};s.routers.oneSide=function(t,e,i){var r=e.side||"bottom";var n=e.padding||40;var a=i.sourceBBox;var o=i.targetBBox;var s=a.center();var l=o.center();var c,u,g;switch(r){case"bottom":g=1;c="y";u="height";break;case"top":g=-1;c="y";u="height";break;case"left":g=-1;c="x";u="width";break;case"right":g=1;c="x";u="width";break;default:throw new Error("Router: invalid side")}s[c]+=g*(a[u]/2+n);l[c]+=g*(o[u]/2+n);if(g*(s[c]-l[c])>0){l[c]=s[c]}else{s[c]=l[c]}return[s].concat(t,l)};s.routers.orthogonal=function(t){var e={N:"S",S:"N",E:"W",W:"E"};var i={N:-Math.PI/2*3,S:-Math.PI/2,E:0,W:Math.PI};function r(t,e,i){var r=new n.Point(t.x,e.y);if(i.containsPoint(r))r=new n.Point(e.x,t.y);return r}function a(t,e){return t[e==="W"||e==="E"?"width":"height"]}function o(t,e){if(t.x===e.x)return t.y>e.y?"N":"S";if(t.y===e.y)return t.x>e.x?"W":"E";return null}function s(t){return new n.Rect(t.x,t.y,0,0)}function l(t,e){var i=e&&e.elementPadding||20;return t.sourceBBox.clone().inflate(i)}function c(t,e){var i=e&&e.elementPadding||20;return t.targetBBox.clone().inflate(i)}function u(t,e){if(t.sourceAnchor)return t.sourceAnchor;var i=l(t,e);return i.center()}function g(t,e){if(t.targetAnchor)return t.targetAnchor;var i=c(t,e);return i.center()}function h(t,i,r){var a=new n.Point(t.x,i.y);var s=new n.Point(i.x,t.y);var l=o(t,a);var c=o(t,s);var u=e[r];var g=l===r||l!==u&&(c===u||c!==r)?a:s;return{points:[g],direction:o(g,i)}}function d(t,e,i){var n=r(t,e,i);return{points:[n],direction:o(n,e)}}function f(e,i,s,l){var c={};var u=[new n.Point(e.x,i.y),new n.Point(i.x,e.y)];var g=u.filter(function(t){return!s.containsPoint(t)});var h=g.filter(function(t){return o(t,e)!==l});var d;if(h.length>0){d=h.filter(function(t){return o(e,t)===l}).pop();d=d||h[0];c.points=[d];c.direction=o(d,i)}else{d=t.difference(u,g)[0];var f=new n.Point(i).move(d,-a(s,l)/2);var v=r(f,e,s);c.points=[v,f];c.direction=o(f,i)}return c}function v(t,e,i,r){var s=d(e,t,r);var l=s.points[0];if(i.containsPoint(l)){s=d(t,e,i);var c=s.points[0];if(r.containsPoint(c)){var u=new n.Point(t).move(c,-a(i,o(t,c))/2);var g=new n.Point(e).move(l,-a(r,o(e,l))/2);var f=new n.Line(u,g).midpoint();var v=d(t,f,i);var p=h(f,e,v.direction);s.points=[v.points[0],p.points[0]];s.direction=p.direction}}return s}function p(t,e,a,s,l){var c={};var u=a.union(s).inflate(1);var g=u.center().distance(e)>u.center().distance(t);var h=g?e:t;var d=g?t:e;var f,v,p;if(l){f=n.Point.fromPolar(u.width+u.height,i[l],h);f=u.pointNearestToPoint(f).move(f,-1)}else{f=u.pointNearestToPoint(h).move(h,1)}v=r(f,d,u);if(f.round().equals(v.round())){v=n.Point.fromPolar(u.width+u.height,n.toRad(f.theta(h))+Math.PI/2,d);v=u.pointNearestToPoint(v).move(d,1).round();p=r(f,v,u);c.points=g?[v,p,f]:[f,p,v]}else{c.points=g?[v,f]:[f,v]}c.direction=g?o(f,e):o(v,e);return c}function I(e,i,r){var a=i.elementPadding||20;var I=l(r,i);var m=c(r,i);var A=u(r,i);var C=g(r,i);I=I.union(s(A));m=m.union(s(C));e=t.toArray(e).map(n.Point);e.unshift(A);e.push(C);var w;var b=[];for(var y=0,N=e.length-1;y<N;y++){var M=null;var x=e[y];var k=e[y+1];var z=!!o(x,k);if(y===0){if(y+1===N){if(I.intersect(m.clone().inflate(1))){M=p(x,k,I,m)}else if(!z){M=v(x,k,I,m)}}else{if(I.containsPoint(k)){M=p(x,k,I,s(k).inflate(a))}else if(!z){M=d(x,k,I)}}}else if(y+1===N){var D=z&&o(k,x)===w;if(m.containsPoint(x)||D){M=p(x,k,s(x).inflate(a),m,w)}else if(!z){M=f(x,k,m,w)}}else if(!z){M=h(x,k,w)}if(M){Array.prototype.push.apply(b,M.points);w=M.direction}else{w=o(x,k)}if(y+1<N){b.push(k)}}return b}return I}(s.util);s.connectors.normal=function(t,e,i,r){var a=r&&r.raw;var o=[t].concat(i).concat([e]);var s=new n.Polyline(o);var l=new n.Path(s);return a?l:l.serialize()};s.connectors.rounded=function(t,e,i,r){r||(r={});var a=r.radius||10;var o=r.raw;var s=new n.Path;var l;l=n.Path.createSegment("M",t);s.appendSegment(l);var c=1/3;var u=2/3;var g;var h,d;var f,v;var p,I;var m,A;var C,w;for(var b=0,y=i.length;b<y;b++){g=new n.Point(i[b]);h=i[b-1]||t;d=i[b+1]||e;f=v||g.distance(h)/2;v=g.distance(d)/2;p=-Math.min(a,f);I=-Math.min(a,v);m=g.clone().move(h,p).round();A=g.clone().move(d,I).round();C=new n.Point(c*m.x+u*g.x,u*g.y+c*m.y);w=new n.Point(c*A.x+u*g.x,u*g.y+c*A.y);l=n.Path.createSegment("L",m);s.appendSegment(l);l=n.Path.createSegment("C",C,w,A);s.appendSegment(l)}l=n.Path.createSegment("L",e);s.appendSegment(l);return o?s:s.serialize()};s.connectors.smooth=function(t,e,i,r){var a=r&&r.raw;var o;if(i&&i.length!==0){var s=[t].concat(i).concat([e]);var l=n.Curve.throughPoints(s);o=new n.Path(l)}else{o=new n.Path;var c;c=n.Path.createSegment("M",t);o.appendSegment(c);if(Math.abs(t.x-e.x)>=Math.abs(t.y-e.y)){var u=(t.x+e.x)/2;c=n.Path.createSegment("C",u,t.y,u,e.y,e.x,e.y);o.appendSegment(c)}else{var g=(t.y+e.y)/2;c=n.Path.createSegment("C",t.x,g,e.x,g,e.x,e.y);o.appendSegment(c)}}return a?o:o.serialize()};s.connectors.jumpover=function(t,e,i){var r=5;var n=["arc","gap","cubic"];var a=1;var o=["smooth"];function l(t,i,r){var n=[].concat(t,r,i);return n.reduce(function(t,i,r){var a=n[r+1];if(a!=null){t[r]=e.line(i,a)}return t},[])}function c(t){var e=t.paper._jumpOverUpdateList;if(e==null){e=t.paper._jumpOverUpdateList=[];t.paper.on("cell:pointerup",u);t.paper.model.on("reset",function(){e=t.paper._jumpOverUpdateList=[]})}if(e.indexOf(t)<0){e.push(t);t.listenToOnce(t.model,"change:connector remove",function(){e.splice(e.indexOf(t),1)})}}function u(){var t=this._jumpOverUpdateList;for(var e=0;e<t.length;e++){t[e].update()}}function g(t,e){return i.toArray(e).reduce(function(e,i){var r=t.intersection(i);if(r){e.push(r)}return e},[])}function h(t,i){return e.line(t,i).squaredLength()}function d(t,i,r){return i.reduce(function(n,o,s){if(o.skip===true){return n}var l=n.pop()||t;var c=e.point(o).move(l.start,-r);var u=e.point(o).move(l.start,+r);var g=i[s+1];if(g!=null){var h=u.distance(g);if(h<=r){u=g.move(l.start,h);g.skip=true}}else{var d=c.distance(l.end);if(d<r*2+a){n.push(l);return n}}var f=u.distance(l.start);if(f<r*2+a){n.push(l);return n}var v=e.line(c,u);v.isJump=true;n.push(e.line(l.start,c),v,e.line(u,l.end));return n},[])}function f(t,i,r){var n=new e.Path;var a;a=e.Path.createSegment("M",t[0].start);n.appendSegment(a);s.util.toArray(t).forEach(function(t,o){if(t.isJump){var s,l;var c,u;if(r==="arc"){s=-90;l=t.start.difference(t.end);var g=Number(l.x<0||l.x===0&&l.y<0);if(g)s+=180;var h=t.midpoint();var d=new e.Line(h,t.end).rotate(h,s);var f;f=new e.Line(t.start,h);c=f.pointAt(2/3).rotate(t.start,s);u=d.pointAt(1/3).rotate(d.end,-s);a=e.Path.createSegment("C",c,u,d.end);n.appendSegment(a);f=new e.Line(h,t.end);c=d.pointAt(1/3).rotate(d.end,s);u=f.pointAt(1/3).rotate(t.end,-s);a=e.Path.createSegment("C",c,u,t.end);n.appendSegment(a)}else if(r==="gap"){a=e.Path.createSegment("M",t.end);n.appendSegment(a)}else if(r==="cubic"){s=t.start.theta(t.end);var v=i*.6;var p=i*1.35;l=t.start.difference(t.end);g=Number(l.x<0||l.x===0&&l.y<0);if(g)p*=-1;c=e.Point(t.start.x+v,t.start.y+p).rotate(t.start,s);u=e.Point(t.end.x-v,t.end.y+p).rotate(t.end,s);a=e.Path.createSegment("C",c,u,t.end);n.appendSegment(a)}}else{a=e.Path.createSegment("L",t.end);n.appendSegment(a)}});return n}return function(t,e,a,s){c(this);var u=s.raw;var v=s.size||r;var p=s.jump&&(""+s.jump).toLowerCase();var I=s.ignoreConnectors||o;if(n.indexOf(p)===-1){p=n[0]}var m=this.paper;var A=m.model;var C=A.getLinks();if(C.length===1){return f(l(t,e,a),v,p)}var w=this.model;var b=C.indexOf(w);var y=m.options.defaultConnector||{};var N=C.filter(function(t,e){var r=t.get("connector")||y;if(i.toArray(I).includes(r.name)){return false}if(e>b){return r.name!=="jumpover"}return true});var M=N.map(function(t){return m.findViewByModel(t)});var x=l(t,e,a);var k=M.map(function(t){if(t==null){return[]}if(t===this){return x}return l(t.sourcePoint,t.targetPoint,t.route)},this);var z=x.reduce(function(t,e){var i=N.reduce(function(t,i,r){if(i!==w){var n=g(e,k[r]);t.push.apply(t,n)}return t},[]).sort(function(t,i){return h(e.start,t)-h(e.start,i)});if(i.length>0){t.push.apply(t,d(e,i,v))}else{t.push(e)}return t},[]);var D=f(z,v,p);return u?D:D.serialize()}}(i,n,s.util);(function(t,e,i,r){function n(t,e,r){var n=t.toJSON();n.angle=e||0;return i.util.defaults({},r,n)}function a(t,i,r){return t.map(function(t,e,i){var r=this.pointAt((e+.5)/i.length);if(t.dx||t.dy){r.offset(t.dx||0,t.dy||0)}return n(r.round(),0,t)},e.line(i,r))}function o(t,i,r,a){var o=i.center();var s=i.width/i.height;var l=i.topMiddle();var c=e.Ellipse.fromRect(i);return t.map(function(t,e,i){var u=r+a(e,i.length);var g=l.clone().rotate(o,-u).scale(s,1,o);var h=t.compensateRotation?-c.tangentTheta(g):0;if(t.dx||t.dy){g.offset(t.dx||0,t.dy||0)}if(t.dr){g.move(o,t.dr)}return n(g.round(),h,t)})}function s(t,i){var n=i.x;if(r.isString(n)){n=parseFloat(n)/100*t.width}var a=i.y;if(r.isString(a)){a=parseFloat(a)/100*t.height}return e.point(n||0,a||0)}i.layout.Port={absolute:function(t,e,i){return t.map(s.bind(null,e))},fn:function(t,e,i){return i.fn(t,e,i)},line:function(t,e,i){var r=s(e,i.start||e.origin());var n=s(e,i.end||e.corner());return a(t,r,n)},left:function(t,e,i){return a(t,e.origin(),e.bottomLeft())},right:function(t,e,i){return a(t,e.topRight(),e.corner())},top:function(t,e,i){return a(t,e.origin(),e.topRight())},bottom:function(t,e,i){return a(t,e.bottomLeft(),e.corner())},ellipseSpread:function(t,e,i){var r=i.startAngle||0;var n=i.step||360/t.length;return o(t,e,r,function(t){return t*n})},ellipse:function(t,e,i){var r=i.startAngle||0;var n=i.step||20;return o(t,e,r,function(t,e){return(t+.5-e/2)*n})}}})(i,n,s,s.util);(function(t,e,i,r){function n(t,e){return r.defaultsDeep({},t,e,{x:0,y:0,angle:0,attrs:{".":{y:"0","text-anchor":"start"}}})}function a(t,e,i,a){a=r.defaults({},a,{offset:15});var s=e.center().theta(t);var l=o(e);var c,u,g,h;var d=a.offset;var f=0;if(s<l[1]||s>l[2]){g=".3em";c=d;u=0;h="start"}else if(s<l[0]){g="0";c=0;u=-d;if(i){f=-90;h="start"}else{h="middle"}}else if(s<l[3]){g=".3em";c=-d;u=0;h="end"}else{g=".6em";c=0;u=d;if(i){f=90;h="start"}else{h="middle"}}var v=Math.round;return n({x:v(c),y:v(u),angle:f,attrs:{".":{y:g,"text-anchor":h}}})}function o(t){var e=t.center();var i=e.theta(t.origin());var r=e.theta(t.bottomLeft());var n=e.theta(t.corner());var a=e.theta(t.topRight());return[i,a,n,r]}function s(t,e,i,a){var s=e.center().theta(t);a=r.defaults({},a,{offset:15});var l,c,u,g;var h=a.offset;var d=0;var f=o(e);if(s<f[1]||s>f[2]){u=".3em";l=-h;c=0;g="end"}else if(s<f[0]){u=".6em";l=0;c=h;if(i){d=90;g="start"}else{g="middle"}}else if(s<f[3]){u=".3em";l=h;c=0;g="start"}else{u="0em";l=0;c=-h;if(i){d=-90;g="start"}else{g="middle"}}var v=Math.round;return n({x:v(l),y:v(c),angle:d,attrs:{".":{y:u,"text-anchor":g}}})}function l(t,i,a){a=r.defaults({},a,{offset:20});var o=e.point(0,0);var s=-t.theta(o);var l=s;var c=t.clone().move(o,a.offset).difference(t).round();var u=".3em";var g;if((s+90)%180===0){g=i?"end":"middle";if(!i&&s===-270){u="0em"}}else if(s>-270&&s<-90){g="start";l=s-180}else{g="end"}var h=Math.round;return n({x:h(c.x),y:h(c.y),angle:i?l:0,attrs:{".":{y:u,"text-anchor":g}}})}i.layout.PortLabel={manual:function(t,e,i){return n(i,t)},left:function(t,e,i){return n(i,{x:-15,attrs:{".":{y:".3em","text-anchor":"end"}}})},right:function(t,e,i){return n(i,{x:15,attrs:{".":{y:".3em","text-anchor":"start"}}})},top:function(t,e,i){return n(i,{y:-15,attrs:{".":{"text-anchor":"middle"}}})},bottom:function(t,e,i){return n(i,{y:15,attrs:{".":{y:".6em","text-anchor":"middle"}}})},outsideOriented:function(t,e,i){return a(t,e,true,i)},outside:function(t,e,i){return a(t,e,false,i)},insideOriented:function(t,e,i){return s(t,e,true,i)},inside:function(t,e,i){return s(t,e,false,i)},radial:function(t,e,i){return l(t.difference(e.center()),false,i)},radialOriented:function(t,e,i){return l(t.difference(e.center()),true,i)}}})(i,n,s,s.util);s.highlighters.addClass={className:s.util.addClassNamePrefix("highlighted"),highlight:function(t,e,i){var r=i||{};var n=r.className||this.className;a(e).addClass(n)},unhighlight:function(t,e,i){var r=i||{};var n=r.className||this.className;a(e).removeClass(n)}};s.highlighters.opacity={highlight:function(t,e){a(e).addClass(s.util.addClassNamePrefix("highlight-opacity"))},unhighlight:function(t,e){a(e).removeClass(s.util.addClassNamePrefix("highlight-opacity"))}};s.highlighters.stroke={defaultOptions:{padding:3,rx:0,ry:0,attrs:{"stroke-width":3,stroke:"#FEB663"}},_views:{},getHighlighterId:function(t,e){return t.id+JSON.stringify(e)},removeHighlighter:function(t){if(this._views[t]){this._views[t].remove();this._views[t]=null}},highlight:function(t,e,i){var r=this.getHighlighterId(e,i);if(this._views[r])return;var n=s.util.defaults(i||{},this.defaultOptions);var o=a(e);var l;try{var c=o.convertToPathData()}catch(t){l=o.bbox(true);c=a.rectToPath(s.util.assign({},n,l))}var u=a("path").attr({d:c,"pointer-events":"none","vector-effect":"non-scaling-stroke",fill:"none"}).attr(n.attrs);var g=o.getTransformToElement(t.el);var h=n.padding;if(h){l||(l=o.bbox(true));var d=l.x+l.width/2;var f=l.y+l.height/2;l=a.transformRect(l,g);var v=Math.max(l.width,1);var p=Math.max(l.height,1);var I=(v+h)/v;var m=(p+h)/p;var A=a.createSVGMatrix({a:I,b:0,c:0,d:m,e:d-I*d,f:f-m*f});g=g.multiply(A)}u.transform(g);var C=this._views[r]=new s.mvc.View({svgElement:true,className:"highlight-stroke",el:u.node});var w=this.removeHighlighter.bind(this,r);var b=t.model;C.listenTo(b,"remove",w);C.listenTo(b.graph,"reset",w);t.vel.append(u)},unhighlight:function(t,e,i){this.removeHighlighter(this.getHighlighterId(e,i))}};(function(t,e){function i(t){return function(i,r,n,a){var o=!!a.rotate;var s=o?i.getNodeUnrotatedBBox(r):i.getNodeBBox(r);var l=s[t]();var c=a.dx;if(c){var u=e.isPercentage(c);c=parseFloat(c);if(isFinite(c)){if(u){c/=100;c*=s.width}l.x+=c}}var g=a.dy;if(g){var h=e.isPercentage(g);g=parseFloat(g);if(isFinite(g)){if(h){g/=100;g*=s.height}l.y+=g}}return o?l.rotate(i.model.getBBox().center(),-i.model.angle()):l}}function r(t){return function(e,i,r,n){if(r instanceof Element){var a=this.paper.findView(r);var o=a.getNodeBBox(r).center();return t.call(this,e,i,o,n)}return t.apply(this,arguments)}}function a(t,e,i,r){var a=t.model.angle();var o=t.getNodeBBox(e);var s=o.center();var l=o.origin();var c=o.corner();var u=r.padding;if(!isFinite(u))u=0;if(l.y+u<=i.y&&i.y<=c.y-u){var g=i.y-s.y;s.x+=a===0||a===180?0:g*1/Math.tan(n.toRad(a));s.y+=g}else if(l.x+u<=i.x&&i.x<=c.x-u){var h=i.x-s.x;s.y+=a===90||a===270?0:h*Math.tan(n.toRad(a));s.x+=h}return s}function o(t,e,i,r){var n=!!r.rotate;var a,o,s;if(n){a=t.getNodeUnrotatedBBox(e);s=t.model.getBBox().center();o=t.model.angle()}else{a=t.getNodeBBox(e)}var l=r.padding;if(isFinite(l))a.inflate(l);if(n)i.rotate(s,o);var c=a.sideNearestToPoint(i);var u;switch(c){case"left":u=a.leftMiddle();break;case"right":u=a.rightMiddle();break;case"top":u=a.topMiddle();break;case"bottom":u=a.bottomMiddle();break}return n?u.rotate(s,-o):u}function s(t,e){var i=t.model;var r=i.getBBox();var a=r.center();var o=i.angle();var s=t.findAttribute("port",e);if(s){portGroup=i.portProp(s,"group");var l=i.getPortsPositions(portGroup);var c=new n.Point(l[s]).offset(r.origin());c.rotate(a,-o);return c}return a}t.anchors={center:i("center"),top:i("topMiddle"),bottom:i("bottomMiddle"),left:i("leftMiddle"),right:i("rightMiddle"),topLeft:i("origin"),topRight:i("topRight"),bottomLeft:i("bottomLeft"),bottomRight:i("corner"),perpendicular:r(a),midSide:r(o),modelCenter:s}})(s,s.util);(function(t,e,i,r){function n(t,i){if(t.length===1)return t[0];return e.sortBy(t,function(t){return t.squaredDistance(i)})[0]}function a(t,e,i){if(!isFinite(i))return t;var r=t.distance(e);if(i===0&&r>0)return t;return t.move(e,-Math.min(i,r-1))}function o(t){var e=t.getAttribute("stroke-width");if(e===null)return 0;return parseFloat(e)||0}function s(t,e,i,r){return a(t.end,t.start,r.offset)}function l(t,e,i,r){var s=e.getNodeBBox(i);if(r.stroke)s.inflate(o(i)/2);var l=t.intersect(s);var c=l?n(l,t.start):t.end;return a(c,t.start,r.offset)}function c(t,e,i,r){var s=e.model.angle();if(s===0){return l(t,e,i,r)}var c=e.getNodeUnrotatedBBox(i);if(r.stroke)c.inflate(o(i)/2);var u=c.center();var g=t.clone().rotate(u,s);var h=g.setLength(1e6).intersect(c);var d=h?n(h,g.start).rotate(u,-s):t.end;return a(d,t.start,r.offset)}var u="segmentSubdivisons";var g="shapeBBox";function h(t,s,l,c){var h,d;var f=c.selector;var v=t.end;if(typeof f==="string"){h=s.findBySelector(f)[0]}else if(Array.isArray(f)){h=e.getByPath(l,f)}else{h=l;do{var p=h.tagName.toUpperCase();if(p==="G"){h=h.firstChild}else if(p==="TITLE"){h=h.nextSibling}else break}while(h)}if(!(h instanceof Element))return v;var I=s.getNodeShape(h);var m=s.getNodeMatrix(h);var A=s.getRootTranslateMatrix();var C=s.getRootRotateMatrix();var w=A.multiply(C).multiply(m);var b=w.inverse();var y=r.transformLine(t,b);var N=y.start.clone();var M=s.getNodeData(h);if(c.insideout===false){if(!M[g])M[g]=I.bbox();var x=M[g];if(x.containsPoint(N))return v}var k;if(I instanceof i.Path){var z=c.precision||2;if(!M[u])M[u]=I.getSegmentSubdivisions({precision:z});segmentSubdivisions=M[u];k={precision:z,segmentSubdivisions:M[u]}}if(c.extrapolate===true)y.setLength(1e6);d=y.intersect(I,k);if(d){if(r.isArray(d))d=n(d,N)}else if(c.sticky===true){if(I instanceof i.Rect){d=I.pointNearestToPoint(N)}else if(I instanceof i.Ellipse){d=I.intersectionWithLineFromCenterToPoint(N)}else{d=I.closestPoint(N,k)}}var D=d?r.transformPoint(d,w):v;var S=c.offset||0;if(c.stroke)S+=o(h)/2;return a(D,t.start,S)}t.connectionPoints={anchor:s,bbox:l,rectangle:c,boundary:h}})(s,s.util,n,a);(function(t,e){function i(t,e){if(e===0)return"0%";return Math.round(t/e*100)+"%"}function r(t){return function(e,r,n,a){var o=r.model.angle();var s=r.getNodeUnrotatedBBox(n);var l=r.model.getBBox().center();a.rotate(l,o);var c=a.x-s.x;var u=a.y-s.y;if(t){c=i(c,s.width);u=i(u,s.height)}e.anchor={name:"topLeft",args:{dx:c,dy:u,rotate:true}};return e}}t.connectionStrategies={useDefaults:e.noop,pinAbsolute:r(false),pinRelative:r(true)}})(s,s.util);(function(t,e,i,r){function n(e,i,r){var n=t.connectionStrategies.pinRelative.call(this.paper,{},i,r,e,this.model);return n.anchor}function a(t,e,i,r,n,a){var o=a.options.snapRadius;var s=r==="source";var l=s?0:-1;var c=this.model.vertex(l)||this.getEndAnchor(s?"target":"source");if(c){if(Math.abs(c.x-t.x)<o)t.x=c.x;if(Math.abs(c.y-t.y)<o)t.y=c.y}return t}var o=t.dia.ToolView;var s=t.mvc.View.extend({tagName:"circle",svgElement:true,className:"marker-vertex",events:{mousedown:"onPointerDown",touchstart:"onPointerDown",dblclick:"onDoubleClick"},documentEvents:{mousemove:"onPointerMove",touchmove:"onPointerMove",mouseup:"onPointerUp",touchend:"onPointerUp"},attributes:{r:6,fill:"#33334F",stroke:"#FFFFFF","stroke-width":2,cursor:"move"},position:function(t,e){this.vel.attr({cx:t,cy:e})},onPointerDown:function(t){t.stopPropagation();this.options.paper.undelegateEvents();this.delegateDocumentEvents(null,t.data);this.trigger("will-change")},onPointerMove:function(t){this.trigger("changing",this,t)},onDoubleClick:function(t){this.trigger("remove",this,t)},onPointerUp:function(t){this.trigger("changed",this,t);this.undelegateDocumentEvents();this.options.paper.delegateEvents()}});var l=o.extend({name:"vertices",options:{handleClass:s,snapRadius:20,redundancyRemoval:true,vertexAdding:true},children:[{tagName:"path",selector:"connection",className:"joint-vertices-path",attributes:{fill:"none",stroke:"transparent","stroke-width":10,cursor:"cell"}}],handles:null,events:{"mousedown .joint-vertices-path":"onPathPointerDown"},onRender:function(){this.resetHandles();if(this.options.vertexAdding){this.renderChildren();this.updatePath()}var t=this.relatedView;var e=t.model.vertices();for(var i=0,r=e.length;i<r;i++){var n=e[i];var a=new this.options.handleClass({index:i,paper:this.paper});a.render();a.position(n.x,n.y);this.simulateRelatedView(a.el);a.vel.appendTo(this.el);this.handles.push(a);this.startHandleListening(a)}return this},update:function(){this.render();return this},updatePath:function(){var t=this.childNodes.connection;if(t)t.setAttribute("d",this.relatedView.getConnection().serialize())},startHandleListening:function(t){var e=this.relatedView;if(e.can("vertexMove")){this.listenTo(t,"will-change",this.onHandleWillChange);this.listenTo(t,"changing",this.onHandleChanging);this.listenTo(t,"changed",this.onHandleChanged)}if(e.can("vertexRemove")){this.listenTo(t,"remove",this.onHandleRemove)}},resetHandles:function(){var t=this.handles;this.handles=[];this.stopListening();if(!Array.isArray(t))return;for(var e=0,i=t.length;e<i;e++){t[e].remove()}},getNeighborPoints:function(t){var e=this.relatedView;var i=e.model.vertices();var n=t>0?i[t-1]:e.sourceAnchor;var a=t<i.length-1?i[t+1]:e.targetAnchor;return{prev:new r.Point(n),next:new r.Point(a)}},onHandleWillChange:function(t,e){this.focus();this.relatedView.model.startBatch("vertex-move",{ui:true,tool:this.cid})},onHandleChanging:function(t,e){var i=this.relatedView;var r=i.paper;var n=t.options.index;var a=r.snapToGrid(e.clientX,e.clientY).toJSON();this.snapVertex(a,n);i.model.vertex(n,a,{ui:true,tool:this.cid});t.position(a.x,a.y)},snapVertex:function(t,e){var i=this.options.snapRadius;if(i>0){var r=this.getNeighborPoints(e);var n=r.prev;var a=r.next;if(Math.abs(t.x-n.x)<i){t.x=n.x}else if(Math.abs(t.x-a.x)<i){t.x=a.x}if(Math.abs(t.y-n.y)<i){t.y=r.prev.y}else if(Math.abs(t.y-a.y)<i){t.y=a.y}}},onHandleChanged:function(t,e){if(this.options.vertexAdding)this.updatePath();if(!this.options.redundancyRemoval)return;var i=this.relatedView;var r=i.removeRedundantLinearVertices({ui:true,tool:this.cid});if(r)this.render();this.blur();i.model.stopBatch("vertex-move",{ui:true,tool:this.cid});if(this.eventData(e).vertexAdded){i.model.stopBatch("vertex-add",{ui:true,tool:this.cid})}},onHandleRemove:function(t){var e=t.options.index;this.relatedView.model.removeVertex(e,{ui:true})},onPathPointerDown:function(t){t.stopPropagation();var e=this.paper.snapToGrid(t.clientX,t.clientY).toJSON();var i=this.relatedView;i.model.startBatch("vertex-add",{ui:true,tool:this.cid});var r=i.getVertexIndex(e.x,e.y);this.snapVertex(e,r);i.model.insertVertex(r,e,{ui:true,tool:this.cid});this.render();var n=this.handles[r];this.eventData(t,{vertexAdded:true});n.onPointerDown(t)},onRemove:function(){this.resetHandles()}},{VertexHandle:s});var c=t.mvc.View.extend({tagName:"g",svgElement:true,className:"marker-segment",events:{mousedown:"onPointerDown",touchstart:"onPointerDown"},documentEvents:{mousemove:"onPointerMove",touchmove:"onPointerMove",mouseup:"onPointerUp",touchend:"onPointerUp"},children:[{tagName:"line",selector:"line",attributes:{stroke:"#33334F","stroke-width":2,fill:"none","pointer-events":"none"}},{tagName:"rect",selector:"handle",attributes:{width:20,height:8,x:-10,y:-4,rx:4,ry:4,fill:"#33334F",stroke:"#FFFFFF","stroke-width":2}}],onRender:function(){this.renderChildren()},position:function(t,e,n,a){var o=i.createSVGMatrix().translate(t,e).rotate(n);var s=this.childNodes.handle;s.setAttribute("transform",i.matrixToTransformString(o));s.setAttribute("cursor",n%180===0?"row-resize":"col-resize");var l=a.getClosestPoint(new r.Point(t,e));var c=this.childNodes.line;c.setAttribute("x1",t);c.setAttribute("y1",e);c.setAttribute("x2",l.x);c.setAttribute("y2",l.y)},onPointerDown:function(t){this.trigger("change:start",this,t);t.stopPropagation();this.options.paper.undelegateEvents();this.delegateDocumentEvents(null,t.data)},onPointerMove:function(t){this.trigger("changing",this,t)},onPointerUp:function(t){this.undelegateDocumentEvents();this.options.paper.delegateEvents();this.trigger("change:end",this,t)},show:function(){this.el.style.display=""},hide:function(){this.el.style.display="none"}});var u=o.extend({name:"segments",precision:.5,options:{handleClass:c,segmentLengthThreshold:40,redundancyRemoval:true,anchor:n,snapRadius:10,snapHandle:true},handles:null,onRender:function(){this.resetHandles();var t=this.relatedView;var e=t.model.vertices();e.unshift(t.sourcePoint);e.push(t.targetPoint);for(var i=0,r=e.length;i<r-1;i++){var n=e[i];var a=e[i+1];var o=this.renderHandle(n,a);this.simulateRelatedView(o.el);this.handles.push(o);o.options.index=i}return this},renderHandle:function(t,e){var i=new this.options.handleClass({paper:this.paper});i.render();this.updateHandle(i,t,e);i.vel.appendTo(this.el);this.startHandleListening(i);return i},update:function(){this.render();return this},startHandleListening:function(t){this.listenTo(t,"change:start",this.onHandleChangeStart);this.listenTo(t,"changing",this.onHandleChanging);this.listenTo(t,"change:end",this.onHandleChangeEnd)},resetHandles:function(){var t=this.handles;this.handles=[];this.stopListening();if(!Array.isArray(t))return;for(var e=0,i=t.length;e<i;e++){t[e].remove()}},shiftHandleIndexes:function(t){var e=this.handles;for(var i=0,r=e.length;i<r;i++)e[i].options.index+=t},resetAnchor:function(t,e){var i=this.relatedView.model;if(e){i.prop([t,"anchor"],e,{rewrite:true,ui:true,tool:this.cid})}else{i.removeProp([t,"anchor"],{ui:true,tool:this.cid})}},snapHandle:function(t,e,i){var r=t.options.index;var n=this.relatedView;var a=n.model;var o=a.vertices();var s=t.options.axis;var l=o[r-2]||i.sourceAnchor;var c=o[r+1]||i.targetAnchor;var u=this.options.snapRadius;if(Math.abs(e[s]-l[s])<u){e[s]=l[s]}else if(Math.abs(e[s]-c[s])<u){e[s]=c[s]}return e},onHandleChanging:function(t,i){var r=this.eventData(i);var n=this.relatedView;var a=n.paper;var o=t.options.index-1;var s=a.snapToGrid(i.clientX,i.clientY);var l=this.snapHandle(t,s.clone(),r);var c=t.options.axis;var u=this.options.snapHandle?0:s[c]-l[c];var g=n.model;var h=e.cloneDeep(g.vertices());var d=h[o];var f=h[o+1];var v=this.options.anchor;if(typeof v!=="function")v=null;var p=n.sourceView;var I=n.sourceBBox;var m=false;var A=false;if(!d){d=n.sourceAnchor.toJSON();d[c]=l[c];if(I.containsPoint(d)){d[c]=l[c];m=true}else{h.unshift(d);this.shiftHandleIndexes(1);delateSourceAnchor=true}}else if(o===0){if(I.containsPoint(d)){h.shift();this.shiftHandleIndexes(-1);m=true}else{d[c]=l[c];A=true}}else{d[c]=l[c]}if(v&&p){if(m){var C=r.sourceAnchor.clone();C[c]=l[c];var w=v.call(n,C,p,n.sourceMagnet||p.el,"source",n);this.resetAnchor("source",w)}if(A){this.resetAnchor("source",r.sourceAnchorDef)}}var b=n.targetView;var y=n.targetBBox;var N=false;var M=false;if(!f){f=n.targetAnchor.toJSON();f[c]=l[c];if(y.containsPoint(f)){N=true}else{h.push(f);M=true}}else if(o===h.length-2){if(y.containsPoint(f)){h.pop();N=true}else{f[c]=l[c];M=true}}else{f[c]=l[c]}if(v&&b){if(N){var x=r.targetAnchor.clone();x[c]=l[c];var k=v.call(n,x,b,n.targetMagnet||b.el,"target",n);this.resetAnchor("target",k)}if(M){this.resetAnchor("target",r.targetAnchorDef)}}g.vertices(h,{ui:true,tool:this.cid});this.updateHandle(t,d,f,u)},onHandleChangeStart:function(t,i){var r=t.options.index;var n=this.handles;if(!Array.isArray(n))return;for(var a=0,o=n.length;a<o;a++){if(a!==r)n[a].hide()}this.focus();var s=this.relatedView;var l=s.model;this.eventData(i,{sourceAnchor:s.sourceAnchor.clone(),targetAnchor:s.targetAnchor.clone(),sourceAnchorDef:e.clone(l.prop(["source","anchor"])),targetAnchorDef:e.clone(l.prop(["target","anchor"]))});s.model.startBatch("segment-move",{ui:true,tool:this.cid})},onHandleChangeEnd:function(t){var e=this.relatedView;if(this.options.redundancyRemoval){e.removeRedundantLinearVertices({ui:true,tool:this.cid})}this.render();this.blur();e.model.stopBatch("segment-move",{ui:true,tool:this.cid})},updateHandle:function(t,e,i,n){var a=Math.abs(e.x-i.x)<this.precision;var o=Math.abs(e.y-i.y)<this.precision;if(a||o){var s=new r.Line(e,i);var l=s.length();if(l<this.options.segmentLengthThreshold){t.hide()}else{var c=s.midpoint();var u=a?"x":"y";c[u]+=n||0;var g=s.vector().vectorAngle(new r.Point(1,0));t.position(c.x,c.y,g,this.relatedView);t.show();t.options.axis=u}}else{t.hide()}},onRemove:function(){this.resetHandles()}},{SegmentHandle:c});var g=o.extend({tagName:"path",xAxisVector:new r.Point(1,0),events:{mousedown:"onPointerDown",touchstart:"onPointerDown"},documentEvents:{mousemove:"onPointerMove",touchmove:"onPointerMove",mouseup:"onPointerUp",touchend:"onPointerUp"},onRender:function(){this.update()},update:function(){var t=this.ratio;var e=this.relatedView;var r=e.getTangentAtRatio(t);var n,a;if(r){n=r.start;a=r.vector().vectorAngle(this.xAxisVector)||0}else{n=e.getPointAtRatio(t);a=0}var o=i.createSVGMatrix().translate(n.x,n.y).rotate(a);this.vel.transform(o,{absolute:true});return this},onPointerDown:function(t){t.stopPropagation();var e=this.relatedView;e.model.startBatch("arrowhead-move",{ui:true,tool:this.cid});if(e.can("arrowheadMove")){e.startArrowheadMove(this.arrowheadType);this.delegateDocumentEvents();e.paper.undelegateEvents()}this.focus();this.el.style.pointerEvents="none"},onPointerMove:function(t){var e=this.paper.snapToGrid(t.clientX,t.clientY);this.relatedView.pointermove(t,e.x,e.y)},onPointerUp:function(t){this.undelegateDocumentEvents();var e=this.relatedView;var i=e.paper;var r=i.snapToGrid(t.clientX,t.clientY);e.pointerup(t,r.x,r.y);i.delegateEvents();this.blur();this.el.style.pointerEvents="";e.model.stopBatch("arrowhead-move",{ui:true,tool:this.cid})}});var h=g.extend({name:"target-arrowhead",ratio:1,arrowheadType:"target",attributes:{d:"M -10 -8 10 0 -10 8 Z",fill:"#33334F",stroke:"#FFFFFF","stroke-width":2,cursor:"move",class:"target-arrowhead"}});var d=g.extend({name:"source-arrowhead",ratio:0,arrowheadType:"source",attributes:{d:"M 10 -8 -10 0 10 8 Z",fill:"#33334F",stroke:"#FFFFFF","stroke-width":2,cursor:"move",class:"source-arrowhead"}});var f=o.extend({name:"button",events:{mousedown:"onPointerDown",touchstart:"onPointerDown"},options:{distance:0,offset:0,rotate:false},onRender:function(){this.renderChildren(this.options.markup);this.update()},update:function(){var t,n,a;var o=this.options.distance||0;if(e.isPercentage(o)){t=this.relatedView.getTangentAtRatio(parseFloat(o)/100)}else{t=this.relatedView.getTangentAtLength(o)}if(t){n=t.start;a=t.vector().vectorAngle(new r.Point(1,0))||0}else{n=this.relatedView.getConnection().start;a=0}var s=i.createSVGMatrix().translate(n.x,n.y).rotate(a).translate(0,this.options.offset||0);if(!this.options.rotate)s=s.rotate(-a);this.vel.transform(s,{absolute:true});return this},onPointerDown:function(t){t.stopPropagation();var e=this.options.action;if(typeof e==="function"){e.call(this.relatedView,t,this.relatedView)}}});var v=f.extend({children:[{tagName:"circle",selector:"button",attributes:{r:7,fill:"#FF1D00",cursor:"pointer"}},{tagName:"path",selector:"icon",attributes:{d:"M -3 -3 3 3 M -3 3 3 -3",fill:"none",stroke:"#FFFFFF","stroke-width":2,"pointer-events":"none"}}],options:{distance:60,offset:0,action:function(t){this.model.remove({ui:true,tool:this.cid})}}});var p=o.extend({name:"boundary",tagName:"rect",options:{padding:10},attributes:{fill:"none",stroke:"#33334F","stroke-width":.5,"stroke-dasharray":"5, 5","pointer-events":"none"},onRender:function(){this.update()},update:function(){var t=this.options.padding;if(!isFinite(t))t=0;var e=this.relatedView.getConnection().bbox().inflate(t);this.vel.attr(e.toJSON());return this}});var I=o.extend({tagName:"g",type:null,children:[{tagName:"circle",selector:"anchor",attributes:{cursor:"pointer"}},{tagName:"rect",selector:"area",attributes:{"pointer-events":"none",fill:"none",stroke:"#33334F","stroke-dasharray":"2,4",rx:5,ry:5}}],events:{mousedown:"onPointerDown",touchstart:"onPointerDown",dblclick:"onPointerDblClick"},documentEvents:{mousemove:"onPointerMove",touchmove:"onPointerMove",mouseup:"onPointerUp",touchend:"onPointerUp"},options:{snap:a,anchor:n,customAnchorAttributes:{"stroke-width":4,stroke:"#33334F",fill:"#FFFFFF",r:5},defaultAnchorAttributes:{"stroke-width":2,stroke:"#FFFFFF",fill:"#33334F",r:6},areaPadding:6,snapRadius:10,restrictArea:true,redundancyRemoval:true},onRender:function(){this.renderChildren();this.toggleArea(false);this.update()},update:function(){var t=this.type;var e=this.relatedView;var i=e.getEndView(t);if(i){this.updateAnchor();this.updateArea();this.el.style.display=""}else{this.el.style.display="none"}return this},updateAnchor:function(){var t=this.childNodes;if(!t)return;var e=t.anchor;if(!e)return;var i=this.relatedView;var r=this.type;var n=i.getEndAnchor(r);var a=this.options;var o=i.model.prop([r,"anchor"]);e.setAttribute("transform","translate("+n.x+","+n.y+")");var s=o?a.customAnchorAttributes:a.defaultAnchorAttributes;for(var l in s){e.setAttribute(l,s[l])}},updateArea:function(){var t=this.childNodes;if(!t)return;var e=t.area;if(!e)return;var i=this.relatedView;var r=this.type;var n=i.getEndView(r);var a=i.getEndMagnet(r);var o=this.options.areaPadding;if(!isFinite(o))o=0;var s=n.getNodeUnrotatedBBox(a).inflate(o);var l=n.model.angle();e.setAttribute("x",-s.width/2);e.setAttribute("y",-s.height/2);e.setAttribute("width",s.width);e.setAttribute("height",s.height);var c=n.model.getBBox().center();var u=s.center().rotate(c,-l);e.setAttribute("transform","translate("+u.x+","+u.y+") rotate("+l+")")},toggleArea:function(t){this.childNodes.area.style.display=t?"":"none"},onPointerDown:function(t){t.stopPropagation();this.paper.undelegateEvents();this.delegateDocumentEvents();this.focus();this.toggleArea(this.options.restrictArea);this.relatedView.model.startBatch("anchor-move",{ui:true,tool:this.cid})},resetAnchor:function(t){var e=this.type;var i=this.relatedView.model;if(t){i.prop([e,"anchor"],t,{rewrite:true,ui:true,tool:this.cid})}else{i.removeProp([e,"anchor"],{ui:true,tool:this.cid})}},onPointerMove:function(t){var e=this.relatedView;var i=this.type;var n=e.getEndView(i);var a=e.getEndMagnet(i);var o=this.paper.clientToLocalPoint(t.clientX,t.clientY);var s=this.options.snap;if(typeof s==="function"){o=s.call(e,o,n,a,i,e,this);o=new r.Point(o)}if(this.options.restrictArea){var l=n.getNodeUnrotatedBBox(a);var c=n.model.angle();var u=n.model.getBBox().center();var g=o.clone().rotate(u,c);if(!l.containsPoint(g)){o=l.pointNearestToPoint(g).rotate(u,-c)}}var h;var d=this.options.anchor;if(typeof d==="function"){h=d.call(e,o,n,a,i,e)}this.resetAnchor(h);this.update()},onPointerUp:function(t){this.paper.delegateEvents();this.undelegateDocumentEvents();this.blur();this.toggleArea(false);var e=this.relatedView;if(this.options.redundancyRemoval)e.removeRedundantLinearVertices({ui:true,tool:this.cid});e.model.stopBatch("anchor-move",{ui:true,tool:this.cid})},onPointerDblClick:function(){this.resetAnchor();this.update()}});var m=I.extend({name:"source-anchor",type:"source"});var A=I.extend({name:"target-anchor",type:"target"});t.linkTools={Vertices:l,Segments:u,SourceArrowhead:d,TargetArrowhead:h,SourceAnchor:m,TargetAnchor:A,Button:f,Remove:v,Boundary:p}})(s,s.util,a,n);s.dia.Element.define("erd.Entity",{size:{width:150,height:60},attrs:{".outer":{fill:"#2ECC71",stroke:"#27AE60","stroke-width":2,points:"100,0 100,60 0,60 0,0"},".inner":{fill:"#2ECC71",stroke:"#27AE60","stroke-width":2,points:"95,5 95,55 5,55 5,5",display:"none"},text:{text:"Entity","font-family":"Arial","font-size":14,"ref-x":.5,"ref-y":.5,"y-alignment":"middle","text-anchor":"middle"}}},{markup:'<g class="rotatable"><g class="scalable"><polygon class="outer"/><polygon class="inner"/></g><text/></g>'});s.shapes.erd.Entity.define("erd.WeakEntity",{attrs:{".inner":{display:"auto"},text:{text:"Weak Entity"}}});s.dia.Element.define("erd.Relationship",{size:{width:80,height:80},attrs:{".outer":{fill:"#3498DB",stroke:"#2980B9","stroke-width":2,points:"40,0 80,40 40,80 0,40"},".inner":{fill:"#3498DB",stroke:"#2980B9","stroke-width":2,points:"40,5 75,40 40,75 5,40",display:"none"},text:{text:"Relationship","font-family":"Arial","font-size":12,"ref-x":.5,"ref-y":.5,"y-alignment":"middle","text-anchor":"middle"}}},{markup:'<g class="rotatable"><g class="scalable"><polygon class="outer"/><polygon class="inner"/></g><text/></g>'});s.shapes.erd.Relationship.define("erd.IdentifyingRelationship",{attrs:{".inner":{display:"auto"},text:{text:"Identifying"}}});s.dia.Element.define("erd.Attribute",{size:{width:100,height:50},attrs:{ellipse:{transform:"translate(50, 25)"},".outer":{stroke:"#D35400","stroke-width":2,cx:0,cy:0,rx:50,ry:25,fill:"#E67E22"},".inner":{stroke:"#D35400","stroke-width":2,cx:0,cy:0,rx:45,ry:20,fill:"#E67E22",display:"none"},text:{"font-family":"Arial","font-size":14,"ref-x":.5,"ref-y":.5,"y-alignment":"middle","text-anchor":"middle"}}},{markup:'<g class="rotatable"><g class="scalable"><ellipse class="outer"/><ellipse class="inner"/></g><text/></g>'});s.shapes.erd.Attribute.define("erd.Multivalued",{attrs:{".inner":{display:"block"},text:{text:"multivalued"}}});s.shapes.erd.Attribute.define("erd.Derived",{attrs:{".outer":{"stroke-dasharray":"3,5"},text:{text:"derived"}}});s.shapes.erd.Attribute.define("erd.Key",{attrs:{ellipse:{"stroke-width":4},text:{text:"key","font-weight":"800","text-decoration":"underline"}}});s.shapes.erd.Attribute.define("erd.Normal",{attrs:{text:{text:"Normal"}}});s.dia.Element.define("erd.ISA",{type:"erd.ISA",size:{width:100,height:50},attrs:{polygon:{points:"0,0 50,50 100,0",fill:"#F1C40F",stroke:"#F39C12","stroke-width":2},text:{text:"ISA","font-size":18,"ref-x":.5,"ref-y":.3,"y-alignment":"middle","text-anchor":"middle"}}},{markup:'<g class="rotatable"><g class="scalable"><polygon/></g><text/></g>'});s.dia.Link.define("erd.Line",{},{cardinality:function(t){this.set("labels",[{position:-20,attrs:{text:{dy:-8,text:t}}}])}});s.shapes.basic.Circle.define("fsa.State",{attrs:{circle:{"stroke-width":3},text:{"font-weight":"800"}}});s.dia.Element.define("fsa.StartState",{size:{width:20,height:20},attrs:{circle:{transform:"translate(10, 10)",r:10,fill:"#000000"}}},{markup:'<g class="rotatable"><g class="scalable"><circle/></g></g>'});s.dia.Element.define("fsa.EndState",{size:{width:20,height:20},attrs:{".outer":{transform:"translate(10, 10)",r:10,fill:"#ffffff",stroke:"#000000"},".inner":{transform:"translate(10, 10)",r:6,fill:"#000000"}}},{markup:'<g class="rotatable"><g class="scalable"><circle class="outer"/><circle class="inner"/></g></g>'});s.dia.Link.define("fsa.Arrow",{attrs:{".marker-target":{d:"M 10 0 L 0 5 L 10 10 z"}},smooth:true});s.dia.Element.define("org.Member",{size:{width:180,height:70},attrs:{rect:{width:170,height:60},".card":{fill:"#FFFFFF",stroke:"#000000","stroke-width":2,"pointer-events":"visiblePainted",rx:10,ry:10},image:{width:48,height:48,ref:".card","ref-x":10,"ref-y":5},".rank":{"text-decoration":"underline",ref:".card","ref-x":.9,"ref-y":.2,"font-family":"Courier New","font-size":14,"text-anchor":"end"},".name":{"font-weight":"800",ref:".card","ref-x":.9,"ref-y":.6,"font-family":"Courier New","font-size":14,"text-anchor":"end"}}},{markup:'<g class="rotatable"><g class="scalable"><rect class="card"/><image/></g><text class="rank"/><text class="name"/></g>'});s.dia.Link.define("org.Arrow",{source:{selector:".card"},target:{selector:".card"},attrs:{".connection":{stroke:"#585858","stroke-width":3}},z:-1});s.shapes.basic.Generic.define("chess.KingWhite",{size:{width:42,height:38}},{markup:'<g class="rotatable"><g class="scalable"><g style="fill:none; fill-opacity:1; fill-rule:evenodd; stroke:#000000; stroke-width:1.5; stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4; stroke-dasharray:none; stroke-opacity:1;"><path      d="M 22.5,11.63 L 22.5,6"      style="fill:none; stroke:#000000; stroke-linejoin:miter;" />    <path      d="M 20,8 L 25,8"      style="fill:none; stroke:#000000; stroke-linejoin:miter;" />    <path      d="M 22.5,25 C 22.5,25 27,17.5 25.5,14.5 C 25.5,14.5 24.5,12 22.5,12 C 20.5,12 19.5,14.5 19.5,14.5 C 18,17.5 22.5,25 22.5,25"      style="fill:#ffffff; stroke:#000000; stroke-linecap:butt; stroke-linejoin:miter;" />    <path      d="M 11.5,37 C 17,40.5 27,40.5 32.5,37 L 32.5,30 C 32.5,30 41.5,25.5 38.5,19.5 C 34.5,13 25,16 22.5,23.5 L 22.5,27 L 22.5,23.5 C 19,16 9.5,13 6.5,19.5 C 3.5,25.5 11.5,29.5 11.5,29.5 L 11.5,37 z "      style="fill:#ffffff; stroke:#000000;" />    <path      d="M 11.5,30 C 17,27 27,27 32.5,30"      style="fill:none; stroke:#000000;" />    <path      d="M 11.5,33.5 C 17,30.5 27,30.5 32.5,33.5"      style="fill:none; stroke:#000000;" />    <path      d="M 11.5,37 C 17,34 27,34 32.5,37"      style="fill:none; stroke:#000000;" />  </g></g></g>'});s.shapes.basic.Generic.define("chess.KingBlack",{size:{width:42,height:38}},{markup:'<g class="rotatable"><g class="scalable"><g style="fill:none; fill-opacity:1; fill-rule:evenodd; stroke:#000000; stroke-width:1.5; stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4; stroke-dasharray:none; stroke-opacity:1;">    <path       d="M 22.5,11.63 L 22.5,6"       style="fill:none; stroke:#000000; stroke-linejoin:miter;"       id="path6570" />    <path       d="M 22.5,25 C 22.5,25 27,17.5 25.5,14.5 C 25.5,14.5 24.5,12 22.5,12 C 20.5,12 19.5,14.5 19.5,14.5 C 18,17.5 22.5,25 22.5,25"       style="fill:#000000;fill-opacity:1; stroke-linecap:butt; stroke-linejoin:miter;" />    <path       d="M 11.5,37 C 17,40.5 27,40.5 32.5,37 L 32.5,30 C 32.5,30 41.5,25.5 38.5,19.5 C 34.5,13 25,16 22.5,23.5 L 22.5,27 L 22.5,23.5 C 19,16 9.5,13 6.5,19.5 C 3.5,25.5 11.5,29.5 11.5,29.5 L 11.5,37 z "       style="fill:#000000; stroke:#000000;" />    <path       d="M 20,8 L 25,8"       style="fill:none; stroke:#000000; stroke-linejoin:miter;" />    <path       d="M 32,29.5 C 32,29.5 40.5,25.5 38.03,19.85 C 34.15,14 25,18 22.5,24.5 L 22.51,26.6 L 22.5,24.5 C 20,18 9.906,14 6.997,19.85 C 4.5,25.5 11.85,28.85 11.85,28.85"       style="fill:none; stroke:#ffffff;" />    <path       d="M 11.5,30 C 17,27 27,27 32.5,30 M 11.5,33.5 C 17,30.5 27,30.5 32.5,33.5 M 11.5,37 C 17,34 27,34 32.5,37"       style="fill:none; stroke:#ffffff;" />  </g></g></g>'});s.shapes.basic.Generic.define("chess.QueenWhite",{size:{width:42,height:38}},{markup:'<g class="rotatable"><g class="scalable"><g style="opacity:1; fill:#ffffff; fill-opacity:1; fill-rule:evenodd; stroke:#000000; stroke-width:1.5; stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4; stroke-dasharray:none; stroke-opacity:1;">    <path      d="M 9 13 A 2 2 0 1 1  5,13 A 2 2 0 1 1  9 13 z"      transform="translate(-1,-1)" />    <path      d="M 9 13 A 2 2 0 1 1  5,13 A 2 2 0 1 1  9 13 z"      transform="translate(15.5,-5.5)" />    <path      d="M 9 13 A 2 2 0 1 1  5,13 A 2 2 0 1 1  9 13 z"      transform="translate(32,-1)" />    <path      d="M 9 13 A 2 2 0 1 1  5,13 A 2 2 0 1 1  9 13 z"      transform="translate(7,-4.5)" />    <path      d="M 9 13 A 2 2 0 1 1  5,13 A 2 2 0 1 1  9 13 z"      transform="translate(24,-4)" />    <path      d="M 9,26 C 17.5,24.5 30,24.5 36,26 L 38,14 L 31,25 L 31,11 L 25.5,24.5 L 22.5,9.5 L 19.5,24.5 L 14,10.5 L 14,25 L 7,14 L 9,26 z "      style="stroke-linecap:butt;" />    <path      d="M 9,26 C 9,28 10.5,28 11.5,30 C 12.5,31.5 12.5,31 12,33.5 C 10.5,34.5 10.5,36 10.5,36 C 9,37.5 11,38.5 11,38.5 C 17.5,39.5 27.5,39.5 34,38.5 C 34,38.5 35.5,37.5 34,36 C 34,36 34.5,34.5 33,33.5 C 32.5,31 32.5,31.5 33.5,30 C 34.5,28 36,28 36,26 C 27.5,24.5 17.5,24.5 9,26 z "      style="stroke-linecap:butt;" />    <path      d="M 11.5,30 C 15,29 30,29 33.5,30"      style="fill:none;" />    <path      d="M 12,33.5 C 18,32.5 27,32.5 33,33.5"      style="fill:none;" />  </g></g></g>'});s.shapes.basic.Generic.define("chess.QueenBlack",{size:{width:42,height:38}},{markup:'<g class="rotatable"><g class="scalable"><g style="opacity:1; fill:#000000; fill-opacity:1; fill-rule:evenodd; stroke:#000000; stroke-width:1.5; stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4; stroke-dasharray:none; stroke-opacity:1;">    <g style="fill:#000000; stroke:none;">      <circle cx="6"    cy="12" r="2.75" />      <circle cx="14"   cy="9"  r="2.75" />      <circle cx="22.5" cy="8"  r="2.75" />      <circle cx="31"   cy="9"  r="2.75" />      <circle cx="39"   cy="12" r="2.75" />    </g>    <path       d="M 9,26 C 17.5,24.5 30,24.5 36,26 L 38.5,13.5 L 31,25 L 30.7,10.9 L 25.5,24.5 L 22.5,10 L 19.5,24.5 L 14.3,10.9 L 14,25 L 6.5,13.5 L 9,26 z"       style="stroke-linecap:butt; stroke:#000000;" />    <path       d="M 9,26 C 9,28 10.5,28 11.5,30 C 12.5,31.5 12.5,31 12,33.5 C 10.5,34.5 10.5,36 10.5,36 C 9,37.5 11,38.5 11,38.5 C 17.5,39.5 27.5,39.5 34,38.5 C 34,38.5 35.5,37.5 34,36 C 34,36 34.5,34.5 33,33.5 C 32.5,31 32.5,31.5 33.5,30 C 34.5,28 36,28 36,26 C 27.5,24.5 17.5,24.5 9,26 z"       style="stroke-linecap:butt;" />    <path       d="M 11,38.5 A 35,35 1 0 0 34,38.5"       style="fill:none; stroke:#000000; stroke-linecap:butt;" />    <path       d="M 11,29 A 35,35 1 0 1 34,29"       style="fill:none; stroke:#ffffff;" />    <path       d="M 12.5,31.5 L 32.5,31.5"       style="fill:none; stroke:#ffffff;" />    <path       d="M 11.5,34.5 A 35,35 1 0 0 33.5,34.5"       style="fill:none; stroke:#ffffff;" />    <path       d="M 10.5,37.5 A 35,35 1 0 0 34.5,37.5"       style="fill:none; stroke:#ffffff;" />  </g></g></g>'});s.shapes.basic.Generic.define("chess.RookWhite",{size:{width:32,height:34}},{markup:'<g class="rotatable"><g class="scalable"><g style="opacity:1; fill:#ffffff; fill-opacity:1; fill-rule:evenodd; stroke:#000000; stroke-width:1.5; stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4; stroke-dasharray:none; stroke-opacity:1;">    <path      d="M 9,39 L 36,39 L 36,36 L 9,36 L 9,39 z "      style="stroke-linecap:butt;" />    <path      d="M 12,36 L 12,32 L 33,32 L 33,36 L 12,36 z "      style="stroke-linecap:butt;" />    <path      d="M 11,14 L 11,9 L 15,9 L 15,11 L 20,11 L 20,9 L 25,9 L 25,11 L 30,11 L 30,9 L 34,9 L 34,14"      style="stroke-linecap:butt;" />    <path      d="M 34,14 L 31,17 L 14,17 L 11,14" />    <path      d="M 31,17 L 31,29.5 L 14,29.5 L 14,17"      style="stroke-linecap:butt; stroke-linejoin:miter;" />    <path      d="M 31,29.5 L 32.5,32 L 12.5,32 L 14,29.5" />    <path      d="M 11,14 L 34,14"      style="fill:none; stroke:#000000; stroke-linejoin:miter;" />  </g></g></g>'});s.shapes.basic.Generic.define("chess.RookBlack",{size:{width:32,height:34}},{markup:'<g class="rotatable"><g class="scalable"><g style="opacity:1; fill:#000000; fill-opacity:1; fill-rule:evenodd; stroke:#000000; stroke-width:1.5; stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4; stroke-dasharray:none; stroke-opacity:1;">    <path      d="M 9,39 L 36,39 L 36,36 L 9,36 L 9,39 z "      style="stroke-linecap:butt;" />    <path      d="M 12.5,32 L 14,29.5 L 31,29.5 L 32.5,32 L 12.5,32 z "      style="stroke-linecap:butt;" />    <path      d="M 12,36 L 12,32 L 33,32 L 33,36 L 12,36 z "      style="stroke-linecap:butt;" />    <path      d="M 14,29.5 L 14,16.5 L 31,16.5 L 31,29.5 L 14,29.5 z "      style="stroke-linecap:butt;stroke-linejoin:miter;" />    <path      d="M 14,16.5 L 11,14 L 34,14 L 31,16.5 L 14,16.5 z "      style="stroke-linecap:butt;" />    <path      d="M 11,14 L 11,9 L 15,9 L 15,11 L 20,11 L 20,9 L 25,9 L 25,11 L 30,11 L 30,9 L 34,9 L 34,14 L 11,14 z "      style="stroke-linecap:butt;" />    <path      d="M 12,35.5 L 33,35.5 L 33,35.5"      style="fill:none; stroke:#ffffff; stroke-width:1; stroke-linejoin:miter;" />    <path      d="M 13,31.5 L 32,31.5"      style="fill:none; stroke:#ffffff; stroke-width:1; stroke-linejoin:miter;" />    <path      d="M 14,29.5 L 31,29.5"      style="fill:none; stroke:#ffffff; stroke-width:1; stroke-linejoin:miter;" />    <path      d="M 14,16.5 L 31,16.5"      style="fill:none; stroke:#ffffff; stroke-width:1; stroke-linejoin:miter;" />    <path      d="M 11,14 L 34,14"      style="fill:none; stroke:#ffffff; stroke-width:1; stroke-linejoin:miter;" />  </g></g></g>'});s.shapes.basic.Generic.define("chess.BishopWhite",{size:{width:38,height:38}},{markup:'<g class="rotatable"><g class="scalable"><g style="opacity:1; fill:none; fill-rule:evenodd; fill-opacity:1; stroke:#000000; stroke-width:1.5; stroke-linecap:round; stroke-linejoin:round; stroke-miterlimit:4; stroke-dasharray:none; stroke-opacity:1;">    <g style="fill:#ffffff; stroke:#000000; stroke-linecap:butt;">       <path        d="M 9,36 C 12.39,35.03 19.11,36.43 22.5,34 C 25.89,36.43 32.61,35.03 36,36 C 36,36 37.65,36.54 39,38 C 38.32,38.97 37.35,38.99 36,38.5 C 32.61,37.53 25.89,38.96 22.5,37.5 C 19.11,38.96 12.39,37.53 9,38.5 C 7.646,38.99 6.677,38.97 6,38 C 7.354,36.06 9,36 9,36 z" />      <path        d="M 15,32 C 17.5,34.5 27.5,34.5 30,32 C 30.5,30.5 30,30 30,30 C 30,27.5 27.5,26 27.5,26 C 33,24.5 33.5,14.5 22.5,10.5 C 11.5,14.5 12,24.5 17.5,26 C 17.5,26 15,27.5 15,30 C 15,30 14.5,30.5 15,32 z" />      <path        d="M 25 8 A 2.5 2.5 0 1 1  20,8 A 2.5 2.5 0 1 1  25 8 z" />    </g>    <path      d="M 17.5,26 L 27.5,26 M 15,30 L 30,30 M 22.5,15.5 L 22.5,20.5 M 20,18 L 25,18"      style="fill:none; stroke:#000000; stroke-linejoin:miter;" />  </g></g></g>'});s.shapes.basic.Generic.define("chess.BishopBlack",{size:{width:38,height:38}},{markup:'<g class="rotatable"><g class="scalable"><g style="opacity:1; fill:none; fill-rule:evenodd; fill-opacity:1; stroke:#000000; stroke-width:1.5; stroke-linecap:round; stroke-linejoin:round; stroke-miterlimit:4; stroke-dasharray:none; stroke-opacity:1;">    <g style="fill:#000000; stroke:#000000; stroke-linecap:butt;">       <path        d="M 9,36 C 12.39,35.03 19.11,36.43 22.5,34 C 25.89,36.43 32.61,35.03 36,36 C 36,36 37.65,36.54 39,38 C 38.32,38.97 37.35,38.99 36,38.5 C 32.61,37.53 25.89,38.96 22.5,37.5 C 19.11,38.96 12.39,37.53 9,38.5 C 7.646,38.99 6.677,38.97 6,38 C 7.354,36.06 9,36 9,36 z" />      <path        d="M 15,32 C 17.5,34.5 27.5,34.5 30,32 C 30.5,30.5 30,30 30,30 C 30,27.5 27.5,26 27.5,26 C 33,24.5 33.5,14.5 22.5,10.5 C 11.5,14.5 12,24.5 17.5,26 C 17.5,26 15,27.5 15,30 C 15,30 14.5,30.5 15,32 z" />      <path        d="M 25 8 A 2.5 2.5 0 1 1  20,8 A 2.5 2.5 0 1 1  25 8 z" />    </g>    <path       d="M 17.5,26 L 27.5,26 M 15,30 L 30,30 M 22.5,15.5 L 22.5,20.5 M 20,18 L 25,18"       style="fill:none; stroke:#ffffff; stroke-linejoin:miter;" />  </g></g></g>'});s.shapes.basic.Generic.define("chess.KnightWhite",{size:{width:38,height:37}},{markup:'<g class="rotatable"><g class="scalable"><g style="opacity:1; fill:none; fill-opacity:1; fill-rule:evenodd; stroke:#000000; stroke-width:1.5; stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4; stroke-dasharray:none; stroke-opacity:1;">    <path      d="M 22,10 C 32.5,11 38.5,18 38,39 L 15,39 C 15,30 25,32.5 23,18"      style="fill:#ffffff; stroke:#000000;" />    <path      d="M 24,18 C 24.38,20.91 18.45,25.37 16,27 C 13,29 13.18,31.34 11,31 C 9.958,30.06 12.41,27.96 11,28 C 10,28 11.19,29.23 10,30 C 9,30 5.997,31 6,26 C 6,24 12,14 12,14 C 12,14 13.89,12.1 14,10.5 C 13.27,9.506 13.5,8.5 13.5,7.5 C 14.5,6.5 16.5,10 16.5,10 L 18.5,10 C 18.5,10 19.28,8.008 21,7 C 22,7 22,10 22,10"      style="fill:#ffffff; stroke:#000000;" />    <path      d="M 9.5 25.5 A 0.5 0.5 0 1 1 8.5,25.5 A 0.5 0.5 0 1 1 9.5 25.5 z"      style="fill:#000000; stroke:#000000;" />    <path      d="M 15 15.5 A 0.5 1.5 0 1 1  14,15.5 A 0.5 1.5 0 1 1  15 15.5 z"      transform="matrix(0.866,0.5,-0.5,0.866,9.693,-5.173)"      style="fill:#000000; stroke:#000000;" />  </g></g></g>'});s.shapes.basic.Generic.define("chess.KnightBlack",{size:{width:38,height:37}},{markup:'<g class="rotatable"><g class="scalable"><g style="opacity:1; fill:none; fill-opacity:1; fill-rule:evenodd; stroke:#000000; stroke-width:1.5; stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4; stroke-dasharray:none; stroke-opacity:1;">    <path      d="M 22,10 C 32.5,11 38.5,18 38,39 L 15,39 C 15,30 25,32.5 23,18"      style="fill:#000000; stroke:#000000;" />    <path      d="M 24,18 C 24.38,20.91 18.45,25.37 16,27 C 13,29 13.18,31.34 11,31 C 9.958,30.06 12.41,27.96 11,28 C 10,28 11.19,29.23 10,30 C 9,30 5.997,31 6,26 C 6,24 12,14 12,14 C 12,14 13.89,12.1 14,10.5 C 13.27,9.506 13.5,8.5 13.5,7.5 C 14.5,6.5 16.5,10 16.5,10 L 18.5,10 C 18.5,10 19.28,8.008 21,7 C 22,7 22,10 22,10"      style="fill:#000000; stroke:#000000;" />    <path      d="M 9.5 25.5 A 0.5 0.5 0 1 1 8.5,25.5 A 0.5 0.5 0 1 1 9.5 25.5 z"      style="fill:#ffffff; stroke:#ffffff;" />    <path      d="M 15 15.5 A 0.5 1.5 0 1 1  14,15.5 A 0.5 1.5 0 1 1  15 15.5 z"      transform="matrix(0.866,0.5,-0.5,0.866,9.693,-5.173)"      style="fill:#ffffff; stroke:#ffffff;" />    <path      d="M 24.55,10.4 L 24.1,11.85 L 24.6,12 C 27.75,13 30.25,14.49 32.5,18.75 C 34.75,23.01 35.75,29.06 35.25,39 L 35.2,39.5 L 37.45,39.5 L 37.5,39 C 38,28.94 36.62,22.15 34.25,17.66 C 31.88,13.17 28.46,11.02 25.06,10.5 L 24.55,10.4 z "      style="fill:#ffffff; stroke:none;" />  </g></g></g>'});s.shapes.basic.Generic.define("chess.PawnWhite",{size:{width:28,height:33}},{markup:'<g class="rotatable"><g class="scalable"><path d="M 22,9 C 19.79,9 18,10.79 18,13 C 18,13.89 18.29,14.71 18.78,15.38 C 16.83,16.5 15.5,18.59 15.5,21 C 15.5,23.03 16.44,24.84 17.91,26.03 C 14.91,27.09 10.5,31.58 10.5,39.5 L 33.5,39.5 C 33.5,31.58 29.09,27.09 26.09,26.03 C 27.56,24.84 28.5,23.03 28.5,21 C 28.5,18.59 27.17,16.5 25.22,15.38 C 25.71,14.71 26,13.89 26,13 C 26,10.79 24.21,9 22,9 z "  style="opacity:1; fill:#ffffff; fill-opacity:1; fill-rule:nonzero; stroke:#000000; stroke-width:1.5; stroke-linecap:round; stroke-linejoin:miter; stroke-miterlimit:4; stroke-dasharray:none; stroke-opacity:1;" /></g></g>'});s.shapes.basic.Generic.define("chess.PawnBlack",{size:{width:28,height:33}},{markup:'<g class="rotatable"><g class="scalable"><path d="M 22,9 C 19.79,9 18,10.79 18,13 C 18,13.89 18.29,14.71 18.78,15.38 C 16.83,16.5 15.5,18.59 15.5,21 C 15.5,23.03 16.44,24.84 17.91,26.03 C 14.91,27.09 10.5,31.58 10.5,39.5 L 33.5,39.5 C 33.5,31.58 29.09,27.09 26.09,26.03 C 27.56,24.84 28.5,23.03 28.5,21 C 28.5,18.59 27.17,16.5 25.22,15.38 C 25.71,14.71 26,13.89 26,13 C 26,10.79 24.21,9 22,9 z "  style="opacity:1; fill:#000000; fill-opacity:1; fill-rule:nonzero; stroke:#000000; stroke-width:1.5; stroke-linecap:round; stroke-linejoin:miter; stroke-miterlimit:4; stroke-dasharray:none; stroke-opacity:1;" /></g></g>'});s.shapes.basic.Generic.define("pn.Place",{size:{width:50,height:50},attrs:{".root":{r:25,fill:"#ffffff",stroke:"#000000",transform:"translate(25, 25)"},".label":{"text-anchor":"middle","ref-x":.5,"ref-y":-20,ref:".root",fill:"#000000","font-size":12},".tokens > circle":{fill:"#000000",r:5},".tokens.one > circle":{transform:"translate(25, 25)"},".tokens.two > circle:nth-child(1)":{transform:"translate(19, 25)"},".tokens.two > circle:nth-child(2)":{transform:"translate(31, 25)"},".tokens.three > circle:nth-child(1)":{transform:"translate(18, 29)"},".tokens.three > circle:nth-child(2)":{transform:"translate(25, 19)"},".tokens.three > circle:nth-child(3)":{transform:"translate(32, 29)"},".tokens.alot > text":{transform:"translate(25, 18)","text-anchor":"middle",fill:"#000000"}}},{markup:'<g class="rotatable"><g class="scalable"><circle class="root"/><g class="tokens" /></g><text class="label"/></g>'});s.shapes.pn.PlaceView=s.dia.ElementView.extend({},{initialize:function(){s.dia.ElementView.prototype.initialize.apply(this,arguments);this.model.on("change:tokens",function(){this.renderTokens();this.update()},this)},render:function(){s.dia.ElementView.prototype.render.apply(this,arguments);this.renderTokens();this.update()},renderTokens:function(){var t=this.$(".tokens").empty();t[0].className.baseVal="tokens";var e=this.model.get("tokens");if(!e)return;switch(e){case 1:t[0].className.baseVal+=" one";t.append(a("<circle/>").node);break;case 2:t[0].className.baseVal+=" two";t.append(a("<circle/>").node,a("<circle/>").node);break;case 3:t[0].className.baseVal+=" three";t.append(a("<circle/>").node,a("<circle/>").node,a("<circle/>").node);break;default:t[0].className.baseVal+=" alot";t.append(a("<text/>").text(e+"").node);break}}});s.shapes.basic.Generic.define("pn.Transition",{size:{width:12,height:50},attrs:{rect:{width:12,height:50,fill:"#000000",stroke:"#000000"},".label":{"text-anchor":"middle","ref-x":.5,"ref-y":-20,ref:"rect",fill:"#000000","font-size":12}}},{markup:'<g class="rotatable"><g class="scalable"><rect class="root"/></g></g><text class="label"/>'});s.dia.Link.define("pn.Link",{attrs:{".marker-target":{d:"M 10 0 L 0 5 L 10 10 z"}}});s.shapes.basic.Generic.define("devs.Model",{inPorts:[],outPorts:[],size:{width:80,height:80},attrs:{".":{magnet:false},".label":{text:"Model","ref-x":.5,"ref-y":10,"font-size":18,"text-anchor":"middle",fill:"#000"},".body":{"ref-width":"100%","ref-height":"100%",stroke:"#000"}},ports:{groups:{in:{position:{name:"left"},attrs:{".port-label":{fill:"#000"},".port-body":{fill:"#fff",stroke:"#000",r:10,magnet:true}},label:{position:{name:"left",args:{y:10}}}},out:{position:{name:"right"},attrs:{".port-label":{fill:"#000"},".port-body":{fill:"#fff",stroke:"#000",r:10,magnet:true}},label:{position:{name:"right",args:{y:10}}}}}}},{markup:'<g class="rotatable"><rect class="body"/><text class="label"/></g>',portMarkup:'<circle class="port-body"/>',portLabelMarkup:'<text class="port-label"/>',initialize:function(){s.shapes.basic.Generic.prototype.initialize.apply(this,arguments);this.on("change:inPorts change:outPorts",this.updatePortItems,this);this.updatePortItems()},updatePortItems:function(t,e,i){var r=s.util.uniq(this.get("inPorts"));var n=s.util.difference(s.util.uniq(this.get("outPorts")),r);var a=this.createPortItems("in",r);var o=this.createPortItems("out",n);this.prop("ports/items",a.concat(o),s.util.assign({rewrite:true},i))},createPortItem:function(t,e){return{id:e,group:t,attrs:{".port-label":{text:e}}}},createPortItems:function(t,e){return s.util.toArray(e).map(this.createPortItem.bind(this,t))},_addGroupPort:function(t,e,i){var r=this.get(e);return this.set(e,Array.isArray(r)?r.concat(t):[t],i)},addOutPort:function(t,e){return this._addGroupPort(t,"outPorts",e)},addInPort:function(t,e){return this._addGroupPort(t,"inPorts",e)},_removeGroupPort:function(t,e,i){return this.set(e,s.util.without(this.get(e),t),i)},removeOutPort:function(t,e){return this._removeGroupPort(t,"outPorts",e)},removeInPort:function(t,e){return this._removeGroupPort(t,"inPorts",e)},_changeGroup:function(t,e,i){return this.prop("ports/groups/"+t,s.util.isObject(e)?e:{},i)},changeInGroup:function(t,e){return this._changeGroup("in",t,e)},changeOutGroup:function(t,e){return this._changeGroup("out",t,e)}});s.shapes.devs.Model.define("devs.Atomic",{size:{width:80,height:80},attrs:{".label":{text:"Atomic"}}});s.shapes.devs.Model.define("devs.Coupled",{size:{width:200,height:300},attrs:{".label":{text:"Coupled"}}});s.dia.Link.define("devs.Link",{attrs:{".connection":{"stroke-width":2}}});s.shapes.basic.Generic.define("uml.Class",{attrs:{rect:{width:200},".uml-class-name-rect":{stroke:"black","stroke-width":2,fill:"#3498db"},".uml-class-attrs-rect":{stroke:"black","stroke-width":2,fill:"#2980b9"},".uml-class-methods-rect":{stroke:"black","stroke-width":2,fill:"#2980b9"},".uml-class-name-text":{ref:".uml-class-name-rect","ref-y":.5,"ref-x":.5,"text-anchor":"middle","y-alignment":"middle","font-weight":"bold",fill:"black","font-size":12,"font-family":"Times New Roman"},".uml-class-attrs-text":{ref:".uml-class-attrs-rect","ref-y":5,"ref-x":5,fill:"black","font-size":12,"font-family":"Times New Roman"},".uml-class-methods-text":{ref:".uml-class-methods-rect","ref-y":5,"ref-x":5,fill:"black","font-size":12,"font-family":"Times New Roman"}},name:[],attributes:[],methods:[]},{markup:['<g class="rotatable">','<g class="scalable">','<rect class="uml-class-name-rect"/><rect class="uml-class-attrs-rect"/><rect class="uml-class-methods-rect"/>',"</g>",'<text class="uml-class-name-text"/><text class="uml-class-attrs-text"/><text class="uml-class-methods-text"/>',"</g>"].join(""),initialize:function(){this.on("change:name change:attributes change:methods",function(){this.updateRectangles();this.trigger("uml-update")},this);this.updateRectangles();s.shapes.basic.Generic.prototype.initialize.apply(this,arguments)},getClassName:function(){return this.get("name")},updateRectangles:function(){var t=this.get("attrs");var e=[{type:"name",text:this.getClassName()},{type:"attrs",text:this.get("attributes")},{type:"methods",text:this.get("methods")}];var i=0;e.forEach(function(e){var r=Array.isArray(e.text)?e.text:[e.text];var n=r.length*20+20;t[".uml-class-"+e.type+"-text"].text=r.join("\n");t[".uml-class-"+e.type+"-rect"].height=n;t[".uml-class-"+e.type+"-rect"].transform="translate(0,"+i+")";i+=n})}});s.shapes.uml.ClassView=s.dia.ElementView.extend({initialize:function(){s.dia.ElementView.prototype.initialize.apply(this,arguments);this.listenTo(this.model,"uml-update",function(){this.update();this.resize()})}});s.shapes.uml.Class.define("uml.Abstract",{attrs:{".uml-class-name-rect":{fill:"#e74c3c"},".uml-class-attrs-rect":{fill:"#c0392b"},".uml-class-methods-rect":{fill:"#c0392b"}}},{getClassName:function(){return["<<Abstract>>",this.get("name")]}});s.shapes.uml.AbstractView=s.shapes.uml.ClassView;s.shapes.uml.Class.define("uml.Interface",{attrs:{".uml-class-name-rect":{fill:"#f1c40f"},".uml-class-attrs-rect":{fill:"#f39c12"},".uml-class-methods-rect":{fill:"#f39c12"}}},{getClassName:function(){return["<<Interface>>",this.get("name")]}});s.shapes.uml.InterfaceView=s.shapes.uml.ClassView;s.dia.Link.define("uml.Generalization",{attrs:{".marker-target":{d:"M 20 0 L 0 10 L 20 20 z",fill:"white"}}});s.dia.Link.define("uml.Implementation",{attrs:{".marker-target":{d:"M 20 0 L 0 10 L 20 20 z",fill:"white"},".connection":{"stroke-dasharray":"3,3"}}});s.dia.Link.define("uml.Aggregation",{attrs:{".marker-target":{d:"M 40 10 L 20 20 L 0 10 L 20 0 z",fill:"white"}}});s.dia.Link.define("uml.Composition",{attrs:{".marker-target":{d:"M 40 10 L 20 20 L 0 10 L 20 0 z",fill:"black"}}});s.dia.Link.define("uml.Association");s.shapes.basic.Generic.define("uml.State",{attrs:{".uml-state-body":{width:200,height:200,rx:10,ry:10,fill:"#ecf0f1",stroke:"#bdc3c7","stroke-width":3},".uml-state-separator":{stroke:"#bdc3c7","stroke-width":2},".uml-state-name":{ref:".uml-state-body","ref-x":.5,"ref-y":5,"text-anchor":"middle",fill:"#000000","font-family":"Courier New","font-size":14},".uml-state-events":{ref:".uml-state-separator","ref-x":5,"ref-y":5,fill:"#000000","font-family":"Courier New","font-size":14}},name:"State",events:[]},{markup:['<g class="rotatable">','<g class="scalable">','<rect class="uml-state-body"/>',"</g>",'<path class="uml-state-separator"/>','<text class="uml-state-name"/>','<text class="uml-state-events"/>',"</g>"].join(""),initialize:function(){this.on({"change:name":this.updateName,"change:events":this.updateEvents,"change:size":this.updatePath},this);this.updateName();this.updateEvents();this.updatePath();s.shapes.basic.Generic.prototype.initialize.apply(this,arguments)},updateName:function(){this.attr(".uml-state-name/text",this.get("name"))},updateEvents:function(){this.attr(".uml-state-events/text",this.get("events").join("\n"))},updatePath:function(){var t="M 0 20 L "+this.get("size").width+" 20";this.attr(".uml-state-separator/d",t,{silent:true})}});s.shapes.basic.Circle.define("uml.StartState",{type:"uml.StartState",attrs:{circle:{fill:"#34495e",stroke:"#2c3e50","stroke-width":2,rx:1}}});s.shapes.basic.Generic.define("uml.EndState",{size:{width:20,height:20},attrs:{"circle.outer":{transform:"translate(10, 10)",r:10,fill:"#ffffff",stroke:"#2c3e50"},"circle.inner":{transform:"translate(10, 10)",r:6,fill:"#34495e"}}},{markup:'<g class="rotatable"><g class="scalable"><circle class="outer"/><circle class="inner"/></g></g>'});s.dia.Link.define("uml.Transition",{attrs:{".marker-target":{d:"M 10 0 L 0 5 L 10 10 z",fill:"#34495e",stroke:"#2c3e50"},".connection":{stroke:"#2c3e50"}}});s.shapes.basic.Generic.define("logic.Gate",{size:{width:80,height:40},attrs:{".":{magnet:false},".body":{width:100,height:50},circle:{r:7,stroke:"black",fill:"transparent","stroke-width":2}}},{operation:function(){return true}});s.shapes.logic.Gate.define("logic.IO",{size:{width:60,height:30},attrs:{".body":{fill:"white",stroke:"black","stroke-width":2},".wire":{ref:".body","ref-y":.5,stroke:"black"},text:{fill:"black",ref:".body","ref-x":.5,"ref-y":.5,"y-alignment":"middle","text-anchor":"middle","font-weight":"bold","font-variant":"small-caps","text-transform":"capitalize","font-size":"14px"}}},{markup:'<g class="rotatable"><g class="scalable"><rect class="body"/></g><path class="wire"/><circle/><text/></g>'});s.shapes.logic.IO.define("logic.Input",{attrs:{".wire":{"ref-dx":0,d:"M 0 0 L 23 0"},circle:{ref:".body","ref-dx":30,"ref-y":.5,magnet:true,class:"output",port:"out"},text:{text:"input"}}});s.shapes.logic.IO.define("logic.Output",{attrs:{".wire":{"ref-x":0,d:"M 0 0 L -23 0"},circle:{ref:".body","ref-x":-30,"ref-y":.5,magnet:"passive",class:"input",port:"in"},text:{text:"output"}}});s.shapes.logic.Gate.define("logic.Gate11",{attrs:{".input":{ref:".body","ref-x":-2,"ref-y":.5,magnet:"passive",port:"in"},".output":{ref:".body","ref-dx":2,"ref-y":.5,magnet:true,port:"out"}}},{markup:'<g class="rotatable"><g class="scalable"><image class="body"/></g><circle class="input"/><circle class="output"/></g>'});s.shapes.logic.Gate.define("logic.Gate21",{attrs:{".input1":{ref:".body","ref-x":-2,"ref-y":.3,magnet:"passive",port:"in1"},".input2":{ref:".body","ref-x":-2,"ref-y":.7,magnet:"passive",port:"in2"},".output":{ref:".body","ref-dx":2,"ref-y":.5,magnet:true,port:"out"}}},{markup:'<g class="rotatable"><g class="scalable"><image class="body"/></g><circle class="input input1"/><circle  class="input input2"/><circle class="output"/></g>'});s.shapes.logic.Gate11.define("logic.Repeater",{attrs:{image:{"xlink:href":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhLS0gQ3JlYXRlZCB3aXRoIElua3NjYXBlIChodHRwOi8vd3d3Lmlua3NjYXBlLm9yZy8pIC0tPgo8c3ZnCiAgIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIKICAgeG1sbnM6Y2M9Imh0dHA6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL25zIyIKICAgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIgogICB4bWxuczpzdmc9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogICB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciCiAgIHhtbG5zOnNvZGlwb2RpPSJodHRwOi8vc29kaXBvZGkuc291cmNlZm9yZ2UubmV0L0RURC9zb2RpcG9kaS0wLmR0ZCIKICAgeG1sbnM6aW5rc2NhcGU9Imh0dHA6Ly93d3cuaW5rc2NhcGUub3JnL25hbWVzcGFjZXMvaW5rc2NhcGUiCiAgIHdpZHRoPSIxMDAiCiAgIGhlaWdodD0iNTAiCiAgIGlkPSJzdmcyIgogICBzb2RpcG9kaTp2ZXJzaW9uPSIwLjMyIgogICBpbmtzY2FwZTp2ZXJzaW9uPSIwLjQ2IgogICB2ZXJzaW9uPSIxLjAiCiAgIHNvZGlwb2RpOmRvY25hbWU9Ik5PVCBBTlNJLnN2ZyIKICAgaW5rc2NhcGU6b3V0cHV0X2V4dGVuc2lvbj0ib3JnLmlua3NjYXBlLm91dHB1dC5zdmcuaW5rc2NhcGUiPgogIDxkZWZzCiAgICAgaWQ9ImRlZnM0Ij4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiAxNSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF96PSI1MCA6IDE1IDogMSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIyNSA6IDEwIDogMSIKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI3MTQiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogMC41IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3o9IjEgOiAwLjUgOiAxIgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjAuNSA6IDAuMzMzMzMzMzMgOiAxIgogICAgICAgaWQ9InBlcnNwZWN0aXZlMjgwNiIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlMjgxOSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIzNzIuMDQ3MjQgOiAzNTAuNzg3MzkgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfej0iNzQ0LjA5NDQ4IDogNTI2LjE4MTA5IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA1MjYuMTgxMDkgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlMjc3NyIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSI3NSA6IDQwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjE1MCA6IDYwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA2MCA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBpZD0icGVyc3BlY3RpdmUzMjc1IgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjUwIDogMzMuMzMzMzMzIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjEwMCA6IDUwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA1MCA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBpZD0icGVyc3BlY3RpdmU1NTMzIgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjMyIDogMjEuMzMzMzMzIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjY0IDogMzIgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfeT0iMCA6IDEwMDAgOiAwIgogICAgICAgaW5rc2NhcGU6dnBfeD0iMCA6IDMyIDogMSIKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI1NTciCiAgICAgICBpbmtzY2FwZTpwZXJzcDNkLW9yaWdpbj0iMjUgOiAxNi42NjY2NjcgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfej0iNTAgOiAyNSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogMjUgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICA8L2RlZnM+CiAgPHNvZGlwb2RpOm5hbWVkdmlldwogICAgIGlkPSJiYXNlIgogICAgIHBhZ2Vjb2xvcj0iI2ZmZmZmZiIKICAgICBib3JkZXJjb2xvcj0iIzY2NjY2NiIKICAgICBib3JkZXJvcGFjaXR5PSIxLjAiCiAgICAgaW5rc2NhcGU6cGFnZW9wYWNpdHk9IjAuMCIKICAgICBpbmtzY2FwZTpwYWdlc2hhZG93PSIyIgogICAgIGlua3NjYXBlOnpvb209IjgiCiAgICAgaW5rc2NhcGU6Y3g9Ijg0LjY4NTM1MiIKICAgICBpbmtzY2FwZTpjeT0iMTUuMjg4NjI4IgogICAgIGlua3NjYXBlOmRvY3VtZW50LXVuaXRzPSJweCIKICAgICBpbmtzY2FwZTpjdXJyZW50LWxheWVyPSJsYXllcjEiCiAgICAgc2hvd2dyaWQ9InRydWUiCiAgICAgaW5rc2NhcGU6Z3JpZC1iYm94PSJ0cnVlIgogICAgIGlua3NjYXBlOmdyaWQtcG9pbnRzPSJ0cnVlIgogICAgIGdyaWR0b2xlcmFuY2U9IjEwMDAwIgogICAgIGlua3NjYXBlOndpbmRvdy13aWR0aD0iMTM5OSIKICAgICBpbmtzY2FwZTp3aW5kb3ctaGVpZ2h0PSI4NzQiCiAgICAgaW5rc2NhcGU6d2luZG93LXg9IjMzIgogICAgIGlua3NjYXBlOndpbmRvdy15PSIwIgogICAgIGlua3NjYXBlOnNuYXAtYmJveD0idHJ1ZSI+CiAgICA8aW5rc2NhcGU6Z3JpZAogICAgICAgaWQ9IkdyaWRGcm9tUHJlMDQ2U2V0dGluZ3MiCiAgICAgICB0eXBlPSJ4eWdyaWQiCiAgICAgICBvcmlnaW54PSIwcHgiCiAgICAgICBvcmlnaW55PSIwcHgiCiAgICAgICBzcGFjaW5neD0iMXB4IgogICAgICAgc3BhY2luZ3k9IjFweCIKICAgICAgIGNvbG9yPSIjMDAwMGZmIgogICAgICAgZW1wY29sb3I9IiMwMDAwZmYiCiAgICAgICBvcGFjaXR5PSIwLjIiCiAgICAgICBlbXBvcGFjaXR5PSIwLjQiCiAgICAgICBlbXBzcGFjaW5nPSI1IgogICAgICAgdmlzaWJsZT0idHJ1ZSIKICAgICAgIGVuYWJsZWQ9InRydWUiIC8+CiAgPC9zb2RpcG9kaTpuYW1lZHZpZXc+CiAgPG1ldGFkYXRhCiAgICAgaWQ9Im1ldGFkYXRhNyI+CiAgICA8cmRmOlJERj4KICAgICAgPGNjOldvcmsKICAgICAgICAgcmRmOmFib3V0PSIiPgogICAgICAgIDxkYzpmb3JtYXQ+aW1hZ2Uvc3ZnK3htbDwvZGM6Zm9ybWF0PgogICAgICAgIDxkYzp0eXBlCiAgICAgICAgICAgcmRmOnJlc291cmNlPSJodHRwOi8vcHVybC5vcmcvZGMvZGNtaXR5cGUvU3RpbGxJbWFnZSIgLz4KICAgICAgPC9jYzpXb3JrPgogICAgPC9yZGY6UkRGPgogIDwvbWV0YWRhdGE+CiAgPGcKICAgICBpbmtzY2FwZTpsYWJlbD0iTGF5ZXIgMSIKICAgICBpbmtzY2FwZTpncm91cG1vZGU9ImxheWVyIgogICAgIGlkPSJsYXllcjEiPgogICAgPHBhdGgKICAgICAgIHN0eWxlPSJmaWxsOm5vbmU7c3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjEuOTk5OTk5ODg7c3Ryb2tlLWxpbmVjYXA6YnV0dDtzdHJva2UtbGluZWpvaW46bWl0ZXI7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICAgIGQ9Ik0gNzIuMTU2OTEsMjUgTCA5NSwyNSIKICAgICAgIGlkPSJwYXRoMzA1OSIKICAgICAgIHNvZGlwb2RpOm5vZGV0eXBlcz0iY2MiIC8+CiAgICA8cGF0aAogICAgICAgc3R5bGU9ImZpbGw6bm9uZTtzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MjtzdHJva2UtbGluZWNhcDpidXR0O3N0cm9rZS1saW5lam9pbjptaXRlcjtzdHJva2Utb3BhY2l0eToxIgogICAgICAgZD0iTSAyOS4wNDM0NzgsMjUgTCA1LjA0MzQ3ODEsMjUiCiAgICAgICBpZD0icGF0aDMwNjEiIC8+CiAgICA8cGF0aAogICAgICAgc3R5bGU9ImZpbGw6IzAwMDAwMDtmaWxsLW9wYWNpdHk6MTtzdHJva2U6bm9uZTtzdHJva2Utd2lkdGg6MztzdHJva2UtbGluZWpvaW46bWl0ZXI7bWFya2VyOm5vbmU7c3Ryb2tlLW9wYWNpdHk6MTt2aXNpYmlsaXR5OnZpc2libGU7ZGlzcGxheTppbmxpbmU7b3ZlcmZsb3c6dmlzaWJsZTtlbmFibGUtYmFja2dyb3VuZDphY2N1bXVsYXRlIgogICAgICAgZD0iTSAyOC45Njg3NSwyLjU5Mzc1IEwgMjguOTY4NzUsNSBMIDI4Ljk2ODc1LDQ1IEwgMjguOTY4NzUsNDcuNDA2MjUgTCAzMS4xMjUsNDYuMzQzNzUgTCA3Mi4xNTYyNSwyNi4zNDM3NSBMIDcyLjE1NjI1LDIzLjY1NjI1IEwgMzEuMTI1LDMuNjU2MjUgTCAyOC45Njg3NSwyLjU5Mzc1IHogTSAzMS45Njg3NSw3LjQwNjI1IEwgNjguMDkzNzUsMjUgTCAzMS45Njg3NSw0Mi41OTM3NSBMIDMxLjk2ODc1LDcuNDA2MjUgeiIKICAgICAgIGlkPSJwYXRoMjYzOCIKICAgICAgIHNvZGlwb2RpOm5vZGV0eXBlcz0iY2NjY2NjY2NjY2NjYyIgLz4KICA8L2c+Cjwvc3ZnPgo="}}},{operation:function(t){return t}});s.shapes.logic.Gate11.define("logic.Not",{attrs:{image:{"xlink:href":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhLS0gQ3JlYXRlZCB3aXRoIElua3NjYXBlIChodHRwOi8vd3d3Lmlua3NjYXBlLm9yZy8pIC0tPgo8c3ZnCiAgIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIKICAgeG1sbnM6Y2M9Imh0dHA6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL25zIyIKICAgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIgogICB4bWxuczpzdmc9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogICB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciCiAgIHhtbG5zOnNvZGlwb2RpPSJodHRwOi8vc29kaXBvZGkuc291cmNlZm9yZ2UubmV0L0RURC9zb2RpcG9kaS0wLmR0ZCIKICAgeG1sbnM6aW5rc2NhcGU9Imh0dHA6Ly93d3cuaW5rc2NhcGUub3JnL25hbWVzcGFjZXMvaW5rc2NhcGUiCiAgIHdpZHRoPSIxMDAiCiAgIGhlaWdodD0iNTAiCiAgIGlkPSJzdmcyIgogICBzb2RpcG9kaTp2ZXJzaW9uPSIwLjMyIgogICBpbmtzY2FwZTp2ZXJzaW9uPSIwLjQ2IgogICB2ZXJzaW9uPSIxLjAiCiAgIHNvZGlwb2RpOmRvY25hbWU9Ik5PVCBBTlNJLnN2ZyIKICAgaW5rc2NhcGU6b3V0cHV0X2V4dGVuc2lvbj0ib3JnLmlua3NjYXBlLm91dHB1dC5zdmcuaW5rc2NhcGUiPgogIDxkZWZzCiAgICAgaWQ9ImRlZnM0Ij4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiAxNSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF96PSI1MCA6IDE1IDogMSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIyNSA6IDEwIDogMSIKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI3MTQiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogMC41IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3o9IjEgOiAwLjUgOiAxIgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjAuNSA6IDAuMzMzMzMzMzMgOiAxIgogICAgICAgaWQ9InBlcnNwZWN0aXZlMjgwNiIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlMjgxOSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIzNzIuMDQ3MjQgOiAzNTAuNzg3MzkgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfej0iNzQ0LjA5NDQ4IDogNTI2LjE4MTA5IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA1MjYuMTgxMDkgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlMjc3NyIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSI3NSA6IDQwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjE1MCA6IDYwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA2MCA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBpZD0icGVyc3BlY3RpdmUzMjc1IgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjUwIDogMzMuMzMzMzMzIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjEwMCA6IDUwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA1MCA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBpZD0icGVyc3BlY3RpdmU1NTMzIgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjMyIDogMjEuMzMzMzMzIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjY0IDogMzIgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfeT0iMCA6IDEwMDAgOiAwIgogICAgICAgaW5rc2NhcGU6dnBfeD0iMCA6IDMyIDogMSIKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI1NTciCiAgICAgICBpbmtzY2FwZTpwZXJzcDNkLW9yaWdpbj0iMjUgOiAxNi42NjY2NjcgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfej0iNTAgOiAyNSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogMjUgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICA8L2RlZnM+CiAgPHNvZGlwb2RpOm5hbWVkdmlldwogICAgIGlkPSJiYXNlIgogICAgIHBhZ2Vjb2xvcj0iI2ZmZmZmZiIKICAgICBib3JkZXJjb2xvcj0iIzY2NjY2NiIKICAgICBib3JkZXJvcGFjaXR5PSIxLjAiCiAgICAgaW5rc2NhcGU6cGFnZW9wYWNpdHk9IjAuMCIKICAgICBpbmtzY2FwZTpwYWdlc2hhZG93PSIyIgogICAgIGlua3NjYXBlOnpvb209IjgiCiAgICAgaW5rc2NhcGU6Y3g9Ijg0LjY4NTM1MiIKICAgICBpbmtzY2FwZTpjeT0iMTUuMjg4NjI4IgogICAgIGlua3NjYXBlOmRvY3VtZW50LXVuaXRzPSJweCIKICAgICBpbmtzY2FwZTpjdXJyZW50LWxheWVyPSJsYXllcjEiCiAgICAgc2hvd2dyaWQ9InRydWUiCiAgICAgaW5rc2NhcGU6Z3JpZC1iYm94PSJ0cnVlIgogICAgIGlua3NjYXBlOmdyaWQtcG9pbnRzPSJ0cnVlIgogICAgIGdyaWR0b2xlcmFuY2U9IjEwMDAwIgogICAgIGlua3NjYXBlOndpbmRvdy13aWR0aD0iMTM5OSIKICAgICBpbmtzY2FwZTp3aW5kb3ctaGVpZ2h0PSI4NzQiCiAgICAgaW5rc2NhcGU6d2luZG93LXg9IjMzIgogICAgIGlua3NjYXBlOndpbmRvdy15PSIwIgogICAgIGlua3NjYXBlOnNuYXAtYmJveD0idHJ1ZSI+CiAgICA8aW5rc2NhcGU6Z3JpZAogICAgICAgaWQ9IkdyaWRGcm9tUHJlMDQ2U2V0dGluZ3MiCiAgICAgICB0eXBlPSJ4eWdyaWQiCiAgICAgICBvcmlnaW54PSIwcHgiCiAgICAgICBvcmlnaW55PSIwcHgiCiAgICAgICBzcGFjaW5neD0iMXB4IgogICAgICAgc3BhY2luZ3k9IjFweCIKICAgICAgIGNvbG9yPSIjMDAwMGZmIgogICAgICAgZW1wY29sb3I9IiMwMDAwZmYiCiAgICAgICBvcGFjaXR5PSIwLjIiCiAgICAgICBlbXBvcGFjaXR5PSIwLjQiCiAgICAgICBlbXBzcGFjaW5nPSI1IgogICAgICAgdmlzaWJsZT0idHJ1ZSIKICAgICAgIGVuYWJsZWQ9InRydWUiIC8+CiAgPC9zb2RpcG9kaTpuYW1lZHZpZXc+CiAgPG1ldGFkYXRhCiAgICAgaWQ9Im1ldGFkYXRhNyI+CiAgICA8cmRmOlJERj4KICAgICAgPGNjOldvcmsKICAgICAgICAgcmRmOmFib3V0PSIiPgogICAgICAgIDxkYzpmb3JtYXQ+aW1hZ2Uvc3ZnK3htbDwvZGM6Zm9ybWF0PgogICAgICAgIDxkYzp0eXBlCiAgICAgICAgICAgcmRmOnJlc291cmNlPSJodHRwOi8vcHVybC5vcmcvZGMvZGNtaXR5cGUvU3RpbGxJbWFnZSIgLz4KICAgICAgPC9jYzpXb3JrPgogICAgPC9yZGY6UkRGPgogIDwvbWV0YWRhdGE+CiAgPGcKICAgICBpbmtzY2FwZTpsYWJlbD0iTGF5ZXIgMSIKICAgICBpbmtzY2FwZTpncm91cG1vZGU9ImxheWVyIgogICAgIGlkPSJsYXllcjEiPgogICAgPHBhdGgKICAgICAgIHN0eWxlPSJmaWxsOm5vbmU7c3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjEuOTk5OTk5ODg7c3Ryb2tlLWxpbmVjYXA6YnV0dDtzdHJva2UtbGluZWpvaW46bWl0ZXI7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICAgIGQ9Ik0gNzkuMTU2OTEsMjUgTCA5NSwyNSIKICAgICAgIGlkPSJwYXRoMzA1OSIKICAgICAgIHNvZGlwb2RpOm5vZGV0eXBlcz0iY2MiIC8+CiAgICA8cGF0aAogICAgICAgc3R5bGU9ImZpbGw6bm9uZTtzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MjtzdHJva2UtbGluZWNhcDpidXR0O3N0cm9rZS1saW5lam9pbjptaXRlcjtzdHJva2Utb3BhY2l0eToxIgogICAgICAgZD0iTSAyOS4wNDM0NzgsMjUgTCA1LjA0MzQ3ODEsMjUiCiAgICAgICBpZD0icGF0aDMwNjEiIC8+CiAgICA8cGF0aAogICAgICAgc3R5bGU9ImZpbGw6IzAwMDAwMDtmaWxsLW9wYWNpdHk6MTtzdHJva2U6bm9uZTtzdHJva2Utd2lkdGg6MztzdHJva2UtbGluZWpvaW46bWl0ZXI7bWFya2VyOm5vbmU7c3Ryb2tlLW9wYWNpdHk6MTt2aXNpYmlsaXR5OnZpc2libGU7ZGlzcGxheTppbmxpbmU7b3ZlcmZsb3c6dmlzaWJsZTtlbmFibGUtYmFja2dyb3VuZDphY2N1bXVsYXRlIgogICAgICAgZD0iTSAyOC45Njg3NSwyLjU5Mzc1IEwgMjguOTY4NzUsNSBMIDI4Ljk2ODc1LDQ1IEwgMjguOTY4NzUsNDcuNDA2MjUgTCAzMS4xMjUsNDYuMzQzNzUgTCA3Mi4xNTYyNSwyNi4zNDM3NSBMIDcyLjE1NjI1LDIzLjY1NjI1IEwgMzEuMTI1LDMuNjU2MjUgTCAyOC45Njg3NSwyLjU5Mzc1IHogTSAzMS45Njg3NSw3LjQwNjI1IEwgNjguMDkzNzUsMjUgTCAzMS45Njg3NSw0Mi41OTM3NSBMIDMxLjk2ODc1LDcuNDA2MjUgeiIKICAgICAgIGlkPSJwYXRoMjYzOCIKICAgICAgIHNvZGlwb2RpOm5vZGV0eXBlcz0iY2NjY2NjY2NjY2NjYyIgLz4KICAgIDxwYXRoCiAgICAgICBzb2RpcG9kaTp0eXBlPSJhcmMiCiAgICAgICBzdHlsZT0iZmlsbDpub25lO2ZpbGwtb3BhY2l0eToxO3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDozO3N0cm9rZS1saW5lam9pbjptaXRlcjttYXJrZXI6bm9uZTtzdHJva2Utb3BhY2l0eToxO3Zpc2liaWxpdHk6dmlzaWJsZTtkaXNwbGF5OmlubGluZTtvdmVyZmxvdzp2aXNpYmxlO2VuYWJsZS1iYWNrZ3JvdW5kOmFjY3VtdWxhdGUiCiAgICAgICBpZD0icGF0aDI2NzEiCiAgICAgICBzb2RpcG9kaTpjeD0iNzYiCiAgICAgICBzb2RpcG9kaTpjeT0iMjUiCiAgICAgICBzb2RpcG9kaTpyeD0iNCIKICAgICAgIHNvZGlwb2RpOnJ5PSI0IgogICAgICAgZD0iTSA4MCwyNSBBIDQsNCAwIDEgMSA3MiwyNSBBIDQsNCAwIDEgMSA4MCwyNSB6IgogICAgICAgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTEsMCkiIC8+CiAgPC9nPgo8L3N2Zz4K"}}},{operation:function(t){return!t}});s.shapes.logic.Gate21.define("logic.Or",{attrs:{image:{"xlink:href":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhLS0gQ3JlYXRlZCB3aXRoIElua3NjYXBlIChodHRwOi8vd3d3Lmlua3NjYXBlLm9yZy8pIC0tPgo8c3ZnCiAgIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIKICAgeG1sbnM6Y2M9Imh0dHA6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL25zIyIKICAgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIgogICB4bWxuczpzdmc9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogICB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciCiAgIHhtbG5zOnNvZGlwb2RpPSJodHRwOi8vc29kaXBvZGkuc291cmNlZm9yZ2UubmV0L0RURC9zb2RpcG9kaS0wLmR0ZCIKICAgeG1sbnM6aW5rc2NhcGU9Imh0dHA6Ly93d3cuaW5rc2NhcGUub3JnL25hbWVzcGFjZXMvaW5rc2NhcGUiCiAgIHdpZHRoPSIxMDAiCiAgIGhlaWdodD0iNTAiCiAgIGlkPSJzdmcyIgogICBzb2RpcG9kaTp2ZXJzaW9uPSIwLjMyIgogICBpbmtzY2FwZTp2ZXJzaW9uPSIwLjQ2IgogICB2ZXJzaW9uPSIxLjAiCiAgIHNvZGlwb2RpOmRvY25hbWU9Ik9SIEFOU0kuc3ZnIgogICBpbmtzY2FwZTpvdXRwdXRfZXh0ZW5zaW9uPSJvcmcuaW5rc2NhcGUub3V0cHV0LnN2Zy5pbmtzY2FwZSI+CiAgPGRlZnMKICAgICBpZD0iZGVmczQiPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIgogICAgICAgaW5rc2NhcGU6dnBfeD0iMCA6IDE1IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3o9IjUwIDogMTUgOiAxIgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjI1IDogMTAgOiAxIgogICAgICAgaWQ9InBlcnNwZWN0aXZlMjcxNCIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiAwLjUgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfeT0iMCA6IDEwMDAgOiAwIgogICAgICAgaW5rc2NhcGU6dnBfej0iMSA6IDAuNSA6IDEiCiAgICAgICBpbmtzY2FwZTpwZXJzcDNkLW9yaWdpbj0iMC41IDogMC4zMzMzMzMzMyA6IDEiCiAgICAgICBpZD0icGVyc3BlY3RpdmUyODA2IiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBpZD0icGVyc3BlY3RpdmUyODE5IgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjM3Mi4wNDcyNCA6IDM1MC43ODczOSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF96PSI3NDQuMDk0NDggOiA1MjYuMTgxMDkgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfeT0iMCA6IDEwMDAgOiAwIgogICAgICAgaW5rc2NhcGU6dnBfeD0iMCA6IDUyNi4xODEwOSA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBpZD0icGVyc3BlY3RpdmUyNzc3IgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49Ijc1IDogNDAgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfej0iMTUwIDogNjAgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfeT0iMCA6IDEwMDAgOiAwIgogICAgICAgaW5rc2NhcGU6dnBfeD0iMCA6IDYwIDogMSIKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTMyNzUiCiAgICAgICBpbmtzY2FwZTpwZXJzcDNkLW9yaWdpbj0iNTAgOiAzMy4zMzMzMzMgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfej0iMTAwIDogNTAgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfeT0iMCA6IDEwMDAgOiAwIgogICAgICAgaW5rc2NhcGU6dnBfeD0iMCA6IDUwIDogMSIKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTU1MzMiCiAgICAgICBpbmtzY2FwZTpwZXJzcDNkLW9yaWdpbj0iMzIgOiAyMS4zMzMzMzMgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfej0iNjQgOiAzMiA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogMzIgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlMjU1NyIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIyNSA6IDE2LjY2NjY2NyA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF96PSI1MCA6IDI1IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiAyNSA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogIDwvZGVmcz4KICA8c29kaXBvZGk6bmFtZWR2aWV3CiAgICAgaWQ9ImJhc2UiCiAgICAgcGFnZWNvbG9yPSIjZmZmZmZmIgogICAgIGJvcmRlcmNvbG9yPSIjNjY2NjY2IgogICAgIGJvcmRlcm9wYWNpdHk9IjEuMCIKICAgICBpbmtzY2FwZTpwYWdlb3BhY2l0eT0iMC4wIgogICAgIGlua3NjYXBlOnBhZ2VzaGFkb3c9IjIiCiAgICAgaW5rc2NhcGU6em9vbT0iNCIKICAgICBpbmtzY2FwZTpjeD0iMTEzLjAwMDM5IgogICAgIGlua3NjYXBlOmN5PSIxMi44OTM3MzEiCiAgICAgaW5rc2NhcGU6ZG9jdW1lbnQtdW5pdHM9InB4IgogICAgIGlua3NjYXBlOmN1cnJlbnQtbGF5ZXI9ImcyNTYwIgogICAgIHNob3dncmlkPSJmYWxzZSIKICAgICBpbmtzY2FwZTpncmlkLWJib3g9InRydWUiCiAgICAgaW5rc2NhcGU6Z3JpZC1wb2ludHM9InRydWUiCiAgICAgZ3JpZHRvbGVyYW5jZT0iMTAwMDAiCiAgICAgaW5rc2NhcGU6d2luZG93LXdpZHRoPSIxMzk5IgogICAgIGlua3NjYXBlOndpbmRvdy1oZWlnaHQ9Ijg3NCIKICAgICBpbmtzY2FwZTp3aW5kb3cteD0iMzciCiAgICAgaW5rc2NhcGU6d2luZG93LXk9Ii00IgogICAgIGlua3NjYXBlOnNuYXAtYmJveD0idHJ1ZSI+CiAgICA8aW5rc2NhcGU6Z3JpZAogICAgICAgaWQ9IkdyaWRGcm9tUHJlMDQ2U2V0dGluZ3MiCiAgICAgICB0eXBlPSJ4eWdyaWQiCiAgICAgICBvcmlnaW54PSIwcHgiCiAgICAgICBvcmlnaW55PSIwcHgiCiAgICAgICBzcGFjaW5neD0iMXB4IgogICAgICAgc3BhY2luZ3k9IjFweCIKICAgICAgIGNvbG9yPSIjMDAwMGZmIgogICAgICAgZW1wY29sb3I9IiMwMDAwZmYiCiAgICAgICBvcGFjaXR5PSIwLjIiCiAgICAgICBlbXBvcGFjaXR5PSIwLjQiCiAgICAgICBlbXBzcGFjaW5nPSI1IgogICAgICAgdmlzaWJsZT0idHJ1ZSIKICAgICAgIGVuYWJsZWQ9InRydWUiIC8+CiAgPC9zb2RpcG9kaTpuYW1lZHZpZXc+CiAgPG1ldGFkYXRhCiAgICAgaWQ9Im1ldGFkYXRhNyI+CiAgICA8cmRmOlJERj4KICAgICAgPGNjOldvcmsKICAgICAgICAgcmRmOmFib3V0PSIiPgogICAgICAgIDxkYzpmb3JtYXQ+aW1hZ2Uvc3ZnK3htbDwvZGM6Zm9ybWF0PgogICAgICAgIDxkYzp0eXBlCiAgICAgICAgICAgcmRmOnJlc291cmNlPSJodHRwOi8vcHVybC5vcmcvZGMvZGNtaXR5cGUvU3RpbGxJbWFnZSIgLz4KICAgICAgPC9jYzpXb3JrPgogICAgPC9yZGY6UkRGPgogIDwvbWV0YWRhdGE+CiAgPGcKICAgICBpbmtzY2FwZTpsYWJlbD0iTGF5ZXIgMSIKICAgICBpbmtzY2FwZTpncm91cG1vZGU9ImxheWVyIgogICAgIGlkPSJsYXllcjEiPgogICAgPHBhdGgKICAgICAgIHN0eWxlPSJmaWxsOm5vbmU7c3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjI7c3Ryb2tlLWxpbmVjYXA6YnV0dDtzdHJva2UtbGluZWpvaW46bWl0ZXI7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICAgIGQ9Im0gNzAsMjUgYyAyMCwwIDI1LDAgMjUsMCIKICAgICAgIGlkPSJwYXRoMzA1OSIKICAgICAgIHNvZGlwb2RpOm5vZGV0eXBlcz0iY2MiIC8+CiAgICA8cGF0aAogICAgICAgc3R5bGU9ImZpbGw6bm9uZTtzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MjtzdHJva2UtbGluZWNhcDpidXR0O3N0cm9rZS1saW5lam9pbjptaXRlcjtzdHJva2Utb3BhY2l0eToxIgogICAgICAgZD0iTSAzMSwxNSA1LDE1IgogICAgICAgaWQ9InBhdGgzMDYxIiAvPgogICAgPHBhdGgKICAgICAgIHN0eWxlPSJmaWxsOm5vbmU7c3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjEuOTk5OTk5ODg7c3Ryb2tlLWxpbmVjYXA6YnV0dDtzdHJva2UtbGluZWpvaW46bWl0ZXI7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICAgIGQ9Ik0gMzIsMzUgNSwzNSIKICAgICAgIGlkPSJwYXRoMzk0NCIgLz4KICAgIDxnCiAgICAgICBpZD0iZzI1NjAiCiAgICAgICBpbmtzY2FwZTpsYWJlbD0iTGF5ZXIgMSIKICAgICAgIHRyYW5zZm9ybT0idHJhbnNsYXRlKDI2LjUsLTM5LjUpIj4KICAgICAgPHBhdGgKICAgICAgICAgc3R5bGU9ImZpbGw6IzAwMDAwMDtmaWxsLW9wYWNpdHk6MTtmaWxsLXJ1bGU6ZXZlbm9kZDtzdHJva2U6bm9uZTtzdHJva2Utd2lkdGg6MztzdHJva2UtbGluZWNhcDpidXR0O3N0cm9rZS1saW5lam9pbjptaXRlcjtzdHJva2Utb3BhY2l0eToxIgogICAgICAgICBkPSJNIC0yLjQwNjI1LDQ0LjUgTCAtMC40MDYyNSw0Ni45Mzc1IEMgLTAuNDA2MjUsNDYuOTM3NSA1LjI1LDUzLjkzNzU0OSA1LjI1LDY0LjUgQyA1LjI1LDc1LjA2MjQ1MSAtMC40MDYyNSw4Mi4wNjI1IC0wLjQwNjI1LDgyLjA2MjUgTCAtMi40MDYyNSw4NC41IEwgMC43NSw4NC41IEwgMTQuNzUsODQuNSBDIDE3LjE1ODA3Niw4NC41MDAwMDEgMjIuNDM5Njk5LDg0LjUyNDUxNCAyOC4zNzUsODIuMDkzNzUgQyAzNC4zMTAzMDEsNzkuNjYyOTg2IDQwLjkxMTUzNiw3NC43NTA0ODQgNDYuMDYyNSw2NS4yMTg3NSBMIDQ0Ljc1LDY0LjUgTCA0Ni4wNjI1LDYzLjc4MTI1IEMgMzUuNzU5Mzg3LDQ0LjcxNTU5IDE5LjUwNjU3NCw0NC41IDE0Ljc1LDQ0LjUgTCAwLjc1LDQ0LjUgTCAtMi40MDYyNSw0NC41IHogTSAzLjQ2ODc1LDQ3LjUgTCAxNC43NSw0Ny41IEMgMTkuNDM0MTczLDQ3LjUgMzMuMDM2ODUsNDcuMzY5NzkzIDQyLjcxODc1LDY0LjUgQyAzNy45NTE5NjQsNzIuOTI5MDc1IDMyLjE5NzQ2OSw3Ny4xODM5MSAyNyw3OS4zMTI1IEMgMjEuNjM5MzM5LDgxLjUwNzkyNCAxNy4xNTgwNzUsODEuNTAwMDAxIDE0Ljc1LDgxLjUgTCAzLjUsODEuNSBDIDUuMzczNTg4NCw3OC4zOTE1NjYgOC4yNSw3Mi40NTA2NSA4LjI1LDY0LjUgQyA4LjI1LDU2LjUyNjY0NiA1LjM0MTQ2ODYsNTAuNTk5ODE1IDMuNDY4NzUsNDcuNSB6IgogICAgICAgICBpZD0icGF0aDQ5NzMiCiAgICAgICAgIHNvZGlwb2RpOm5vZGV0eXBlcz0iY2NzY2NjY3NjY2NjY2NjY2NzY2NzYyIgLz4KICAgIDwvZz4KICA8L2c+Cjwvc3ZnPgo="}}},{operation:function(t,e){return t||e}});s.shapes.logic.Gate21.define("logic.And",{attrs:{image:{"xlink:href":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhLS0gQ3JlYXRlZCB3aXRoIElua3NjYXBlIChodHRwOi8vd3d3Lmlua3NjYXBlLm9yZy8pIC0tPgo8c3ZnCiAgIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIKICAgeG1sbnM6Y2M9Imh0dHA6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL25zIyIKICAgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIgogICB4bWxuczpzdmc9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogICB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciCiAgIHhtbG5zOnNvZGlwb2RpPSJodHRwOi8vc29kaXBvZGkuc291cmNlZm9yZ2UubmV0L0RURC9zb2RpcG9kaS0wLmR0ZCIKICAgeG1sbnM6aW5rc2NhcGU9Imh0dHA6Ly93d3cuaW5rc2NhcGUub3JnL25hbWVzcGFjZXMvaW5rc2NhcGUiCiAgIHdpZHRoPSIxMDAiCiAgIGhlaWdodD0iNTAiCiAgIGlkPSJzdmcyIgogICBzb2RpcG9kaTp2ZXJzaW9uPSIwLjMyIgogICBpbmtzY2FwZTp2ZXJzaW9uPSIwLjQ2IgogICB2ZXJzaW9uPSIxLjAiCiAgIHNvZGlwb2RpOmRvY25hbWU9IkFORCBBTlNJLnN2ZyIKICAgaW5rc2NhcGU6b3V0cHV0X2V4dGVuc2lvbj0ib3JnLmlua3NjYXBlLm91dHB1dC5zdmcuaW5rc2NhcGUiPgogIDxkZWZzCiAgICAgaWQ9ImRlZnM0Ij4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiAxNSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF96PSI1MCA6IDE1IDogMSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIyNSA6IDEwIDogMSIKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI3MTQiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogMC41IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3o9IjEgOiAwLjUgOiAxIgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjAuNSA6IDAuMzMzMzMzMzMgOiAxIgogICAgICAgaWQ9InBlcnNwZWN0aXZlMjgwNiIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlMjgxOSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIzNzIuMDQ3MjQgOiAzNTAuNzg3MzkgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfej0iNzQ0LjA5NDQ4IDogNTI2LjE4MTA5IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA1MjYuMTgxMDkgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlMjc3NyIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSI3NSA6IDQwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjE1MCA6IDYwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA2MCA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBpZD0icGVyc3BlY3RpdmUzMjc1IgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjUwIDogMzMuMzMzMzMzIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjEwMCA6IDUwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA1MCA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBpZD0icGVyc3BlY3RpdmU1NTMzIgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjMyIDogMjEuMzMzMzMzIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjY0IDogMzIgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfeT0iMCA6IDEwMDAgOiAwIgogICAgICAgaW5rc2NhcGU6dnBfeD0iMCA6IDMyIDogMSIKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiIC8+CiAgPC9kZWZzPgogIDxzb2RpcG9kaTpuYW1lZHZpZXcKICAgICBpZD0iYmFzZSIKICAgICBwYWdlY29sb3I9IiNmZmZmZmYiCiAgICAgYm9yZGVyY29sb3I9IiM2NjY2NjYiCiAgICAgYm9yZGVyb3BhY2l0eT0iMS4wIgogICAgIGlua3NjYXBlOnBhZ2VvcGFjaXR5PSIwLjAiCiAgICAgaW5rc2NhcGU6cGFnZXNoYWRvdz0iMiIKICAgICBpbmtzY2FwZTp6b29tPSI4IgogICAgIGlua3NjYXBlOmN4PSI1Ni42OTgzNDgiCiAgICAgaW5rc2NhcGU6Y3k9IjI1LjMyNjg5OSIKICAgICBpbmtzY2FwZTpkb2N1bWVudC11bml0cz0icHgiCiAgICAgaW5rc2NhcGU6Y3VycmVudC1sYXllcj0ibGF5ZXIxIgogICAgIHNob3dncmlkPSJ0cnVlIgogICAgIGlua3NjYXBlOmdyaWQtYmJveD0idHJ1ZSIKICAgICBpbmtzY2FwZTpncmlkLXBvaW50cz0idHJ1ZSIKICAgICBncmlkdG9sZXJhbmNlPSIxMDAwMCIKICAgICBpbmtzY2FwZTp3aW5kb3ctd2lkdGg9IjEzOTkiCiAgICAgaW5rc2NhcGU6d2luZG93LWhlaWdodD0iODc0IgogICAgIGlua3NjYXBlOndpbmRvdy14PSIzMyIKICAgICBpbmtzY2FwZTp3aW5kb3cteT0iMCIKICAgICBpbmtzY2FwZTpzbmFwLWJib3g9InRydWUiPgogICAgPGlua3NjYXBlOmdyaWQKICAgICAgIGlkPSJHcmlkRnJvbVByZTA0NlNldHRpbmdzIgogICAgICAgdHlwZT0ieHlncmlkIgogICAgICAgb3JpZ2lueD0iMHB4IgogICAgICAgb3JpZ2lueT0iMHB4IgogICAgICAgc3BhY2luZ3g9IjFweCIKICAgICAgIHNwYWNpbmd5PSIxcHgiCiAgICAgICBjb2xvcj0iIzAwMDBmZiIKICAgICAgIGVtcGNvbG9yPSIjMDAwMGZmIgogICAgICAgb3BhY2l0eT0iMC4yIgogICAgICAgZW1wb3BhY2l0eT0iMC40IgogICAgICAgZW1wc3BhY2luZz0iNSIKICAgICAgIHZpc2libGU9InRydWUiCiAgICAgICBlbmFibGVkPSJ0cnVlIiAvPgogIDwvc29kaXBvZGk6bmFtZWR2aWV3PgogIDxtZXRhZGF0YQogICAgIGlkPSJtZXRhZGF0YTciPgogICAgPHJkZjpSREY+CiAgICAgIDxjYzpXb3JrCiAgICAgICAgIHJkZjphYm91dD0iIj4KICAgICAgICA8ZGM6Zm9ybWF0PmltYWdlL3N2Zyt4bWw8L2RjOmZvcm1hdD4KICAgICAgICA8ZGM6dHlwZQogICAgICAgICAgIHJkZjpyZXNvdXJjZT0iaHR0cDovL3B1cmwub3JnL2RjL2RjbWl0eXBlL1N0aWxsSW1hZ2UiIC8+CiAgICAgIDwvY2M6V29yaz4KICAgIDwvcmRmOlJERj4KICA8L21ldGFkYXRhPgogIDxnCiAgICAgaW5rc2NhcGU6bGFiZWw9IkxheWVyIDEiCiAgICAgaW5rc2NhcGU6Z3JvdXBtb2RlPSJsYXllciIKICAgICBpZD0ibGF5ZXIxIj4KICAgIDxwYXRoCiAgICAgICBzdHlsZT0iZmlsbDpub25lO3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoyO3N0cm9rZS1saW5lY2FwOmJ1dHQ7c3Ryb2tlLWxpbmVqb2luOm1pdGVyO3N0cm9rZS1vcGFjaXR5OjEiCiAgICAgICBkPSJtIDcwLDI1IGMgMjAsMCAyNSwwIDI1LDAiCiAgICAgICBpZD0icGF0aDMwNTkiCiAgICAgICBzb2RpcG9kaTpub2RldHlwZXM9ImNjIiAvPgogICAgPHBhdGgKICAgICAgIHN0eWxlPSJmaWxsOm5vbmU7c3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjI7c3Ryb2tlLWxpbmVjYXA6YnV0dDtzdHJva2UtbGluZWpvaW46bWl0ZXI7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICAgIGQ9Ik0gMzEsMTUgNSwxNSIKICAgICAgIGlkPSJwYXRoMzA2MSIgLz4KICAgIDxwYXRoCiAgICAgICBzdHlsZT0iZmlsbDpub25lO3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxLjk5OTk5OTg4O3N0cm9rZS1saW5lY2FwOmJ1dHQ7c3Ryb2tlLWxpbmVqb2luOm1pdGVyO3N0cm9rZS1vcGFjaXR5OjEiCiAgICAgICBkPSJNIDMyLDM1IDUsMzUiCiAgICAgICBpZD0icGF0aDM5NDQiIC8+CiAgICA8cGF0aAogICAgICAgc3R5bGU9ImZvbnQtc2l6ZTptZWRpdW07Zm9udC1zdHlsZTpub3JtYWw7Zm9udC12YXJpYW50Om5vcm1hbDtmb250LXdlaWdodDpub3JtYWw7Zm9udC1zdHJldGNoOm5vcm1hbDt0ZXh0LWluZGVudDowO3RleHQtYWxpZ246c3RhcnQ7dGV4dC1kZWNvcmF0aW9uOm5vbmU7bGluZS1oZWlnaHQ6bm9ybWFsO2xldHRlci1zcGFjaW5nOm5vcm1hbDt3b3JkLXNwYWNpbmc6bm9ybWFsO3RleHQtdHJhbnNmb3JtOm5vbmU7ZGlyZWN0aW9uOmx0cjtibG9jay1wcm9ncmVzc2lvbjp0Yjt3cml0aW5nLW1vZGU6bHItdGI7dGV4dC1hbmNob3I6c3RhcnQ7ZmlsbDojMDAwMDAwO2ZpbGwtb3BhY2l0eToxO3N0cm9rZTpub25lO3N0cm9rZS13aWR0aDozO21hcmtlcjpub25lO3Zpc2liaWxpdHk6dmlzaWJsZTtkaXNwbGF5OmlubGluZTtvdmVyZmxvdzp2aXNpYmxlO2VuYWJsZS1iYWNrZ3JvdW5kOmFjY3VtdWxhdGU7Zm9udC1mYW1pbHk6Qml0c3RyZWFtIFZlcmEgU2FuczstaW5rc2NhcGUtZm9udC1zcGVjaWZpY2F0aW9uOkJpdHN0cmVhbSBWZXJhIFNhbnMiCiAgICAgICBkPSJNIDMwLDUgTCAzMCw2LjQyODU3MTQgTCAzMCw0My41NzE0MjkgTCAzMCw0NSBMIDMxLjQyODU3MSw0NSBMIDUwLjQ3NjE5LDQ1IEMgNjEuNzQ0MDk4LDQ1IDcwLjQ3NjE5LDM1Ljk5OTk1NSA3MC40NzYxOSwyNSBDIDcwLjQ3NjE5LDE0LjAwMDA0NSA2MS43NDQwOTksNS4wMDAwMDAyIDUwLjQ3NjE5LDUgQyA1MC40NzYxOSw1IDUwLjQ3NjE5LDUgMzEuNDI4NTcxLDUgTCAzMCw1IHogTSAzMi44NTcxNDMsNy44NTcxNDI5IEMgNDAuODM0MjY0LDcuODU3MTQyOSA0NS45MTgzNjgsNy44NTcxNDI5IDQ4LjA5NTIzOCw3Ljg1NzE0MjkgQyA0OS4yODU3MTQsNy44NTcxNDI5IDQ5Ljg4MDk1Miw3Ljg1NzE0MjkgNTAuMTc4NTcxLDcuODU3MTQyOSBDIDUwLjMyNzM4MSw3Ljg1NzE0MjkgNTAuNDA5MjI3LDcuODU3MTQyOSA1MC40NDY0MjksNy44NTcxNDI5IEMgNTAuNDY1MDI5LDcuODU3MTQyOSA1MC40NzE1NDMsNy44NTcxNDI5IDUwLjQ3NjE5LDcuODU3MTQyOSBDIDYwLjIzNjg1Myw3Ljg1NzE0MyA2Ny4xNDI4NTcsMTUuNDk3MDk4IDY3LjE0Mjg1NywyNSBDIDY3LjE0Mjg1NywzNC41MDI5MDIgNTkuNzYwNjYyLDQyLjE0Mjg1NyA1MCw0Mi4xNDI4NTcgTCAzMi44NTcxNDMsNDIuMTQyODU3IEwgMzIuODU3MTQzLDcuODU3MTQyOSB6IgogICAgICAgaWQ9InBhdGgyODg0IgogICAgICAgc29kaXBvZGk6bm9kZXR5cGVzPSJjY2NjY2NzY2NjY3Nzc3NzY2NjIiAvPgogIDwvZz4KPC9zdmc+Cg=="}}},{operation:function(t,e){return t&&e}});s.shapes.logic.Gate21.define("logic.Nor",{attrs:{image:{"xlink:href":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhLS0gQ3JlYXRlZCB3aXRoIElua3NjYXBlIChodHRwOi8vd3d3Lmlua3NjYXBlLm9yZy8pIC0tPgo8c3ZnCiAgIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIKICAgeG1sbnM6Y2M9Imh0dHA6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL25zIyIKICAgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIgogICB4bWxuczpzdmc9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogICB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciCiAgIHhtbG5zOnNvZGlwb2RpPSJodHRwOi8vc29kaXBvZGkuc291cmNlZm9yZ2UubmV0L0RURC9zb2RpcG9kaS0wLmR0ZCIKICAgeG1sbnM6aW5rc2NhcGU9Imh0dHA6Ly93d3cuaW5rc2NhcGUub3JnL25hbWVzcGFjZXMvaW5rc2NhcGUiCiAgIHdpZHRoPSIxMDAiCiAgIGhlaWdodD0iNTAiCiAgIGlkPSJzdmcyIgogICBzb2RpcG9kaTp2ZXJzaW9uPSIwLjMyIgogICBpbmtzY2FwZTp2ZXJzaW9uPSIwLjQ2IgogICB2ZXJzaW9uPSIxLjAiCiAgIHNvZGlwb2RpOmRvY25hbWU9Ik5PUiBBTlNJLnN2ZyIKICAgaW5rc2NhcGU6b3V0cHV0X2V4dGVuc2lvbj0ib3JnLmlua3NjYXBlLm91dHB1dC5zdmcuaW5rc2NhcGUiPgogIDxkZWZzCiAgICAgaWQ9ImRlZnM0Ij4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiAxNSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF96PSI1MCA6IDE1IDogMSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIyNSA6IDEwIDogMSIKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI3MTQiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogMC41IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3o9IjEgOiAwLjUgOiAxIgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjAuNSA6IDAuMzMzMzMzMzMgOiAxIgogICAgICAgaWQ9InBlcnNwZWN0aXZlMjgwNiIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlMjgxOSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIzNzIuMDQ3MjQgOiAzNTAuNzg3MzkgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfej0iNzQ0LjA5NDQ4IDogNTI2LjE4MTA5IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA1MjYuMTgxMDkgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlMjc3NyIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSI3NSA6IDQwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjE1MCA6IDYwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA2MCA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBpZD0icGVyc3BlY3RpdmUzMjc1IgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjUwIDogMzMuMzMzMzMzIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjEwMCA6IDUwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA1MCA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBpZD0icGVyc3BlY3RpdmU1NTMzIgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjMyIDogMjEuMzMzMzMzIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjY0IDogMzIgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfeT0iMCA6IDEwMDAgOiAwIgogICAgICAgaW5rc2NhcGU6dnBfeD0iMCA6IDMyIDogMSIKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI1NTciCiAgICAgICBpbmtzY2FwZTpwZXJzcDNkLW9yaWdpbj0iMjUgOiAxNi42NjY2NjcgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfej0iNTAgOiAyNSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogMjUgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICA8L2RlZnM+CiAgPHNvZGlwb2RpOm5hbWVkdmlldwogICAgIGlkPSJiYXNlIgogICAgIHBhZ2Vjb2xvcj0iI2ZmZmZmZiIKICAgICBib3JkZXJjb2xvcj0iIzY2NjY2NiIKICAgICBib3JkZXJvcGFjaXR5PSIxLjAiCiAgICAgaW5rc2NhcGU6cGFnZW9wYWNpdHk9IjAuMCIKICAgICBpbmtzY2FwZTpwYWdlc2hhZG93PSIyIgogICAgIGlua3NjYXBlOnpvb209IjEiCiAgICAgaW5rc2NhcGU6Y3g9Ijc4LjY3NzY0NCIKICAgICBpbmtzY2FwZTpjeT0iMjIuMTAyMzQ0IgogICAgIGlua3NjYXBlOmRvY3VtZW50LXVuaXRzPSJweCIKICAgICBpbmtzY2FwZTpjdXJyZW50LWxheWVyPSJsYXllcjEiCiAgICAgc2hvd2dyaWQ9InRydWUiCiAgICAgaW5rc2NhcGU6Z3JpZC1iYm94PSJ0cnVlIgogICAgIGlua3NjYXBlOmdyaWQtcG9pbnRzPSJ0cnVlIgogICAgIGdyaWR0b2xlcmFuY2U9IjEwMDAwIgogICAgIGlua3NjYXBlOndpbmRvdy13aWR0aD0iMTM5OSIKICAgICBpbmtzY2FwZTp3aW5kb3ctaGVpZ2h0PSI4NzQiCiAgICAgaW5rc2NhcGU6d2luZG93LXg9IjM3IgogICAgIGlua3NjYXBlOndpbmRvdy15PSItNCIKICAgICBpbmtzY2FwZTpzbmFwLWJib3g9InRydWUiPgogICAgPGlua3NjYXBlOmdyaWQKICAgICAgIGlkPSJHcmlkRnJvbVByZTA0NlNldHRpbmdzIgogICAgICAgdHlwZT0ieHlncmlkIgogICAgICAgb3JpZ2lueD0iMHB4IgogICAgICAgb3JpZ2lueT0iMHB4IgogICAgICAgc3BhY2luZ3g9IjFweCIKICAgICAgIHNwYWNpbmd5PSIxcHgiCiAgICAgICBjb2xvcj0iIzAwMDBmZiIKICAgICAgIGVtcGNvbG9yPSIjMDAwMGZmIgogICAgICAgb3BhY2l0eT0iMC4yIgogICAgICAgZW1wb3BhY2l0eT0iMC40IgogICAgICAgZW1wc3BhY2luZz0iNSIKICAgICAgIHZpc2libGU9InRydWUiCiAgICAgICBlbmFibGVkPSJ0cnVlIiAvPgogIDwvc29kaXBvZGk6bmFtZWR2aWV3PgogIDxtZXRhZGF0YQogICAgIGlkPSJtZXRhZGF0YTciPgogICAgPHJkZjpSREY+CiAgICAgIDxjYzpXb3JrCiAgICAgICAgIHJkZjphYm91dD0iIj4KICAgICAgICA8ZGM6Zm9ybWF0PmltYWdlL3N2Zyt4bWw8L2RjOmZvcm1hdD4KICAgICAgICA8ZGM6dHlwZQogICAgICAgICAgIHJkZjpyZXNvdXJjZT0iaHR0cDovL3B1cmwub3JnL2RjL2RjbWl0eXBlL1N0aWxsSW1hZ2UiIC8+CiAgICAgIDwvY2M6V29yaz4KICAgIDwvcmRmOlJERj4KICA8L21ldGFkYXRhPgogIDxnCiAgICAgaW5rc2NhcGU6bGFiZWw9IkxheWVyIDEiCiAgICAgaW5rc2NhcGU6Z3JvdXBtb2RlPSJsYXllciIKICAgICBpZD0ibGF5ZXIxIj4KICAgIDxwYXRoCiAgICAgICBzdHlsZT0iZmlsbDpub25lO3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoyO3N0cm9rZS1saW5lY2FwOmJ1dHQ7c3Ryb2tlLWxpbmVqb2luOm1pdGVyO3N0cm9rZS1vcGFjaXR5OjEiCiAgICAgICBkPSJNIDc5LDI1IEMgOTksMjUgOTUsMjUgOTUsMjUiCiAgICAgICBpZD0icGF0aDMwNTkiCiAgICAgICBzb2RpcG9kaTpub2RldHlwZXM9ImNjIiAvPgogICAgPHBhdGgKICAgICAgIHN0eWxlPSJmaWxsOm5vbmU7c3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjI7c3Ryb2tlLWxpbmVjYXA6YnV0dDtzdHJva2UtbGluZWpvaW46bWl0ZXI7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICAgIGQ9Ik0gMzEsMTUgNSwxNSIKICAgICAgIGlkPSJwYXRoMzA2MSIgLz4KICAgIDxwYXRoCiAgICAgICBzdHlsZT0iZmlsbDpub25lO3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxLjk5OTk5OTg4O3N0cm9rZS1saW5lY2FwOmJ1dHQ7c3Ryb2tlLWxpbmVqb2luOm1pdGVyO3N0cm9rZS1vcGFjaXR5OjEiCiAgICAgICBkPSJNIDMyLDM1IDUsMzUiCiAgICAgICBpZD0icGF0aDM5NDQiIC8+CiAgICA8ZwogICAgICAgaWQ9ImcyNTYwIgogICAgICAgaW5rc2NhcGU6bGFiZWw9IkxheWVyIDEiCiAgICAgICB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyNi41LC0zOS41KSI+CiAgICAgIDxwYXRoCiAgICAgICAgIHN0eWxlPSJmaWxsOiMwMDAwMDA7ZmlsbC1vcGFjaXR5OjE7ZmlsbC1ydWxlOmV2ZW5vZGQ7c3Ryb2tlOm5vbmU7c3Ryb2tlLXdpZHRoOjM7c3Ryb2tlLWxpbmVjYXA6YnV0dDtzdHJva2UtbGluZWpvaW46bWl0ZXI7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICAgICAgZD0iTSAtMi40MDYyNSw0NC41IEwgLTAuNDA2MjUsNDYuOTM3NSBDIC0wLjQwNjI1LDQ2LjkzNzUgNS4yNSw1My45Mzc1NDkgNS4yNSw2NC41IEMgNS4yNSw3NS4wNjI0NTEgLTAuNDA2MjUsODIuMDYyNSAtMC40MDYyNSw4Mi4wNjI1IEwgLTIuNDA2MjUsODQuNSBMIDAuNzUsODQuNSBMIDE0Ljc1LDg0LjUgQyAxNy4xNTgwNzYsODQuNTAwMDAxIDIyLjQzOTY5OSw4NC41MjQ1MTQgMjguMzc1LDgyLjA5Mzc1IEMgMzQuMzEwMzAxLDc5LjY2Mjk4NiA0MC45MTE1MzYsNzQuNzUwNDg0IDQ2LjA2MjUsNjUuMjE4NzUgTCA0NC43NSw2NC41IEwgNDYuMDYyNSw2My43ODEyNSBDIDM1Ljc1OTM4Nyw0NC43MTU1OSAxOS41MDY1NzQsNDQuNSAxNC43NSw0NC41IEwgMC43NSw0NC41IEwgLTIuNDA2MjUsNDQuNSB6IE0gMy40Njg3NSw0Ny41IEwgMTQuNzUsNDcuNSBDIDE5LjQzNDE3Myw0Ny41IDMzLjAzNjg1LDQ3LjM2OTc5MyA0Mi43MTg3NSw2NC41IEMgMzcuOTUxOTY0LDcyLjkyOTA3NSAzMi4xOTc0NjksNzcuMTgzOTEgMjcsNzkuMzEyNSBDIDIxLjYzOTMzOSw4MS41MDc5MjQgMTcuMTU4MDc1LDgxLjUwMDAwMSAxNC43NSw4MS41IEwgMy41LDgxLjUgQyA1LjM3MzU4ODQsNzguMzkxNTY2IDguMjUsNzIuNDUwNjUgOC4yNSw2NC41IEMgOC4yNSw1Ni41MjY2NDYgNS4zNDE0Njg2LDUwLjU5OTgxNSAzLjQ2ODc1LDQ3LjUgeiIKICAgICAgICAgaWQ9InBhdGg0OTczIgogICAgICAgICBzb2RpcG9kaTpub2RldHlwZXM9ImNjc2NjY2NzY2NjY2NjY2Njc2Njc2MiIC8+CiAgICAgIDxwYXRoCiAgICAgICAgIHNvZGlwb2RpOnR5cGU9ImFyYyIKICAgICAgICAgc3R5bGU9ImZpbGw6bm9uZTtmaWxsLW9wYWNpdHk6MTtzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MztzdHJva2UtbGluZWpvaW46bWl0ZXI7bWFya2VyOm5vbmU7c3Ryb2tlLW9wYWNpdHk6MTt2aXNpYmlsaXR5OnZpc2libGU7ZGlzcGxheTppbmxpbmU7b3ZlcmZsb3c6dmlzaWJsZTtlbmFibGUtYmFja2dyb3VuZDphY2N1bXVsYXRlIgogICAgICAgICBpZD0icGF0aDI2MDQiCiAgICAgICAgIHNvZGlwb2RpOmN4PSI3NSIKICAgICAgICAgc29kaXBvZGk6Y3k9IjI1IgogICAgICAgICBzb2RpcG9kaTpyeD0iNCIKICAgICAgICAgc29kaXBvZGk6cnk9IjQiCiAgICAgICAgIGQ9Ik0gNzksMjUgQSA0LDQgMCAxIDEgNzEsMjUgQSA0LDQgMCAxIDEgNzksMjUgeiIKICAgICAgICAgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTI2LjUsMzkuNSkiIC8+CiAgICA8L2c+CiAgPC9nPgo8L3N2Zz4K"}}},{operation:function(t,e){return!(t||e)}});s.shapes.logic.Gate21.define("logic.Nand",{attrs:{image:{"xlink:href":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhLS0gQ3JlYXRlZCB3aXRoIElua3NjYXBlIChodHRwOi8vd3d3Lmlua3NjYXBlLm9yZy8pIC0tPgo8c3ZnCiAgIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIKICAgeG1sbnM6Y2M9Imh0dHA6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL25zIyIKICAgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIgogICB4bWxuczpzdmc9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogICB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciCiAgIHhtbG5zOnNvZGlwb2RpPSJodHRwOi8vc29kaXBvZGkuc291cmNlZm9yZ2UubmV0L0RURC9zb2RpcG9kaS0wLmR0ZCIKICAgeG1sbnM6aW5rc2NhcGU9Imh0dHA6Ly93d3cuaW5rc2NhcGUub3JnL25hbWVzcGFjZXMvaW5rc2NhcGUiCiAgIHdpZHRoPSIxMDAiCiAgIGhlaWdodD0iNTAiCiAgIGlkPSJzdmcyIgogICBzb2RpcG9kaTp2ZXJzaW9uPSIwLjMyIgogICBpbmtzY2FwZTp2ZXJzaW9uPSIwLjQ2IgogICB2ZXJzaW9uPSIxLjAiCiAgIHNvZGlwb2RpOmRvY25hbWU9Ik5BTkQgQU5TSS5zdmciCiAgIGlua3NjYXBlOm91dHB1dF9leHRlbnNpb249Im9yZy5pbmtzY2FwZS5vdXRwdXQuc3ZnLmlua3NjYXBlIj4KICA8ZGVmcwogICAgIGlkPSJkZWZzNCI+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogMTUgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfeT0iMCA6IDEwMDAgOiAwIgogICAgICAgaW5rc2NhcGU6dnBfej0iNTAgOiAxNSA6IDEiCiAgICAgICBpbmtzY2FwZTpwZXJzcDNkLW9yaWdpbj0iMjUgOiAxMCA6IDEiCiAgICAgICBpZD0icGVyc3BlY3RpdmUyNzE0IiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIgogICAgICAgaW5rc2NhcGU6dnBfeD0iMCA6IDAuNSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF96PSIxIDogMC41IDogMSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIwLjUgOiAwLjMzMzMzMzMzIDogMSIKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI4MDYiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI4MTkiCiAgICAgICBpbmtzY2FwZTpwZXJzcDNkLW9yaWdpbj0iMzcyLjA0NzI0IDogMzUwLjc4NzM5IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9Ijc0NC4wOTQ0OCA6IDUyNi4xODEwOSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogNTI2LjE4MTA5IDogMSIKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI3NzciCiAgICAgICBpbmtzY2FwZTpwZXJzcDNkLW9yaWdpbj0iNzUgOiA0MCA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF96PSIxNTAgOiA2MCA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogNjAgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlMzI3NSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSI1MCA6IDMzLjMzMzMzMyA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF96PSIxMDAgOiA1MCA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogNTAgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlNTUzMyIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIzMiA6IDIxLjMzMzMzMyA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF96PSI2NCA6IDMyIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiAzMiA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogIDwvZGVmcz4KICA8c29kaXBvZGk6bmFtZWR2aWV3CiAgICAgaWQ9ImJhc2UiCiAgICAgcGFnZWNvbG9yPSIjZmZmZmZmIgogICAgIGJvcmRlcmNvbG9yPSIjNjY2NjY2IgogICAgIGJvcmRlcm9wYWNpdHk9IjEuMCIKICAgICBpbmtzY2FwZTpwYWdlb3BhY2l0eT0iMC4wIgogICAgIGlua3NjYXBlOnBhZ2VzaGFkb3c9IjIiCiAgICAgaW5rc2NhcGU6em9vbT0iMTYiCiAgICAgaW5rc2NhcGU6Y3g9Ijc4LjI4MzMwNyIKICAgICBpbmtzY2FwZTpjeT0iMTYuNDQyODQzIgogICAgIGlua3NjYXBlOmRvY3VtZW50LXVuaXRzPSJweCIKICAgICBpbmtzY2FwZTpjdXJyZW50LWxheWVyPSJsYXllcjEiCiAgICAgc2hvd2dyaWQ9InRydWUiCiAgICAgaW5rc2NhcGU6Z3JpZC1iYm94PSJ0cnVlIgogICAgIGlua3NjYXBlOmdyaWQtcG9pbnRzPSJ0cnVlIgogICAgIGdyaWR0b2xlcmFuY2U9IjEwMDAwIgogICAgIGlua3NjYXBlOndpbmRvdy13aWR0aD0iMTM5OSIKICAgICBpbmtzY2FwZTp3aW5kb3ctaGVpZ2h0PSI4NzQiCiAgICAgaW5rc2NhcGU6d2luZG93LXg9IjMzIgogICAgIGlua3NjYXBlOndpbmRvdy15PSIwIgogICAgIGlua3NjYXBlOnNuYXAtYmJveD0idHJ1ZSI+CiAgICA8aW5rc2NhcGU6Z3JpZAogICAgICAgaWQ9IkdyaWRGcm9tUHJlMDQ2U2V0dGluZ3MiCiAgICAgICB0eXBlPSJ4eWdyaWQiCiAgICAgICBvcmlnaW54PSIwcHgiCiAgICAgICBvcmlnaW55PSIwcHgiCiAgICAgICBzcGFjaW5neD0iMXB4IgogICAgICAgc3BhY2luZ3k9IjFweCIKICAgICAgIGNvbG9yPSIjMDAwMGZmIgogICAgICAgZW1wY29sb3I9IiMwMDAwZmYiCiAgICAgICBvcGFjaXR5PSIwLjIiCiAgICAgICBlbXBvcGFjaXR5PSIwLjQiCiAgICAgICBlbXBzcGFjaW5nPSI1IgogICAgICAgdmlzaWJsZT0idHJ1ZSIKICAgICAgIGVuYWJsZWQ9InRydWUiIC8+CiAgPC9zb2RpcG9kaTpuYW1lZHZpZXc+CiAgPG1ldGFkYXRhCiAgICAgaWQ9Im1ldGFkYXRhNyI+CiAgICA8cmRmOlJERj4KICAgICAgPGNjOldvcmsKICAgICAgICAgcmRmOmFib3V0PSIiPgogICAgICAgIDxkYzpmb3JtYXQ+aW1hZ2Uvc3ZnK3htbDwvZGM6Zm9ybWF0PgogICAgICAgIDxkYzp0eXBlCiAgICAgICAgICAgcmRmOnJlc291cmNlPSJodHRwOi8vcHVybC5vcmcvZGMvZGNtaXR5cGUvU3RpbGxJbWFnZSIgLz4KICAgICAgPC9jYzpXb3JrPgogICAgPC9yZGY6UkRGPgogIDwvbWV0YWRhdGE+CiAgPGcKICAgICBpbmtzY2FwZTpsYWJlbD0iTGF5ZXIgMSIKICAgICBpbmtzY2FwZTpncm91cG1vZGU9ImxheWVyIgogICAgIGlkPSJsYXllcjEiPgogICAgPHBhdGgKICAgICAgIHN0eWxlPSJmaWxsOm5vbmU7c3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjI7c3Ryb2tlLWxpbmVjYXA6YnV0dDtzdHJva2UtbGluZWpvaW46bWl0ZXI7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICAgIGQ9Ik0gNzksMjUgQyA5MS44LDI1IDk1LDI1IDk1LDI1IgogICAgICAgaWQ9InBhdGgzMDU5IgogICAgICAgc29kaXBvZGk6bm9kZXR5cGVzPSJjYyIgLz4KICAgIDxwYXRoCiAgICAgICBzdHlsZT0iZmlsbDpub25lO3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoyO3N0cm9rZS1saW5lY2FwOmJ1dHQ7c3Ryb2tlLWxpbmVqb2luOm1pdGVyO3N0cm9rZS1vcGFjaXR5OjEiCiAgICAgICBkPSJNIDMxLDE1IDUsMTUiCiAgICAgICBpZD0icGF0aDMwNjEiIC8+CiAgICA8cGF0aAogICAgICAgc3R5bGU9ImZpbGw6bm9uZTtzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MS45OTk5OTk4ODtzdHJva2UtbGluZWNhcDpidXR0O3N0cm9rZS1saW5lam9pbjptaXRlcjtzdHJva2Utb3BhY2l0eToxIgogICAgICAgZD0iTSAzMiwzNSA1LDM1IgogICAgICAgaWQ9InBhdGgzOTQ0IiAvPgogICAgPHBhdGgKICAgICAgIHN0eWxlPSJmb250LXNpemU6bWVkaXVtO2ZvbnQtc3R5bGU6bm9ybWFsO2ZvbnQtdmFyaWFudDpub3JtYWw7Zm9udC13ZWlnaHQ6bm9ybWFsO2ZvbnQtc3RyZXRjaDpub3JtYWw7dGV4dC1pbmRlbnQ6MDt0ZXh0LWFsaWduOnN0YXJ0O3RleHQtZGVjb3JhdGlvbjpub25lO2xpbmUtaGVpZ2h0Om5vcm1hbDtsZXR0ZXItc3BhY2luZzpub3JtYWw7d29yZC1zcGFjaW5nOm5vcm1hbDt0ZXh0LXRyYW5zZm9ybTpub25lO2RpcmVjdGlvbjpsdHI7YmxvY2stcHJvZ3Jlc3Npb246dGI7d3JpdGluZy1tb2RlOmxyLXRiO3RleHQtYW5jaG9yOnN0YXJ0O2ZpbGw6IzAwMDAwMDtmaWxsLW9wYWNpdHk6MTtzdHJva2U6bm9uZTtzdHJva2Utd2lkdGg6MzttYXJrZXI6bm9uZTt2aXNpYmlsaXR5OnZpc2libGU7ZGlzcGxheTppbmxpbmU7b3ZlcmZsb3c6dmlzaWJsZTtlbmFibGUtYmFja2dyb3VuZDphY2N1bXVsYXRlO2ZvbnQtZmFtaWx5OkJpdHN0cmVhbSBWZXJhIFNhbnM7LWlua3NjYXBlLWZvbnQtc3BlY2lmaWNhdGlvbjpCaXRzdHJlYW0gVmVyYSBTYW5zIgogICAgICAgZD0iTSAzMCw1IEwgMzAsNi40Mjg1NzE0IEwgMzAsNDMuNTcxNDI5IEwgMzAsNDUgTCAzMS40Mjg1NzEsNDUgTCA1MC40NzYxOSw0NSBDIDYxLjc0NDA5OCw0NSA3MC40NzYxOSwzNS45OTk5NTUgNzAuNDc2MTksMjUgQyA3MC40NzYxOSwxNC4wMDAwNDUgNjEuNzQ0MDk5LDUuMDAwMDAwMiA1MC40NzYxOSw1IEMgNTAuNDc2MTksNSA1MC40NzYxOSw1IDMxLjQyODU3MSw1IEwgMzAsNSB6IE0gMzIuODU3MTQzLDcuODU3MTQyOSBDIDQwLjgzNDI2NCw3Ljg1NzE0MjkgNDUuOTE4MzY4LDcuODU3MTQyOSA0OC4wOTUyMzgsNy44NTcxNDI5IEMgNDkuMjg1NzE0LDcuODU3MTQyOSA0OS44ODA5NTIsNy44NTcxNDI5IDUwLjE3ODU3MSw3Ljg1NzE0MjkgQyA1MC4zMjczODEsNy44NTcxNDI5IDUwLjQwOTIyNyw3Ljg1NzE0MjkgNTAuNDQ2NDI5LDcuODU3MTQyOSBDIDUwLjQ2NTAyOSw3Ljg1NzE0MjkgNTAuNDcxNTQzLDcuODU3MTQyOSA1MC40NzYxOSw3Ljg1NzE0MjkgQyA2MC4yMzY4NTMsNy44NTcxNDMgNjcuMTQyODU3LDE1LjQ5NzA5OCA2Ny4xNDI4NTcsMjUgQyA2Ny4xNDI4NTcsMzQuNTAyOTAyIDU5Ljc2MDY2Miw0Mi4xNDI4NTcgNTAsNDIuMTQyODU3IEwgMzIuODU3MTQzLDQyLjE0Mjg1NyBMIDMyLjg1NzE0Myw3Ljg1NzE0MjkgeiIKICAgICAgIGlkPSJwYXRoMjg4NCIKICAgICAgIHNvZGlwb2RpOm5vZGV0eXBlcz0iY2NjY2Njc2NjY2Nzc3Nzc2NjYyIgLz4KICAgIDxwYXRoCiAgICAgICBzb2RpcG9kaTp0eXBlPSJhcmMiCiAgICAgICBzdHlsZT0iZmlsbDpub25lO2ZpbGwtb3BhY2l0eToxO3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDozO3N0cm9rZS1saW5lam9pbjptaXRlcjttYXJrZXI6bm9uZTtzdHJva2Utb3BhY2l0eToxO3Zpc2liaWxpdHk6dmlzaWJsZTtkaXNwbGF5OmlubGluZTtvdmVyZmxvdzp2aXNpYmxlO2VuYWJsZS1iYWNrZ3JvdW5kOmFjY3VtdWxhdGUiCiAgICAgICBpZD0icGF0aDQwMDgiCiAgICAgICBzb2RpcG9kaTpjeD0iNzUiCiAgICAgICBzb2RpcG9kaTpjeT0iMjUiCiAgICAgICBzb2RpcG9kaTpyeD0iNCIKICAgICAgIHNvZGlwb2RpOnJ5PSI0IgogICAgICAgZD0iTSA3OSwyNSBBIDQsNCAwIDEgMSA3MSwyNSBBIDQsNCAwIDEgMSA3OSwyNSB6IiAvPgogIDwvZz4KPC9zdmc+Cg=="}}},{operation:function(t,e){return!(t&&e)}});s.shapes.logic.Gate21.define("logic.Xor",{attrs:{image:{"xlink:href":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhLS0gQ3JlYXRlZCB3aXRoIElua3NjYXBlIChodHRwOi8vd3d3Lmlua3NjYXBlLm9yZy8pIC0tPgo8c3ZnCiAgIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIKICAgeG1sbnM6Y2M9Imh0dHA6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL25zIyIKICAgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIgogICB4bWxuczpzdmc9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogICB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciCiAgIHhtbG5zOnNvZGlwb2RpPSJodHRwOi8vc29kaXBvZGkuc291cmNlZm9yZ2UubmV0L0RURC9zb2RpcG9kaS0wLmR0ZCIKICAgeG1sbnM6aW5rc2NhcGU9Imh0dHA6Ly93d3cuaW5rc2NhcGUub3JnL25hbWVzcGFjZXMvaW5rc2NhcGUiCiAgIHdpZHRoPSIxMDAiCiAgIGhlaWdodD0iNTAiCiAgIGlkPSJzdmcyIgogICBzb2RpcG9kaTp2ZXJzaW9uPSIwLjMyIgogICBpbmtzY2FwZTp2ZXJzaW9uPSIwLjQ2IgogICB2ZXJzaW9uPSIxLjAiCiAgIHNvZGlwb2RpOmRvY25hbWU9IlhPUiBBTlNJLnN2ZyIKICAgaW5rc2NhcGU6b3V0cHV0X2V4dGVuc2lvbj0ib3JnLmlua3NjYXBlLm91dHB1dC5zdmcuaW5rc2NhcGUiPgogIDxkZWZzCiAgICAgaWQ9ImRlZnM0Ij4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiAxNSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF96PSI1MCA6IDE1IDogMSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIyNSA6IDEwIDogMSIKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI3MTQiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogMC41IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3o9IjEgOiAwLjUgOiAxIgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjAuNSA6IDAuMzMzMzMzMzMgOiAxIgogICAgICAgaWQ9InBlcnNwZWN0aXZlMjgwNiIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlMjgxOSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIzNzIuMDQ3MjQgOiAzNTAuNzg3MzkgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfej0iNzQ0LjA5NDQ4IDogNTI2LjE4MTA5IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA1MjYuMTgxMDkgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlMjc3NyIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSI3NSA6IDQwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjE1MCA6IDYwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA2MCA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBpZD0icGVyc3BlY3RpdmUzMjc1IgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjUwIDogMzMuMzMzMzMzIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjEwMCA6IDUwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA1MCA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBpZD0icGVyc3BlY3RpdmU1NTMzIgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjMyIDogMjEuMzMzMzMzIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjY0IDogMzIgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfeT0iMCA6IDEwMDAgOiAwIgogICAgICAgaW5rc2NhcGU6dnBfeD0iMCA6IDMyIDogMSIKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI1NTciCiAgICAgICBpbmtzY2FwZTpwZXJzcDNkLW9yaWdpbj0iMjUgOiAxNi42NjY2NjcgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfej0iNTAgOiAyNSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogMjUgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICA8L2RlZnM+CiAgPHNvZGlwb2RpOm5hbWVkdmlldwogICAgIGlkPSJiYXNlIgogICAgIHBhZ2Vjb2xvcj0iI2ZmZmZmZiIKICAgICBib3JkZXJjb2xvcj0iIzY2NjY2NiIKICAgICBib3JkZXJvcGFjaXR5PSIxLjAiCiAgICAgaW5rc2NhcGU6cGFnZW9wYWNpdHk9IjAuMCIKICAgICBpbmtzY2FwZTpwYWdlc2hhZG93PSIyIgogICAgIGlua3NjYXBlOnpvb209IjUuNjU2ODU0MiIKICAgICBpbmtzY2FwZTpjeD0iMjUuOTM4MTE2IgogICAgIGlua3NjYXBlOmN5PSIxNy4yMzAwNSIKICAgICBpbmtzY2FwZTpkb2N1bWVudC11bml0cz0icHgiCiAgICAgaW5rc2NhcGU6Y3VycmVudC1sYXllcj0ibGF5ZXIxIgogICAgIHNob3dncmlkPSJ0cnVlIgogICAgIGlua3NjYXBlOmdyaWQtYmJveD0idHJ1ZSIKICAgICBpbmtzY2FwZTpncmlkLXBvaW50cz0idHJ1ZSIKICAgICBncmlkdG9sZXJhbmNlPSIxMDAwMCIKICAgICBpbmtzY2FwZTp3aW5kb3ctd2lkdGg9IjEzOTkiCiAgICAgaW5rc2NhcGU6d2luZG93LWhlaWdodD0iODc0IgogICAgIGlua3NjYXBlOndpbmRvdy14PSIzMyIKICAgICBpbmtzY2FwZTp3aW5kb3cteT0iMCIKICAgICBpbmtzY2FwZTpzbmFwLWJib3g9InRydWUiPgogICAgPGlua3NjYXBlOmdyaWQKICAgICAgIGlkPSJHcmlkRnJvbVByZTA0NlNldHRpbmdzIgogICAgICAgdHlwZT0ieHlncmlkIgogICAgICAgb3JpZ2lueD0iMHB4IgogICAgICAgb3JpZ2lueT0iMHB4IgogICAgICAgc3BhY2luZ3g9IjFweCIKICAgICAgIHNwYWNpbmd5PSIxcHgiCiAgICAgICBjb2xvcj0iIzAwMDBmZiIKICAgICAgIGVtcGNvbG9yPSIjMDAwMGZmIgogICAgICAgb3BhY2l0eT0iMC4yIgogICAgICAgZW1wb3BhY2l0eT0iMC40IgogICAgICAgZW1wc3BhY2luZz0iNSIKICAgICAgIHZpc2libGU9InRydWUiCiAgICAgICBlbmFibGVkPSJ0cnVlIiAvPgogIDwvc29kaXBvZGk6bmFtZWR2aWV3PgogIDxtZXRhZGF0YQogICAgIGlkPSJtZXRhZGF0YTciPgogICAgPHJkZjpSREY+CiAgICAgIDxjYzpXb3JrCiAgICAgICAgIHJkZjphYm91dD0iIj4KICAgICAgICA8ZGM6Zm9ybWF0PmltYWdlL3N2Zyt4bWw8L2RjOmZvcm1hdD4KICAgICAgICA8ZGM6dHlwZQogICAgICAgICAgIHJkZjpyZXNvdXJjZT0iaHR0cDovL3B1cmwub3JnL2RjL2RjbWl0eXBlL1N0aWxsSW1hZ2UiIC8+CiAgICAgIDwvY2M6V29yaz4KICAgIDwvcmRmOlJERj4KICA8L21ldGFkYXRhPgogIDxnCiAgICAgaW5rc2NhcGU6bGFiZWw9IkxheWVyIDEiCiAgICAgaW5rc2NhcGU6Z3JvdXBtb2RlPSJsYXllciIKICAgICBpZD0ibGF5ZXIxIj4KICAgIDxwYXRoCiAgICAgICBzdHlsZT0iZmlsbDpub25lO3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoyO3N0cm9rZS1saW5lY2FwOmJ1dHQ7c3Ryb2tlLWxpbmVqb2luOm1pdGVyO3N0cm9rZS1vcGFjaXR5OjEiCiAgICAgICBkPSJtIDcwLDI1IGMgMjAsMCAyNSwwIDI1LDAiCiAgICAgICBpZD0icGF0aDMwNTkiCiAgICAgICBzb2RpcG9kaTpub2RldHlwZXM9ImNjIiAvPgogICAgPHBhdGgKICAgICAgIHN0eWxlPSJmaWxsOm5vbmU7c3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjEuOTk5OTk5ODg7c3Ryb2tlLWxpbmVjYXA6YnV0dDtzdHJva2UtbGluZWpvaW46bWl0ZXI7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICAgIGQ9Ik0gMzAuMzg1NzE3LDE1IEwgNC45OTk5OTk4LDE1IgogICAgICAgaWQ9InBhdGgzMDYxIiAvPgogICAgPHBhdGgKICAgICAgIHN0eWxlPSJmaWxsOm5vbmU7c3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjEuOTk5OTk5NzY7c3Ryb2tlLWxpbmVjYXA6YnV0dDtzdHJva2UtbGluZWpvaW46bWl0ZXI7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICAgIGQ9Ik0gMzEuMzYyMDkxLDM1IEwgNC45OTk5OTk4LDM1IgogICAgICAgaWQ9InBhdGgzOTQ0IiAvPgogICAgPGcKICAgICAgIGlkPSJnMjU2MCIKICAgICAgIGlua3NjYXBlOmxhYmVsPSJMYXllciAxIgogICAgICAgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMjYuNSwtMzkuNSkiPgogICAgICA8cGF0aAogICAgICAgICBpZD0icGF0aDM1MTYiCiAgICAgICAgIHN0eWxlPSJmaWxsOiMwMDAwMDA7ZmlsbC1vcGFjaXR5OjE7ZmlsbC1ydWxlOmV2ZW5vZGQ7c3Ryb2tlOm5vbmU7c3Ryb2tlLXdpZHRoOjM7c3Ryb2tlLWxpbmVjYXA6YnV0dDtzdHJva2UtbGluZWpvaW46bWl0ZXI7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICAgICAgZD0iTSAtMi4yNSw4MS41MDAwMDUgQyAtMy44NDczNzQsODQuMTQ0NDA1IC00LjUsODQuNTAwMDA1IC00LjUsODQuNTAwMDA1IEwgLTguMTU2MjUsODQuNTAwMDA1IEwgLTYuMTU2MjUsODIuMDYyNTA1IEMgLTYuMTU2MjUsODIuMDYyNTA1IC0wLjUsNzUuMDYyNDUxIC0wLjUsNjQuNSBDIC0wLjUsNTMuOTM3NTQ5IC02LjE1NjI1LDQ2LjkzNzUgLTYuMTU2MjUsNDYuOTM3NSBMIC04LjE1NjI1LDQ0LjUgTCAtNC41LDQ0LjUgQyAtMy43MTg3NSw0NS40Mzc1IC0zLjA3ODEyNSw0Ni4xNTYyNSAtMi4yODEyNSw0Ny41IEMgLTAuNDA4NTMxLDUwLjU5OTgxNSAyLjUsNTYuNTI2NjQ2IDIuNSw2NC41IEMgMi41LDcyLjQ1MDY1IC0wLjM5NjY5Nyw3OC4zNzk0MjUgLTIuMjUsODEuNTAwMDA1IHoiCiAgICAgICAgIHNvZGlwb2RpOm5vZGV0eXBlcz0iY2NjY3NjY2Njc2MiIC8+CiAgICAgIDxwYXRoCiAgICAgICAgIHN0eWxlPSJmaWxsOiMwMDAwMDA7ZmlsbC1vcGFjaXR5OjE7ZmlsbC1ydWxlOmV2ZW5vZGQ7c3Ryb2tlOm5vbmU7c3Ryb2tlLXdpZHRoOjM7c3Ryb2tlLWxpbmVjYXA6YnV0dDtzdHJva2UtbGluZWpvaW46bWl0ZXI7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICAgICAgZD0iTSAtMi40MDYyNSw0NC41IEwgLTAuNDA2MjUsNDYuOTM3NSBDIC0wLjQwNjI1LDQ2LjkzNzUgNS4yNSw1My45Mzc1NDkgNS4yNSw2NC41IEMgNS4yNSw3NS4wNjI0NTEgLTAuNDA2MjUsODIuMDYyNSAtMC40MDYyNSw4Mi4wNjI1IEwgLTIuNDA2MjUsODQuNSBMIDAuNzUsODQuNSBMIDE0Ljc1LDg0LjUgQyAxNy4xNTgwNzYsODQuNTAwMDAxIDIyLjQzOTY5OSw4NC41MjQ1MTQgMjguMzc1LDgyLjA5Mzc1IEMgMzQuMzEwMzAxLDc5LjY2Mjk4NiA0MC45MTE1MzYsNzQuNzUwNDg0IDQ2LjA2MjUsNjUuMjE4NzUgTCA0NC43NSw2NC41IEwgNDYuMDYyNSw2My43ODEyNSBDIDM1Ljc1OTM4Nyw0NC43MTU1OSAxOS41MDY1NzQsNDQuNSAxNC43NSw0NC41IEwgMC43NSw0NC41IEwgLTIuNDA2MjUsNDQuNSB6IE0gMy40Njg3NSw0Ny41IEwgMTQuNzUsNDcuNSBDIDE5LjQzNDE3Myw0Ny41IDMzLjAzNjg1LDQ3LjM2OTc5MyA0Mi43MTg3NSw2NC41IEMgMzcuOTUxOTY0LDcyLjkyOTA3NSAzMi4xOTc0NjksNzcuMTgzOTEgMjcsNzkuMzEyNSBDIDIxLjYzOTMzOSw4MS41MDc5MjQgMTcuMTU4MDc1LDgxLjUwMDAwMSAxNC43NSw4MS41IEwgMy41LDgxLjUgQyA1LjM3MzU4ODQsNzguMzkxNTY2IDguMjUsNzIuNDUwNjUgOC4yNSw2NC41IEMgOC4yNSw1Ni41MjY2NDYgNS4zNDE0Njg2LDUwLjU5OTgxNSAzLjQ2ODc1LDQ3LjUgeiIKICAgICAgICAgaWQ9InBhdGg0OTczIgogICAgICAgICBzb2RpcG9kaTpub2RldHlwZXM9ImNjc2NjY2NzY2NjY2NjY2Njc2Njc2MiIC8+CiAgICA8L2c+CiAgPC9nPgo8L3N2Zz4K"}}},{operation:function(t,e){return(!t||e)&&(t||!e)}});s.shapes.logic.Gate21.define("logic.Xnor",{attrs:{image:{"xlink:href":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhLS0gQ3JlYXRlZCB3aXRoIElua3NjYXBlIChodHRwOi8vd3d3Lmlua3NjYXBlLm9yZy8pIC0tPgo8c3ZnCiAgIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIKICAgeG1sbnM6Y2M9Imh0dHA6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL25zIyIKICAgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIgogICB4bWxuczpzdmc9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogICB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciCiAgIHhtbG5zOnNvZGlwb2RpPSJodHRwOi8vc29kaXBvZGkuc291cmNlZm9yZ2UubmV0L0RURC9zb2RpcG9kaS0wLmR0ZCIKICAgeG1sbnM6aW5rc2NhcGU9Imh0dHA6Ly93d3cuaW5rc2NhcGUub3JnL25hbWVzcGFjZXMvaW5rc2NhcGUiCiAgIHdpZHRoPSIxMDAiCiAgIGhlaWdodD0iNTAiCiAgIGlkPSJzdmcyIgogICBzb2RpcG9kaTp2ZXJzaW9uPSIwLjMyIgogICBpbmtzY2FwZTp2ZXJzaW9uPSIwLjQ2IgogICB2ZXJzaW9uPSIxLjAiCiAgIHNvZGlwb2RpOmRvY25hbWU9IlhOT1IgQU5TSS5zdmciCiAgIGlua3NjYXBlOm91dHB1dF9leHRlbnNpb249Im9yZy5pbmtzY2FwZS5vdXRwdXQuc3ZnLmlua3NjYXBlIj4KICA8ZGVmcwogICAgIGlkPSJkZWZzNCI+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogMTUgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfeT0iMCA6IDEwMDAgOiAwIgogICAgICAgaW5rc2NhcGU6dnBfej0iNTAgOiAxNSA6IDEiCiAgICAgICBpbmtzY2FwZTpwZXJzcDNkLW9yaWdpbj0iMjUgOiAxMCA6IDEiCiAgICAgICBpZD0icGVyc3BlY3RpdmUyNzE0IiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIgogICAgICAgaW5rc2NhcGU6dnBfeD0iMCA6IDAuNSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF96PSIxIDogMC41IDogMSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIwLjUgOiAwLjMzMzMzMzMzIDogMSIKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI4MDYiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI4MTkiCiAgICAgICBpbmtzY2FwZTpwZXJzcDNkLW9yaWdpbj0iMzcyLjA0NzI0IDogMzUwLjc4NzM5IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9Ijc0NC4wOTQ0OCA6IDUyNi4xODEwOSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogNTI2LjE4MTA5IDogMSIKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI3NzciCiAgICAgICBpbmtzY2FwZTpwZXJzcDNkLW9yaWdpbj0iNzUgOiA0MCA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF96PSIxNTAgOiA2MCA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogNjAgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlMzI3NSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSI1MCA6IDMzLjMzMzMzMyA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF96PSIxMDAgOiA1MCA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogNTAgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlNTUzMyIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIzMiA6IDIxLjMzMzMzMyA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF96PSI2NCA6IDMyIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiAzMiA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBpZD0icGVyc3BlY3RpdmUyNTU3IgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjI1IDogMTYuNjY2NjY3IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjUwIDogMjUgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfeT0iMCA6IDEwMDAgOiAwIgogICAgICAgaW5rc2NhcGU6dnBfeD0iMCA6IDI1IDogMSIKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiIC8+CiAgPC9kZWZzPgogIDxzb2RpcG9kaTpuYW1lZHZpZXcKICAgICBpZD0iYmFzZSIKICAgICBwYWdlY29sb3I9IiNmZmZmZmYiCiAgICAgYm9yZGVyY29sb3I9IiM2NjY2NjYiCiAgICAgYm9yZGVyb3BhY2l0eT0iMS4wIgogICAgIGlua3NjYXBlOnBhZ2VvcGFjaXR5PSIwLjAiCiAgICAgaW5rc2NhcGU6cGFnZXNoYWRvdz0iMiIKICAgICBpbmtzY2FwZTp6b29tPSI0IgogICAgIGlua3NjYXBlOmN4PSI5NS43MjM2NiIKICAgICBpbmtzY2FwZTpjeT0iLTI2Ljc3NTAyMyIKICAgICBpbmtzY2FwZTpkb2N1bWVudC11bml0cz0icHgiCiAgICAgaW5rc2NhcGU6Y3VycmVudC1sYXllcj0ibGF5ZXIxIgogICAgIHNob3dncmlkPSJ0cnVlIgogICAgIGlua3NjYXBlOmdyaWQtYmJveD0idHJ1ZSIKICAgICBpbmtzY2FwZTpncmlkLXBvaW50cz0idHJ1ZSIKICAgICBncmlkdG9sZXJhbmNlPSIxMDAwMCIKICAgICBpbmtzY2FwZTp3aW5kb3ctd2lkdGg9IjEzOTkiCiAgICAgaW5rc2NhcGU6d2luZG93LWhlaWdodD0iODc0IgogICAgIGlua3NjYXBlOndpbmRvdy14PSIzMyIKICAgICBpbmtzY2FwZTp3aW5kb3cteT0iMCIKICAgICBpbmtzY2FwZTpzbmFwLWJib3g9InRydWUiPgogICAgPGlua3NjYXBlOmdyaWQKICAgICAgIGlkPSJHcmlkRnJvbVByZTA0NlNldHRpbmdzIgogICAgICAgdHlwZT0ieHlncmlkIgogICAgICAgb3JpZ2lueD0iMHB4IgogICAgICAgb3JpZ2lueT0iMHB4IgogICAgICAgc3BhY2luZ3g9IjFweCIKICAgICAgIHNwYWNpbmd5PSIxcHgiCiAgICAgICBjb2xvcj0iIzAwMDBmZiIKICAgICAgIGVtcGNvbG9yPSIjMDAwMGZmIgogICAgICAgb3BhY2l0eT0iMC4yIgogICAgICAgZW1wb3BhY2l0eT0iMC40IgogICAgICAgZW1wc3BhY2luZz0iNSIKICAgICAgIHZpc2libGU9InRydWUiCiAgICAgICBlbmFibGVkPSJ0cnVlIiAvPgogIDwvc29kaXBvZGk6bmFtZWR2aWV3PgogIDxtZXRhZGF0YQogICAgIGlkPSJtZXRhZGF0YTciPgogICAgPHJkZjpSREY+CiAgICAgIDxjYzpXb3JrCiAgICAgICAgIHJkZjphYm91dD0iIj4KICAgICAgICA8ZGM6Zm9ybWF0PmltYWdlL3N2Zyt4bWw8L2RjOmZvcm1hdD4KICAgICAgICA8ZGM6dHlwZQogICAgICAgICAgIHJkZjpyZXNvdXJjZT0iaHR0cDovL3B1cmwub3JnL2RjL2RjbWl0eXBlL1N0aWxsSW1hZ2UiIC8+CiAgICAgIDwvY2M6V29yaz4KICAgIDwvcmRmOlJERj4KICA8L21ldGFkYXRhPgogIDxnCiAgICAgaW5rc2NhcGU6bGFiZWw9IkxheWVyIDEiCiAgICAgaW5rc2NhcGU6Z3JvdXBtb2RlPSJsYXllciIKICAgICBpZD0ibGF5ZXIxIj4KICAgIDxwYXRoCiAgICAgICBzdHlsZT0iZmlsbDpub25lO3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoyLjAwMDAwMDI0O3N0cm9rZS1saW5lY2FwOmJ1dHQ7c3Ryb2tlLWxpbmVqb2luOm1pdGVyO3N0cm9rZS1vcGFjaXR5OjEiCiAgICAgICBkPSJNIDc4LjMzMzMzMiwyNSBDIDkxLjY2NjY2NiwyNSA5NSwyNSA5NSwyNSIKICAgICAgIGlkPSJwYXRoMzA1OSIKICAgICAgIHNvZGlwb2RpOm5vZGV0eXBlcz0iY2MiIC8+CiAgICA8cGF0aAogICAgICAgc3R5bGU9ImZpbGw6bm9uZTtzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MS45OTk5OTk4ODtzdHJva2UtbGluZWNhcDpidXR0O3N0cm9rZS1saW5lam9pbjptaXRlcjtzdHJva2Utb3BhY2l0eToxIgogICAgICAgZD0iTSAzMC4zODU3MTcsMTUgTCA0Ljk5OTk5OTgsMTUiCiAgICAgICBpZD0icGF0aDMwNjEiIC8+CiAgICA8cGF0aAogICAgICAgc3R5bGU9ImZpbGw6bm9uZTtzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MS45OTk5OTk3NjtzdHJva2UtbGluZWNhcDpidXR0O3N0cm9rZS1saW5lam9pbjptaXRlcjtzdHJva2Utb3BhY2l0eToxIgogICAgICAgZD0iTSAzMS4zNjIwOTEsMzUgTCA0Ljk5OTk5OTgsMzUiCiAgICAgICBpZD0icGF0aDM5NDQiIC8+CiAgICA8ZwogICAgICAgaWQ9ImcyNTYwIgogICAgICAgaW5rc2NhcGU6bGFiZWw9IkxheWVyIDEiCiAgICAgICB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyNi41LC0zOS41KSI+CiAgICAgIDxwYXRoCiAgICAgICAgIGlkPSJwYXRoMzUxNiIKICAgICAgICAgc3R5bGU9ImZpbGw6IzAwMDAwMDtmaWxsLW9wYWNpdHk6MTtmaWxsLXJ1bGU6ZXZlbm9kZDtzdHJva2U6bm9uZTtzdHJva2Utd2lkdGg6MztzdHJva2UtbGluZWNhcDpidXR0O3N0cm9rZS1saW5lam9pbjptaXRlcjtzdHJva2Utb3BhY2l0eToxIgogICAgICAgICBkPSJNIC0yLjI1LDgxLjUwMDAwNSBDIC0zLjg0NzM3NCw4NC4xNDQ0MDUgLTQuNSw4NC41MDAwMDUgLTQuNSw4NC41MDAwMDUgTCAtOC4xNTYyNSw4NC41MDAwMDUgTCAtNi4xNTYyNSw4Mi4wNjI1MDUgQyAtNi4xNTYyNSw4Mi4wNjI1MDUgLTAuNSw3NS4wNjI0NTEgLTAuNSw2NC41IEMgLTAuNSw1My45Mzc1NDkgLTYuMTU2MjUsNDYuOTM3NSAtNi4xNTYyNSw0Ni45Mzc1IEwgLTguMTU2MjUsNDQuNSBMIC00LjUsNDQuNSBDIC0zLjcxODc1LDQ1LjQzNzUgLTMuMDc4MTI1LDQ2LjE1NjI1IC0yLjI4MTI1LDQ3LjUgQyAtMC40MDg1MzEsNTAuNTk5ODE1IDIuNSw1Ni41MjY2NDYgMi41LDY0LjUgQyAyLjUsNzIuNDUwNjUgLTAuMzk2Njk3LDc4LjM3OTQyNSAtMi4yNSw4MS41MDAwMDUgeiIKICAgICAgICAgc29kaXBvZGk6bm9kZXR5cGVzPSJjY2Njc2NjY2NzYyIgLz4KICAgICAgPHBhdGgKICAgICAgICAgc3R5bGU9ImZpbGw6IzAwMDAwMDtmaWxsLW9wYWNpdHk6MTtmaWxsLXJ1bGU6ZXZlbm9kZDtzdHJva2U6bm9uZTtzdHJva2Utd2lkdGg6MztzdHJva2UtbGluZWNhcDpidXR0O3N0cm9rZS1saW5lam9pbjptaXRlcjtzdHJva2Utb3BhY2l0eToxIgogICAgICAgICBkPSJNIC0yLjQwNjI1LDQ0LjUgTCAtMC40MDYyNSw0Ni45Mzc1IEMgLTAuNDA2MjUsNDYuOTM3NSA1LjI1LDUzLjkzNzU0OSA1LjI1LDY0LjUgQyA1LjI1LDc1LjA2MjQ1MSAtMC40MDYyNSw4Mi4wNjI1IC0wLjQwNjI1LDgyLjA2MjUgTCAtMi40MDYyNSw4NC41IEwgMC43NSw4NC41IEwgMTQuNzUsODQuNSBDIDE3LjE1ODA3Niw4NC41MDAwMDEgMjIuNDM5Njk5LDg0LjUyNDUxNCAyOC4zNzUsODIuMDkzNzUgQyAzNC4zMTAzMDEsNzkuNjYyOTg2IDQwLjkxMTUzNiw3NC43NTA0ODQgNDYuMDYyNSw2NS4yMTg3NSBMIDQ0Ljc1LDY0LjUgTCA0Ni4wNjI1LDYzLjc4MTI1IEMgMzUuNzU5Mzg3LDQ0LjcxNTU5IDE5LjUwNjU3NCw0NC41IDE0Ljc1LDQ0LjUgTCAwLjc1LDQ0LjUgTCAtMi40MDYyNSw0NC41IHogTSAzLjQ2ODc1LDQ3LjUgTCAxNC43NSw0Ny41IEMgMTkuNDM0MTczLDQ3LjUgMzMuMDM2ODUsNDcuMzY5NzkzIDQyLjcxODc1LDY0LjUgQyAzNy45NTE5NjQsNzIuOTI5MDc1IDMyLjE5NzQ2OSw3Ny4xODM5MSAyNyw3OS4zMTI1IEMgMjEuNjM5MzM5LDgxLjUwNzkyNCAxNy4xNTgwNzUsODEuNTAwMDAxIDE0Ljc1LDgxLjUgTCAzLjUsODEuNSBDIDUuMzczNTg4NCw3OC4zOTE1NjYgOC4yNSw3Mi40NTA2NSA4LjI1LDY0LjUgQyA4LjI1LDU2LjUyNjY0NiA1LjM0MTQ2ODYsNTAuNTk5ODE1IDMuNDY4NzUsNDcuNSB6IgogICAgICAgICBpZD0icGF0aDQ5NzMiCiAgICAgICAgIHNvZGlwb2RpOm5vZGV0eXBlcz0iY2NzY2NjY3NjY2NjY2NjY2NzY2NzYyIgLz4KICAgIDwvZz4KICAgIDxwYXRoCiAgICAgICBzb2RpcG9kaTp0eXBlPSJhcmMiCiAgICAgICBzdHlsZT0iZmlsbDpub25lO2ZpbGwtb3BhY2l0eToxO3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDozO3N0cm9rZS1saW5lam9pbjptaXRlcjttYXJrZXI6bm9uZTtzdHJva2Utb3BhY2l0eToxO3Zpc2liaWxpdHk6dmlzaWJsZTtkaXNwbGF5OmlubGluZTtvdmVyZmxvdzp2aXNpYmxlO2VuYWJsZS1iYWNrZ3JvdW5kOmFjY3VtdWxhdGUiCiAgICAgICBpZD0icGF0aDM1NTEiCiAgICAgICBzb2RpcG9kaTpjeD0iNzUiCiAgICAgICBzb2RpcG9kaTpjeT0iMjUiCiAgICAgICBzb2RpcG9kaTpyeD0iNCIKICAgICAgIHNvZGlwb2RpOnJ5PSI0IgogICAgICAgZD0iTSA3OSwyNSBBIDQsNCAwIDEgMSA3MSwyNSBBIDQsNCAwIDEgMSA3OSwyNSB6IiAvPgogIDwvZz4KPC9zdmc+Cg=="}}},{operation:function(t,e){return(!t||!e)&&(t||e)}});s.dia.Link.define("logic.Wire",{attrs:{".connection":{"stroke-width":2},".marker-vertex":{r:7}},router:{name:"orthogonal"},connector:{name:"rounded",args:{radius:10}}},{arrowheadMarkup:['<g class="marker-arrowhead-group marker-arrowhead-group-<%= end %>">','<circle class="marker-arrowhead" end="<%= end %>" r="7"/>',"</g>"].join(""),vertexMarkup:['<g class="marker-vertex-group" transform="translate(<%= x %>, <%= y %>)">','<circle class="marker-vertex" idx="<%= idx %>" r="10" />','<g class="marker-vertex-remove-group">','<path class="marker-vertex-remove-area" idx="<%= idx %>" d="M16,5.333c-7.732,0-14,4.701-14,10.5c0,1.982,0.741,3.833,2.016,5.414L2,25.667l5.613-1.441c2.339,1.317,5.237,2.107,8.387,2.107c7.732,0,14-4.701,14-10.5C30,10.034,23.732,5.333,16,5.333z" transform="translate(5, -33)"/>','<path class="marker-vertex-remove" idx="<%= idx %>" transform="scale(.8) translate(9.5, -37)" d="M24.778,21.419 19.276,15.917 24.777,10.415 21.949,7.585 16.447,13.087 10.945,7.585 8.117,10.415 13.618,15.917 8.116,21.419 10.946,24.248 16.447,18.746 21.948,24.248z">',"<title>Remove vertex.</title>","</path>","</g>","</g>"].join("")});if(typeof exports==="object"){var l=require("graphlib");var c=require("dagre")}l=l||typeof window!=="undefined"&&window.graphlib;c=c||typeof window!=="undefined"&&window.dagre;s.layout.DirectedGraph={exportElement:function(t){return t.size()},exportLink:function(t){var e=t.get("labelSize")||{};var i={minLen:t.get("minLen")||1,weight:t.get("weight")||1,labelpos:t.get("labelPosition")||"c",labeloffset:t.get("labelOffset")||0,width:e.width||0,height:e.height||0};return i},importElement:function(t,e,i){var r=this.getCell(e);var n=i.node(e);if(t.setPosition){t.setPosition(r,n)}else{r.set("position",{x:n.x-n.width/2,y:n.y-n.height/2})}},importLink:function(t,e,i){var r=this.getCell(e.name);var a=i.edge(e);var o=a.points||[];if(t.setVertices||t.setLinkVertices){if(s.util.isFunction(t.setVertices)){t.setVertices(r,o)}else{r.set("vertices",o.slice(1,o.length-1))}}if(t.setLabels&&"x"in a&&"y"in a){var l={x:a.x,y:a.y};if(s.util.isFunction(t.setLabels)){t.setLabels(r,l,o)}else{var c=n.Polyline(o);var u=c.closestPointLength(l);var g=c.pointAtLength(u);var h=u/c.length();r.label(0,{position:{distance:h,offset:n.Point(l).difference(g).toJSON()}})}}},layout:function(t,e){var i;if(t instanceof s.dia.Graph){i=t}else{i=(new s.dia.Graph).resetCells(t,{dry:true,sort:false})}t=null;e=s.util.defaults(e||{},{resizeClusters:true,clusterPadding:10,exportElement:this.exportElement,exportLink:this.exportLink});var r=i.toGraphLib({directed:true,multigraph:true,compound:true,setNodeLabel:e.exportElement,setEdgeLabel:e.exportLink,setEdgeName:function(t){return t.id}});var a={};var o=e.marginX||0;var l=e.marginY||0;if(e.rankDir)a.rankdir=e.rankDir;if(e.align)a.align=e.align;if(e.nodeSep)a.nodesep=e.nodeSep;if(e.edgeSep)a.edgesep=e.edgeSep;if(e.rankSep)a.ranksep=e.rankSep;if(e.ranker)a.ranker=e.ranker;if(o)a.marginx=o;if(l)a.marginy=l;r.setGraph(a);c.layout(r,{debugTiming:!!e.debugTiming});i.startBatch("layout");i.fromGraphLib(r,{importNode:this.importElement.bind(i,e),importEdge:this.importLink.bind(i,e)});if(e.resizeClusters){var u=r.nodes().filter(function(t){return r.children(t).length>0}).map(i.getCell.bind(i)).sort(function(t,e){return e.getAncestors().length-t.getAncestors().length});s.util.invoke(u,"fitEmbeds",{padding:e.clusterPadding})}i.stopBatch("layout");var g=r.graph();return n.Rect(o,l,Math.abs(g.width-2*o),Math.abs(g.height-2*l))},fromGraphLib:function(t,e){e=e||{};var i=e.importNode||s.util.noop;var r=e.importEdge||s.util.noop;var n=this instanceof s.dia.Graph?this:new s.dia.Graph;t.nodes().forEach(function(r){i.call(n,r,t,n,e)});t.edges().forEach(function(i){r.call(n,i,t,n,e)});return n},toGraphLib:function(t,e){e=e||{};var i=s.util.pick(e,"directed","compound","multigraph");var r=new l.Graph(i);var n=e.setNodeLabel||s.util.noop;var a=e.setEdgeLabel||s.util.noop;var o=e.setEdgeName||s.util.noop;var c=t.get("cells");for(var u=0,g=c.length;u<g;u++){var h=c.at(u);if(h.isLink()){var d=h.get("source");var f=h.get("target");if(!d.id||!f.id)break;r.setEdge(d.id,f.id,a(h),o(h))}else{r.setNode(h.id,n(h));if(r.isCompound()&&h.has("parent")){var v=h.get("parent");if(c.has(v)){r.setParent(h.id,v)}}}}return r}};s.dia.Graph.prototype.toGraphLib=function(t){return s.layout.DirectedGraph.toGraphLib(this,t)};s.dia.Graph.prototype.fromGraphLib=function(t,e){return s.layout.DirectedGraph.fromGraphLib.call(this,t,e)};s.g=n;s.V=s.Vectorizer=a;return s});