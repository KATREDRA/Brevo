sap.ui.define(["sap/ui/model/json/JSONModel","sap/m/MessageBox","sap/ui/Device"],function(e,a,t){"use strict";return{metadata:{name:"LessonLearnt",version:"1.0",includes:[],dependencies:{libs:["sap.m","sap.ui.layout"],components:[]},config:{resourceBundle:"i18n/messageBundle.properties",serviceConfig:{name:"Query_Builder Services",serviceUrl:"",destination:window.location.href.indexOf("ondemand")>-1?"IMS":"",mockdataDir:"model/"}}},mockdata:false,init:function(){var e=this.metadata.config;var a=jQuery.sap.getUriParameters().get("mockdata")==="false";this.mockdata=false;var t=e.serviceConfig.serviceUrl;if(this.mockdata){this.showMockDataMessage()}},showMockDataMessage:function(){},handleError:function(e){var a=e.getParameters().message+" contact System Administrator";sap.m.MessageToast.show(a,{duration:4e3})},fixProxyServerUrl:function(e){var a=this.metadata.config.serviceConfig.destination;if(window.location.hostname=="localhost"){var t=window.location.href+"proxy/";return t.concat(e)}else if(a!=""){var i=this.metadata.config;var t=window.location.origin+"/"+a+"/";return t.concat(e)}else{var i=this.metadata.config;var t=window.location.origin+"/";return t.concat(e)}},callService:function(e,a,t,i,s,o,r){var n=s||false;var c=sap.ui.getCore().getModel(e);var l=false;if(!c){c=new sap.ui.model.json.JSONModel;c.setSizeLimit(999999);sap.ui.getCore().setModel(c,e);l=true}var d=function(e){c.detachRequestFailed(this)};c.attachRequestCompleted(function(e){e.oSource.mEventRegistry=[];try{c.setData(JSON.parse(c.getData()))}catch(e){}o(e,e.mParameters.success)});c.setDefaultBindingMode(sap.ui.model.BindingMode.OneWay);c.attachRequestFailed(d);var f=this.metadata.config.serviceConfig.serviceUrl+t;var u=this.fixProxyServerUrl(f);if(this.mockdata==false&&s!="loadMock"){c.loadData(u,{},true,"GET",false,false,{})}else{if(a.indexOf(".json")<-1)a=a+".json";var v=a;c.loadData(v)}},callGetService:function(e,a,t,i,s,o,r){var n=s||false;var c=sap.ui.getCore().getModel(e);var l=false;if(!c){c=new sap.ui.model.json.JSONModel;c.setSizeLimit(999999);sap.ui.getCore().setModel(c,e);l=true}var d=function(e){c.detachRequestFailed(this)};c.attachRequestCompleted(function(e){e.oSource.mEventRegistry=[];o(e,r)});c.setDefaultBindingMode(sap.ui.model.BindingMode.OneWay);c.attachRequestFailed(d);var f=this.metadata.config.serviceConfig.serviceUrl+t;var u=this.fixProxyServerUrl(f);if(this.mockdata==false&&s!="loadMock"){$.ajax({type:"GET",url:u}).done(function(e,a){if(e==="")a=true;else if(JSON.parse(e).status=="Success")a=true;else a=false;o(e,a)})}else{if(a.indexOf(".json")<-1)a=a+".json";var v=a;c.loadData(v)}},callCreateService:function(e,a,t,i){var s=this.metadata.config.serviceConfig.serviceUrl+e;var o=this.fixProxyServerUrl(s);if(t==="POST"){$.ajax({type:"POST",url:o,data:a,headers:{"Content-Type":"application/json"}}).done(function(e,a){if(JSON.parse(e).status=="Success")a=true;else a=false;i(e,a)})}function r(e,a){i(e,true)}function n(e){i(JSON.parse(e.response.body).error.message.value,false)}}}});