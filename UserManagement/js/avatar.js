var email=document.querySelector("#email"),password=document.querySelector("#password"),mySVG=document.querySelector(".svgContainer"),armL=document.querySelector(".armL"),armR=document.querySelector(".armR"),eyeL=document.querySelector(".eyeL"),eyeR=document.querySelector(".eyeR"),nose=document.querySelector(".nose"),mouth=document.querySelector(".mouth"),mouthBG=document.querySelector(".mouthBG"),mouthSmallBG=document.querySelector(".mouthSmallBG"),mouthMediumBG=document.querySelector(".mouthMediumBG"),mouthLargeBG=document.querySelector(".mouthLargeBG"),mouthMaskPath=document.querySelector("#mouthMaskPath"),mouthOutline=document.querySelector(".mouthOutline"),tooth=document.querySelector(".tooth"),tongue=document.querySelector(".tongue"),chin=document.querySelector(".chin"),face=document.querySelector(".face"),eyebrow=document.querySelector(".eyebrow"),outerEarL=document.querySelector(".earL .outerEar"),outerEarR=document.querySelector(".earR .outerEar"),earHairL=document.querySelector(".earL .earHair"),earHairR=document.querySelector(".earR .earHair"),hair=document.querySelector(".hair");var caretPos,curEmailIndex,screenCenter,svgCoords,eyeMaxHorizD=20,eyeMaxVertD=10,noseMaxHorizD=23,noseMaxVertD=10,dFromC,eyeDistH,eyeLDistV,eyeRDistV,eyeDistR,mouthStatus="small";function getCoord(e){var t=email.selectionEnd,o=document.createElement("div"),a=document.createElement("span"),r=getComputedStyle(email),s={},n={},u={};[].forEach.call(r,function(e){o.style[e]=r[e]});o.style.position="absolute";document.body.appendChild(o);o.textContent=email.value.substr(0,t);a.textContent=email.value.substr(t)||".";o.appendChild(a);s=getPosition(email);n=getPosition(a);u=getPosition(mySVG);svgCoords=getPosition(mySVG);screenCenter=u.x+mySVG.offsetWidth/2;caretPos=n.x+s.x;dFromC=screenCenter-caretPos;var c=Math.round(caretPos/screenCenter*100)/100;if(c<1){}else if(c>1){c-=2;c=Math.abs(c)}eyeDistH=-dFromC*.05;if(eyeDistH>eyeMaxHorizD){eyeDistH=eyeMaxHorizD}else if(eyeDistH<-eyeMaxHorizD){eyeDistH=-eyeMaxHorizD}var x={x:svgCoords.x+84,y:svgCoords.y+76};var m={x:svgCoords.x+113,y:svgCoords.y+76};var i={x:svgCoords.x+97,y:svgCoords.y+81};var l={x:svgCoords.x+100,y:svgCoords.y+100};var y=getAngle(x.x,x.y,s.x+n.x,s.y+25);var h=Math.cos(y)*eyeMaxHorizD;var d=Math.sin(y)*eyeMaxVertD;var M=getAngle(m.x,m.y,s.x+n.x,s.y+25);var p=Math.cos(M)*eyeMaxHorizD;var v=Math.sin(M)*eyeMaxVertD;var E=getAngle(i.x,i.y,s.x+n.x,s.y+25);var f=Math.cos(E)*noseMaxHorizD;var O=Math.sin(E)*noseMaxVertD;var g=getAngle(l.x,l.y,s.x+n.x,s.y+25);var w=Math.cos(g)*noseMaxHorizD;var T=Math.sin(g)*noseMaxVertD;var S=Math.cos(g)*6;var L=w*.8;var C=T*.5;var D=1-dFromC*.15/100;if(D>1){D=1-(D-1)}var q=w*.3;var G=T*.4;var H=Math.cos(g)*5;var R=Math.cos(g)*25;var B=Math.cos(g)*4;var P=Math.cos(g)*5;var V=Math.cos(g)*6;var b=1.2;TweenMax.to(eyeL,1,{x:-h,y:-d,ease:Expo.easeOut});TweenMax.to(eyeR,1,{x:-p,y:-v,ease:Expo.easeOut});TweenMax.to(nose,1,{x:-f,y:-O,rotation:S,transformOrigin:"center center",ease:Expo.easeOut});TweenMax.to(mouth,1,{x:-w,y:-T,rotation:S,transformOrigin:"center center",ease:Expo.easeOut});TweenMax.to(chin,1,{x:-L,y:-C,scaleY:D,ease:Expo.easeOut});TweenMax.to(face,1,{x:-q,y:-G,skewX:-H,transformOrigin:"center top",ease:Expo.easeOut});TweenMax.to(eyebrow,1,{x:-q,y:-G,skewX:-R,transformOrigin:"center top",ease:Expo.easeOut});TweenMax.to(outerEarL,1,{x:B,y:-P,ease:Expo.easeOut});TweenMax.to(outerEarR,1,{x:B,y:P,ease:Expo.easeOut});TweenMax.to(earHairL,1,{x:-B,y:-P,ease:Expo.easeOut});TweenMax.to(earHairR,1,{x:-B,y:P,ease:Expo.easeOut});TweenMax.to(hair,1,{x:V,scaleY:b,transformOrigin:"center bottom",ease:Expo.easeOut});document.body.removeChild(o)}function onEmailInput(e){getCoord(e);var t=e.target.value;curEmailIndex=t.length;if(curEmailIndex>0){if(mouthStatus=="small"){mouthStatus="medium";TweenMax.to([mouthBG,mouthOutline,mouthMaskPath],1,{morphSVG:mouthMediumBG,shapeIndex:8,ease:Expo.easeOut});TweenMax.to(tooth,1,{x:0,y:0,ease:Expo.easeOut});TweenMax.to(tongue,1,{x:0,y:1,ease:Expo.easeOut});TweenMax.to([eyeL,eyeR],1,{scaleX:.85,scaleY:.85,ease:Expo.easeOut})}if(t.includes("@")){mouthStatus="large";TweenMax.to([mouthBG,mouthOutline,mouthMaskPath],1,{morphSVG:mouthLargeBG,ease:Expo.easeOut});TweenMax.to(tooth,1,{x:3,y:-2,ease:Expo.easeOut});TweenMax.to(tongue,1,{y:2,ease:Expo.easeOut});TweenMax.to([eyeL,eyeR],1,{scaleX:.65,scaleY:.65,ease:Expo.easeOut,transformOrigin:"center center"})}else{mouthStatus="medium";TweenMax.to([mouthBG,mouthOutline,mouthMaskPath],1,{morphSVG:mouthMediumBG,ease:Expo.easeOut});TweenMax.to(tooth,1,{x:0,y:0,ease:Expo.easeOut});TweenMax.to(tongue,1,{x:0,y:1,ease:Expo.easeOut});TweenMax.to([eyeL,eyeR],1,{scaleX:.85,scaleY:.85,ease:Expo.easeOut})}}else{mouthStatus="small";TweenMax.to([mouthBG,mouthOutline,mouthMaskPath],1,{morphSVG:mouthSmallBG,shapeIndex:9,ease:Expo.easeOut});TweenMax.to(tooth,1,{x:0,y:0,ease:Expo.easeOut});TweenMax.to(tongue,1,{y:0,ease:Expo.easeOut});TweenMax.to([eyeL,eyeR],1,{scaleX:1,scaleY:1,ease:Expo.easeOut})}}function onEmailFocus(e){e.target.parentElement.classList.add("focusWithText");getCoord()}function onEmailBlur(e){if(e.target.value==""){e.target.parentElement.classList.remove("focusWithText")}resetFace()}function onPasswordFocus(e){coverEyes()}function onPasswordBlur(e){uncoverEyes()}function coverEyes(){TweenMax.to(armL,.45,{x:-93,y:2,rotation:0,ease:Quad.easeOut});TweenMax.to(armR,.45,{x:-93,y:2,rotation:0,ease:Quad.easeOut,delay:.1})}function uncoverEyes(){TweenMax.to(armL,1.35,{y:220,ease:Quad.easeOut});TweenMax.to(armL,1.35,{rotation:105,ease:Quad.easeOut,delay:.1});TweenMax.to(armR,1.35,{y:220,ease:Quad.easeOut});TweenMax.to(armR,1.35,{rotation:-105,ease:Quad.easeOut,delay:.1})}function resetFace(){TweenMax.to([eyeL,eyeR],1,{x:0,y:0,ease:Expo.easeOut});TweenMax.to(nose,1,{x:0,y:0,scaleX:1,scaleY:1,ease:Expo.easeOut});TweenMax.to(mouth,1,{x:0,y:0,rotation:0,ease:Expo.easeOut});TweenMax.to(chin,1,{x:0,y:0,scaleY:1,ease:Expo.easeOut});TweenMax.to([face,eyebrow],1,{x:0,y:0,skewX:0,ease:Expo.easeOut});TweenMax.to([outerEarL,outerEarR,earHairL,earHairR,hair],1,{x:0,y:0,scaleY:1,ease:Expo.easeOut})}function getAngle(e,t,o,a){var r=Math.atan2(t-a,e-o);return r}function getPosition(e){var t=0;var o=0;while(e){if(e.tagName=="BODY"){var a=e.scrollLeft||document.documentElement.scrollLeft;var r=e.scrollTop||document.documentElement.scrollTop;t+=e.offsetLeft-a+e.clientLeft;o+=e.offsetTop-r+e.clientTop}else{t+=e.offsetLeft-e.scrollLeft+e.clientLeft;o+=e.offsetTop-e.scrollTop+e.clientTop}e=e.offsetParent}return{x:t,y:o}}